// @observablehq/plot v0.6.9 Copyright 2020-2023 Observable, Inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3@7.8.5/dist/d3.min.js")):"function"==typeof define&&define.amd?define(["exports","d3@7.8.5/dist/d3.min.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Plot=t.Plot||{},t.d3)}(this,(function(t,e){"use strict";function n(t){return null!=t&&!Number.isNaN(t)}function r(t,r){return+n(r)-+n(t)||e.ascending(t,r)}function o(t,r){return+n(r)-+n(t)||e.descending(t,r)}function i(t){return null!=t&&""!=`${t}`}function a(t){return isFinite(t)?t:NaN}function l(t){return t>0&&isFinite(t)?t:NaN}function s(t){return t<0&&isFinite(t)?t:NaN}function c(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof e?e(t):e;const n=t.getUTCHours(),r=t.getUTCMinutes(),o=t.getUTCSeconds(),i=t.getUTCMilliseconds();return`${a=t.getUTCFullYear(),a<0?`-${u(-a,6)}`:a>9999?`+${u(a,6)}`:u(a,4)}-${u(t.getUTCMonth()+1,2)}-${u(t.getUTCDate(),2)}${n||r||o||i?`T${u(n,2)}:${u(r,2)}${o||i?`:${u(o,2)}${i?`.${u(i,3)}`:""}`:""}Z`:""}`;var a}function u(t,e){return`${t}`.padStart(e,"0")}const f=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function h(t,e){return f.test(t+="")?new Date(t):"function"==typeof e?e(t):e}const d=1e3,p=6e4,m=36e5,y=864e5,g=2592e6,v=[["millisecond",500],["second",d],["second",3e4],["minute",p],["minute",18e5],["hour",m],["hour",432e5],["day",y],["day",1728e5],["week",6048e5],["month",g],["month",7776e6],["year",31536e6]],x=new Map([["second",e.timeSecond],["minute",e.timeMinute],["hour",e.timeHour],["day",e.timeDay],["week",e.timeWeek],["month",e.timeMonth],["year",e.timeYear],["monday",e.timeMonday],["tuesday",e.timeTuesday],["wednesday",e.timeWednesday],["thursday",e.timeThursday],["friday",e.timeFriday],["saturday",e.timeSaturday],["sunday",e.timeSunday]]),w=new Map([["second",e.utcSecond],["minute",e.utcMinute],["hour",e.utcHour],["day",e.unixDay],["week",e.utcWeek],["month",e.utcMonth],["year",e.utcYear],["monday",e.utcMonday],["tuesday",e.utcTuesday],["wednesday",e.utcWednesday],["thursday",e.utcThursday],["friday",e.utcFriday],["saturday",e.utcSaturday],["sunday",e.utcSunday]]);function b(t,e){let n=`${t}`.toLowerCase();n.endsWith("s")&&(n=n.slice(0,-1));let r=1;const o=/^(?:(\d+)\s+)/.exec(n);switch(o&&(n=n.slice(o[0].length),r=+o[1]),n){case"quarter":n="month",r*=3;break;case"half":n="month",r*=6}let i=e.get(n);if(!i)throw new Error(`unknown interval: ${t}`);if(!(r>1))return i;if(!i.every)throw new Error(`non-periodic interval: ${n}`);return i.every(r)}function k(t){return b(t,x)}function $(t){return b(t,w)}function M(t,n,r,o){const i="time"===t.type?e.timeFormat:e.utcFormat,a="left"===o||"right"===o?(t,e)=>`\n${t}\n${e}`:"top"===o?(t,e)=>`${e}\n${t}`:(t,e)=>`${t}\n${e}`;switch(function(t,n,r){const o=e.median(e.pairs(n,((t,e)=>Math.abs(e-t)||NaN)));if(o>0)return v[e.bisector((([,t])=>t)).right(v,o,1,v.length)-1][0];const[i,a]=e.extent(t.domain()),l="number"==typeof r?r:10,s=Math.abs(a-i)/l;return v[e.bisector((([,t])=>Math.log(t))).center(v,Math.log(s))][0]}(t,n,r)){case"millisecond":return L(i(".%L"),i(":%M:%S"),a);case"second":return L(i(":%S"),i("%-I:%M"),a);case"minute":return L(i("%-I:%M"),i("%p"),a);case"hour":return L(i("%-I %p"),i("%b %-d"),a);case"day":case"week":return L(i("%-d"),i("%b"),a);case"month":return L(i("%b"),i("%Y"),a);case"year":return i("%Y")}throw new Error("unable to format time ticks")}function L(t,e,n){return(r,o,i)=>{const a=t(r,o),l=e(r,o),s=o-Dt(i);return o!==s&&void 0!==i[s]&&l===e(i[s],s)?a:n(a,l)}}const A=Object.getPrototypeOf(Uint8Array),S=Object.prototype.toString;function z(t,e,n){const r=typeof e;return"string"===r?E(t,C(e),n):"function"===r?E(t,e,n):"number"===r||e instanceof Date||"boolean"===r?K(t,q(e),n):R("function"==typeof e?.transform?e.transform(t):e,n)}function E(t,e,n){return K(t,n?.prototype instanceof A?function(t){return(e,n)=>G(t(e,n))}(e):e,n)}function R(t,e){return void 0===e?J(t):t instanceof e?t:e.prototype instanceof A&&!(t instanceof A)?e.from(t,G):e.from(t)}const O=[null],C=t=>e=>e[t],T={transform:ht},B={transform:t=>t},N=()=>1,P=()=>!0,I=t=>null==t?t:`${t}`,W=t=>null==t?t:+t,j=t=>t?t[0]:void 0,F=t=>t?t[1]:void 0,D=t=>t?t[2]:void 0,q=t=>()=>t;function Y(t){const n=+`${t}`.slice(1)/100;return(t,r)=>e.quantile(t,n,r)}function _(t){return t instanceof A?t:K(t,G,Float64Array)}function G(t){return null==t?NaN:Number(t)}function X(t){return K(t,U)}function U(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?h(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function V(t,e){return void 0===t&&(t=e),null===t?[void 0,"none"]:Nt(t)?[void 0,t]:[t,void 0]}function H(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function Z(t,e,n){if(null!=t)return Q(t,e,n)}function Q(t,e,n){const r=`${t}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${e}: ${t}`);return r}function J(t){return null==t||t instanceof Array||t instanceof A?t:Array.from(t)}function K(t,e,n=Array){return null==t?t:t instanceof n?t.map(e):n.from(t,e)}function tt(t,e=Array){return t instanceof e?t.slice():e.from(t)}function et({x:t,x1:e,x2:n}){return void 0!==t||void 0!==e||void 0!==n}function nt({y:t,y1:e,y2:n}){return void 0!==t||void 0!==e||void 0!==n}function rt(t){return et(t)||nt(t)||void 0!==t.interval}function ot(t){return t?.toString===S}function at(t){return ot(t)&&(void 0!==t.type||void 0!==t.domain)}function lt(t){return ot(t)&&"function"!=typeof t.transform}function st(t){return lt(t)&&void 0===t.value&&void 0===t.channel}function ct(t,e,n,r=B){return void 0===e&&void 0===n?(e=0,n=void 0===t?r:t):void 0===e?e=void 0===t?0:t:void 0===n&&(n=void 0===t?0:t),[e,n]}function ut(t,e){return void 0===t&&void 0===e?[j,F]:[t,e]}function ft({z:t,fill:e,stroke:n}={}){return void 0===t&&([t]=V(e)),void 0===t&&([t]=V(n)),t}function ht(t){const e=t.length,n=new Uint32Array(e);for(let t=0;t<e;++t)n[t]=t;return n}function dt(t,e){return K(e,(e=>t[e]))}function pt(t){return 1===t.length?(e,n)=>t(dt(n,e)):t}function mt(t,e,n){return t.subarray?t.subarray(e,n):t.slice(e,n)}function yt(t){return null!==t&&"object"==typeof t?t.valueOf():t}function gt(t,e){if(void 0!==e[t])return e[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y"}return e[t]}function vt(t){let e;return[{transform:()=>e,label:wt(t)},t=>e=t]}function xt(t){return null==t?[t]:vt(t)}function wt(t,e){return"string"==typeof t?t:t&&void 0!==t.label?t.label:e}function bt(t,e){return{transform(n){const r=t.transform(n),o=e.transform(n);return Rt(r)||Rt(o)?K(r,((t,e)=>new Date((+r[e]+ +o[e])/2))):K(r,((t,e)=>(+r[e]+ +o[e])/2),Float64Array)},label:t.label}}function kt(t,e){const n=$t(e?.interval,e?.type);return n?K(t,n):t}function $t(t,e){const r=Mt(t,e);return r&&(t=>n(t)?r.floor(t):t)}function Mt(t,n){if(null!=t){if("number"==typeof t){0<t&&t<1&&Number.isInteger(1/t)&&(t=-1/t);const n=Math.abs(t);return t<0?{floor:t=>Math.floor(t*n)/n,offset:t=>(t*n+1)/n,range:(t,r)=>e.range(Math.ceil(t*n),r*n).map((t=>t/n))}:{floor:t=>Math.floor(t/n)*n,offset:t=>t+n,range:(t,r)=>e.range(Math.ceil(t/n),r/n).map((t=>t*n))}}if("string"==typeof t)return("time"===n?k:$)(t);if("function"!=typeof t.floor)throw new Error("invalid interval; missing floor method");if("function"!=typeof t.offset)throw new Error("invalid interval; missing offset method");return t}}function Lt(t,e){if((t=Mt(t,e))&&"function"!=typeof t.range)throw new Error("invalid interval: missing range method");return t}function At(t){return void 0===t||lt(t)?t:{value:t}}function St(t){return t&&"function"==typeof t[Symbol.iterator]}function zt(t){for(const e of t)if(null!=e)return"object"!=typeof e||e instanceof Date}function Et(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function Rt(t){for(const e of t)if(null!=e)return e instanceof Date}function Ot(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&h(e)}function Ct(t){for(const e of t)if(null!=e){if("string"!=typeof e)return!1;if(e.trim())return!isNaN(e)}}function Tt(t){for(const e of t)if(null!=e)return"number"==typeof e}function Bt(t,e){let n;for(const r of t)if(null!=r){if(!e(r))return!1;n=!0}return n}function Nt(t){return"string"==typeof t&&("none"===(t=t.toLowerCase().trim())||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==e.color(t))}function Pt(t){return"number"==typeof t&&(0<=t&&t<=1||isNaN(t))}function It(t){return null==t||Wt(t)}function Wt(t){return/^\s*none\s*$/i.test(t)}function jt(t,e){return Z(t,e,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function Ft(t="middle"){return jt(t,"frameAnchor")}function Dt(t){if(null==t)return;const n=t[0],r=t[t.length-1];return e.descending(n,r)}function qt(t){return St(t)?function(t){console.warn("named iterables are deprecated; please use an object instead");const e=new Set;return Object.fromEntries(Array.from(t,(t=>{const{name:n}=t;if(null==n)throw new Error("missing name");const r=`${n}`;if("__proto__"===r)throw new Error(`illegal name: ${r}`);if(e.has(r))throw new Error(`duplicate name: ${r}`);return e.add(r),[n,t]})))}(t):t}const Yt=Symbol("position"),_t=Symbol("color"),Gt=Symbol("radius"),Xt=Symbol("length"),Ut=Symbol("opacity"),Vt=Symbol("symbol"),Ht=Symbol("projection"),Zt=new Map([["x",Yt],["y",Yt],["fx",Yt],["fy",Yt],["r",Gt],["color",_t],["opacity",Ut],["symbol",Vt],["length",Xt],["projection",Ht]]),Qt=Math.sqrt(3),Jt=2/Qt,Kt={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*Jt,o=r/2;t.moveTo(0,r),t.lineTo(n,o),t.lineTo(n,-o),t.lineTo(0,-r),t.lineTo(-n,-o),t.lineTo(-n,o),t.closePath()}},te=new Map([["asterisk",e.symbolAsterisk],["circle",e.symbolCircle],["cross",e.symbolCross],["diamond",e.symbolDiamond],["diamond2",e.symbolDiamond2],["hexagon",Kt],["plus",e.symbolPlus],["square",e.symbolSquare],["square2",e.symbolSquare2],["star",e.symbolStar],["times",e.symbolTimes],["triangle",e.symbolTriangle],["triangle2",e.symbolTriangle2],["wye",e.symbolWye]]);function ee(t){return t&&"function"==typeof t.draw}function ne(t){return!!ee(t)||"string"==typeof t&&te.has(t.toLowerCase())}function re(t){if(null==t||ee(t))return t;const e=te.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}function oe({filter:t,sort:e,reverse:n,transform:r,initializer:o,...i}={},a){if(void 0===r&&(null!=t&&(r=ce(t)),null==e||st(e)||(r=ae(r,he(e))),n&&(r=ae(r,ue))),null!=a&&null!=o)throw new Error("transforms cannot be applied after initializers");return{...i,...(null===e||st(e))&&{sort:e},transform:ae(r,a)}}function ie({filter:t,sort:e,reverse:n,initializer:r,...o}={},i){return void 0===r&&(null!=t&&(r=ce(t)),null==e||st(e)||(r=le(r,he(e))),n&&(r=le(r,ue))),{...o,...(null===e||st(e))&&{sort:e},initializer:le(r,i)}}function ae(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,o){return({data:n,facets:r}=t.call(this,n,r,o)),e.call(this,J(n),r,o)}}function le(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,o,...i){let a,l,s,c,u,f;return({data:l=n,facets:s=r,channels:a}=t.call(this,n,r,o,...i)),({data:u=l,facets:f=s,channels:c}=e.call(this,l,s,{...o,...a},...i)),{data:u,facets:f,channels:{...a,...c}}}}function se(t,e){return(null!=t.initializer?ie:oe)(t,e)}function ce(t){return(e,n)=>{const r=z(e,t);return{data:e,facets:n.map((t=>t.filter((t=>r[t]))))}}}function ue(t,e){return{data:t,facets:e.map((t=>t.slice().reverse()))}}function fe(t,{sort:e,...n}={}){return{...(lt(t)&&void 0!==t.channel?ie:se)(n,he(t)),sort:st(e)?e:null}}function he(t){return("function"==typeof t&&1!==t.length?de:pe)(t)}function de(t){return(e,n)=>{const r=(n,r)=>t(e[n],e[r]);return{data:e,facets:n.map((t=>t.slice().sort(r)))}}}function pe(t){let e,n;({channel:e,value:t,order:n}={...At(t)});const i=e?.startsWith("-");if(i&&(e=e.slice(1)),void 0===n&&(n=i?o:r),"function"!=typeof n)switch(`${n}`.toLowerCase()){case"ascending":n=r;break;case"descending":n=o;break;default:throw new Error(`invalid order: ${n}`)}return(r,o,i)=>{let a;if(void 0===e)a=z(r,t);else{if(void 0===i)throw new Error("channel sort requires an initializer");if(a=i[e],!a)return{};a=a.value}const l=(t,e)=>n(a[t],a[e]);return{data:r,facets:o.map((t=>t.slice().sort(l)))}}}function me(t,e){return xe(null,null,t,e)}function ye(t={y:"count"},e={}){const{x:n=B}=e;if(null==n)throw new Error("missing channel: x");return xe(n,null,t,e)}function ge(t={x:"count"},e={}){const{y:n=B}=e;if(null==n)throw new Error("missing channel: y");return xe(null,n,t,e)}function ve(t={fill:"count"},e={}){let{x:n,y:r}=e;if([n,r]=ut(n,r),null==n)throw new Error("missing channel: x");if(null==r)throw new Error("missing channel: y");return xe(n,r,t,e)}function xe(t,e,{data:n=Oe,filter:r,sort:o,reverse:i,...a}={},l={}){a=be(a,l),n=Le(n,B),o=null==o?void 0:ke("sort",o,l),r=null==r?void 0:$e("filter",r,l);const[s,c]=xt(t),[u,f]=xt(e),{z:h,fill:d,stroke:p,x1:m,x2:y,y1:g,y2:v,...x}=l,[w,b]=xt(h),[k]=V(d),[$]=V(p),[M,L]=xt(k),[A,S]=xt($);return{..."z"in l&&{z:w||h},..."fill"in l&&{fill:M||d},..."stroke"in l&&{stroke:A||p},...oe(x,((l,s,u)=>{const d=kt(z(l,t),u?.x),p=kt(z(l,e),u?.y),m=z(l,h),y=z(l,k),g=z(l,$),v=Se(a,{z:m,fill:y,stroke:g}),x=[],w=[],M=d&&c([]),A=p&&f([]),E=m&&b([]),R=y&&L([]),O=g&&S([]);let C=0;for(const t of a)t.initialize(l);o&&o.initialize(l),r&&r.initialize(l);for(const t of s){const e=[];for(const e of a)e.scope("facet",t);o&&o.scope("facet",t),r&&r.scope("facet",t);for(const[i,s]of Me(t,v))for(const[t,c]of Me(s,p))for(const[s,u]of Me(c,d))if(!r||r.reduce(u)){e.push(C++),w.push(n.reduceIndex(u,l)),d&&M.push(s),p&&A.push(t),m&&E.push(v===m?i:m[u[0]]),y&&R.push(v===y?i:y[u[0]]),g&&O.push(v===g?i:g[u[0]]);for(const t of a)t.reduce(u);o&&o.reduce(u)}x.push(e)}return ze(x,o,i),{data:w,facets:x}})),...!we(a,"x")&&(s?{x:s}:{x1:m,x2:y}),...!we(a,"y")&&(u?{y:u}:{y1:g,y2:v}),...Object.fromEntries(a.map((({name:t,output:e})=>[t,e])))}}function we(t,...e){for(const{name:n}of t)if(e.includes(n))return!0;return!1}function be(t,e,n=ke){const r=Object.entries(t);return null!=e.title&&void 0===t.title&&r.push(["title",Te]),null!=e.href&&void 0===t.href&&r.push(["href",Ce]),r.filter((([,t])=>void 0!==t)).map((([t,r])=>null===r?function(t){return{name:t,initialize(){},scope(){},reduce(){}}}(t):n(t,r,e)))}function ke(t,e,n,r=$e){let o;ot(e)&&"reduce"in e&&(o=e.scale,e=e.reduce);const i=r(t,e,n),[a,l]=vt(i.label);let s;return{name:t,output:void 0===o?a:{value:a,scale:o},initialize(t){i.initialize(t),s=l([])},scope(t,e){i.scope(t,e)},reduce(t,e){s.push(i.reduce(t,e))}}}function $e(t,e,n,r=Le){const o=gt(t,n),i=r(e,o);let a,l;return{label:wt(i===Ne?null:o,i.label),initialize(t){a=void 0===o?t:z(t,o),"data"===i.scope&&(l=i.reduceIndex(ht(t),a))},scope(t,e){i.scope===t&&(l=i.reduceIndex(e,a))},reduce:(t,e)=>null==i.scope?i.reduceIndex(t,a,e):i.reduceIndex(t,a,l,e)}}function Me(t,n){return n?e.sort(e.group(t,(t=>n[t])),j):[[,t]]}function Le(t,n,r=Ae){if(null==t)return r(t);if("function"==typeof t.reduceIndex)return t;if("function"==typeof t.reduce&&ot(t))return function(t){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...t,reduceIndex:t.reduce.bind(t)}}(t);if("function"==typeof t)return o=t,{reduceIndex:(t,e,n)=>o(dt(e,t),n)};var o;if(/^p\d{2}$/i.test(t))return Ee(Y(t));switch(`${t}`.toLowerCase()){case"first":return Ce;case"last":return Be;case"identity":return Oe;case"count":return Ne;case"distinct":return Pe;case"sum":return null==n?Ne:Ie;case"proportion":return We(n,"data");case"proportion-facet":return We(n,"facet");case"deviation":return Ee(e.deviation);case"min":return Ee(e.min);case"min-index":return Ee(e.minIndex);case"max":return Ee(e.max);case"max-index":return Ee(e.maxIndex);case"mean":return Re(e.mean);case"median":return Re(e.median);case"variance":return Ee(e.variance);case"mode":return Ee(e.mode)}return r(t)}function Ae(t){throw new Error(`invalid reduce: ${t}`)}function Se(t,e){for(const n in e){const r=e[n];if(void 0!==r&&!t.some((t=>t.name===n)))return r}}function ze(t,e,n){if(e){const n=e.output.transform(),o=(t,e)=>r(n[t],n[e]);t.forEach((t=>t.sort(o)))}n&&t.forEach((t=>t.reverse()))}function Ee(t){return{reduceIndex:(e,n)=>t(e,(t=>n[t]))}}function Re(t){return{reduceIndex(e,n){const r=t(e,(t=>n[t]));return Rt(n)?new Date(r):r}}}const Oe={reduceIndex:(t,e)=>dt(e,t)},Ce={reduceIndex:(t,e)=>e[t[0]]},Te={reduceIndex(t,n){const r=e.sort(e.rollup(t,(t=>t.length),(t=>n[t])),F),o=r.slice(-5).reverse();if(o.length<r.length){const t=r.slice(0,-4);o[4]=[`â€¦ ${t.length.toLocaleString("en-US")} more`,e.sum(t,F)]}return o.map((([t,e])=>`${t} (${e.toLocaleString("en-US")})`)).join("\n")}},Be={reduceIndex:(t,e)=>e[t[t.length-1]]},Ne={label:"Frequency",reduceIndex:t=>t.length},Pe={label:"Distinct",reduceIndex(t,n){const r=new e.InternSet;for(const e of t)r.add(n[e]);return r.size}},Ie=Ee(e.sum);function We(t,n){return null==t?{scope:n,label:"Frequency",reduceIndex:(t,e,n=1)=>t.length/n}:{scope:n,reduceIndex:(t,n,r=1)=>e.sum(t,(t=>n[t]))/r}}function je(t,{scale:e,type:n,value:r,filter:o,hint:i},a){return void 0===i&&"function"==typeof r?.transform&&(i=r.hint),qe(a,{scale:e,type:n,value:z(t,r),label:wt(r),filter:o,hint:i})}function Fe(t,e){return Object.fromEntries(Object.entries(t).map((([t,n])=>[t,je(e,n,t)])))}function De(t,e){const n=Object.fromEntries(Object.entries(t).map((([t,{scale:n,value:r}])=>{const o=null==n?null:e[n];return[t,null==o?r:K(r,o)]})));return n.channels=t,n}function qe(t,e){const{scale:n,value:r}=e;if(!0===n||"auto"===n)switch(t){case"fill":case"stroke":case"color":e.scale=!0!==n&&Bt(r,Nt)?null:"color";break;case"fillOpacity":case"strokeOpacity":case"opacity":e.scale=!0!==n&&Bt(r,Pt)?null:"opacity";break;case"symbol":!0!==n&&Bt(r,ne)?(e.scale=null,e.value=K(r,re)):e.scale="symbol";break;default:e.scale=Zt.has(t)?t:null}else if(!1===n)e.scale=null;else if(null!=n&&!Zt.has(n))throw new Error(`unknown scale: ${n}`);return e}function Ye(t,e){for(const n in t){const r=t[n];if(r.scale===e)return r}}function _e(t,e){const n=t.original;if(n===t)return e;const r=e.value,o=e.value=[];for(let e=0;e<n.length;++e){const i=r[n[e][0]];for(const n of t[e])o[n]=i}return e}function Ge(t,e,n){const r=Xe(t,e);return K(Xe(t,n),((t,e)=>Math.abs(t-r[e])),Float64Array)}function Xe(t,e,n){let r=t[e];if(r||void 0===n||(r=t[n]),r)return r.value;throw new Error(`missing channel: ${e}`)}function Ue(t){if(null==t||"function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"ascending":return Ve;case"descending":return He}throw new Error(`invalid order: ${t}`)}function Ve([t,e],[n,o]){return r(e,o)||r(t,n)}function He([t,e],[n,i]){return o(e,i)||r(t,n)}function Ze(t,e){let n=t[e];if(n){for(;n.source;)n=n.source;return null===n.source?null:n}}function Qe(t={}){const{document:e=("undefined"!=typeof window?window.document:void 0)}=t;return{document:e}}function Je(t,{document:n}){return e.select(e.creator(t).call(n.documentElement))}let Ke=0;function tn(t){console.warn(t),++Ke}const en=Math.PI,nn=2*en,rn=.618;function on({projection:t,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n}={},l){if(null==t)return;if("function"==typeof t.stream)return t;let s,c,u="frame";if(ot(t)){let e;if(({type:t,domain:c,inset:e,insetTop:r=(void 0!==e?e:r),insetRight:o=(void 0!==e?e:o),insetBottom:i=(void 0!==e?e:i),insetLeft:a=(void 0!==e?e:a),clip:u=u,...s}=t),null==t)return}"function"!=typeof t&&({type:t}=an(t));const{width:f,height:h,marginLeft:d,marginRight:p,marginTop:m,marginBottom:y}=l,g=f-d-p-a-o,v=h-m-y-r-i;if(t=t?.({width:g,height:v,clip:u,...s}),null==t)return;u=function(t,n,r,o,i){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return e.geoClipRectangle(n,r,o,i);throw new Error(`unknown projection clip type: ${t}`)}(u,d,m,f-p,h-y);let x,w=d+a,b=m+r;if(null!=c){const[[n,r],[o,i]]=e.geoPath(t).bounds(c),a=Math.min(g/(o-n),v/(i-r));a>0?(w-=(a*(n+o)-g)/2,b-=(a*(r+i)-v)/2,x=e.geoTransform({point(t,e){this.stream.point(t*a+w,e*a+b)}})):tn("Warning: the projection could not be fit to the specified domain; using the default scale.")}return x??=0===w&&0===b?cn():e.geoTransform({point(t,e){this.stream.point(t+w,e+b)}}),{stream:e=>t.stream(x.stream(u(e)))}}function an(t){switch(`${t}`.toLowerCase()){case"albers-usa":return ln(e.geoAlbersUsa,.7463,.4673);case"albers":return sn(e.geoAlbers,.7463,.4673);case"azimuthal-equal-area":return ln(e.geoAzimuthalEqualArea,4,4);case"azimuthal-equidistant":return ln(e.geoAzimuthalEquidistant,nn,nn);case"conic-conformal":return sn(e.geoConicConformal,nn,nn);case"conic-equal-area":return sn(e.geoConicEqualArea,6.1702,2.9781);case"conic-equidistant":return sn(e.geoConicEquidistant,7.312,3.6282);case"equal-earth":return ln(e.geoEqualEarth,5.4133,2.6347);case"equirectangular":return ln(e.geoEquirectangular,nn,en);case"gnomonic":return ln(e.geoGnomonic,3.4641,3.4641);case"identity":return{type:cn};case"reflect-y":return{type:un};case"mercator":return ln(e.geoMercator,nn,nn);case"orthographic":return ln(e.geoOrthographic,2,2);case"stereographic":return ln(e.geoStereographic,2,2);case"transverse-mercator":return ln(e.geoTransverseMercator,nn,nn);default:throw new Error(`unknown projection type: ${t}`)}}function ln(t,e,n){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:l})=>{const s=t();return null!=a&&s.precision?.(a),null!=i&&s.rotate?.(i),"number"==typeof l&&s.clipAngle?.(l),s.scale(Math.min(r/e,o/n)),s.translate([r/2,o/2]),s},aspectRatio:n/e}}function sn(t,e,n){const{type:r,aspectRatio:o}=ln(t,e,n);return{type:t=>{const{parallels:e,domain:n,width:o,height:i}=t,a=r(t);return null!=e&&(a.parallels(e),void 0===n&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const cn=q({stream:t=>t}),un=q(e.geoTransform({point(t,e){this.stream.point(t,-e)}}));function fn(t,e,n,r){const o=n[t],i=n[e],a=o.length,l=n[t]=new Float64Array(a).fill(NaN),s=n[e]=new Float64Array(a).fill(NaN);let c;const u=r.stream({point(t,e){l[c]=t,s[c]=e}});for(c=0;c<a;++c)u.point(o[c],i[c])}function hn({projection:t}={}){return null!=t&&("function"==typeof t.stream||(ot(t)&&(t=t.type),null!=t))}function dn(t,e,{projection:n}){const{x:r,y:o}=t;let i={};return r&&(i.x=r),o&&(i.y=o),i=De(i,e),n&&"x"===r?.scale&&"y"===o?.scale&&fn("x","y",i,n),r&&(i.x=_(i.x)),o&&(i.y=_(i.y)),i}function pn(t){const n=[],r=[],o={scale:"x",value:n},i={scale:"y",value:r},a={point(t,e){n.push(t),r.push(e)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const n of t.value)e.geoStream(n,a);return[o,i]}const mn=new Map([["accent",e.schemeAccent],["category10",e.schemeCategory10],["dark2",e.schemeDark2],["paired",e.schemePaired],["pastel1",e.schemePastel1],["pastel2",e.schemePastel2],["set1",e.schemeSet1],["set2",e.schemeSet2],["set3",e.schemeSet3],["tableau10",e.schemeTableau10]]);const yn=new Map([...mn,["brbg",vn(e.schemeBrBG,e.interpolateBrBG)],["prgn",vn(e.schemePRGn,e.interpolatePRGn)],["piyg",vn(e.schemePiYG,e.interpolatePiYG)],["puor",vn(e.schemePuOr,e.interpolatePuOr)],["rdbu",vn(e.schemeRdBu,e.interpolateRdBu)],["rdgy",vn(e.schemeRdGy,e.interpolateRdGy)],["rdylbu",vn(e.schemeRdYlBu,e.interpolateRdYlBu)],["rdylgn",vn(e.schemeRdYlGn,e.interpolateRdYlGn)],["spectral",vn(e.schemeSpectral,e.interpolateSpectral)],["burd",xn(e.schemeRdBu,e.interpolateRdBu)],["buylrd",xn(e.schemeRdYlBu,e.interpolateRdYlBu)],["blues",gn(e.schemeBlues,e.interpolateBlues)],["greens",gn(e.schemeGreens,e.interpolateGreens)],["greys",gn(e.schemeGreys,e.interpolateGreys)],["oranges",gn(e.schemeOranges,e.interpolateOranges)],["purples",gn(e.schemePurples,e.interpolatePurples)],["reds",gn(e.schemeReds,e.interpolateReds)],["turbo",wn(e.interpolateTurbo)],["viridis",wn(e.interpolateViridis)],["magma",wn(e.interpolateMagma)],["inferno",wn(e.interpolateInferno)],["plasma",wn(e.interpolatePlasma)],["cividis",wn(e.interpolateCividis)],["cubehelix",wn(e.interpolateCubehelixDefault)],["warm",wn(e.interpolateWarm)],["cool",wn(e.interpolateCool)],["bugn",gn(e.schemeBuGn,e.interpolateBuGn)],["bupu",gn(e.schemeBuPu,e.interpolateBuPu)],["gnbu",gn(e.schemeGnBu,e.interpolateGnBu)],["orrd",gn(e.schemeOrRd,e.interpolateOrRd)],["pubu",gn(e.schemePuBu,e.interpolatePuBu)],["pubugn",gn(e.schemePuBuGn,e.interpolatePuBuGn)],["purd",gn(e.schemePuRd,e.interpolatePuRd)],["rdpu",gn(e.schemeRdPu,e.interpolateRdPu)],["ylgn",gn(e.schemeYlGn,e.interpolateYlGn)],["ylgnbu",gn(e.schemeYlGnBu,e.interpolateYlGnBu)],["ylorbr",gn(e.schemeYlOrBr,e.interpolateYlOrBr)],["ylorrd",gn(e.schemeYlOrRd,e.interpolateYlOrRd)],["rainbow",bn(e.interpolateRainbow)],["sinebow",bn(e.interpolateSinebow)]]);function gn(t,n){return({length:r})=>1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?e.quantize(n,r):t[r]}function vn(t,n){return({length:r})=>2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize(n,r):t[r]}function xn(t,n){return({length:r})=>2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize((t=>n(1-t)),r):t[r].slice().reverse()}function wn(t){return({length:n})=>e.quantize(t,Math.max(2,Math.floor(n)))}function bn(t){return({length:n})=>e.quantize(t,Math.floor(n)+1).slice(0,-1)}function kn(t){const e=`${t}`.toLowerCase();if(!yn.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return yn.get(e)}function $n(t,e){const n=kn(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const Mn=new Map([["brbg",e.interpolateBrBG],["prgn",e.interpolatePRGn],["piyg",e.interpolatePiYG],["puor",e.interpolatePuOr],["rdbu",e.interpolateRdBu],["rdgy",e.interpolateRdGy],["rdylbu",e.interpolateRdYlBu],["rdylgn",e.interpolateRdYlGn],["spectral",e.interpolateSpectral],["burd",t=>e.interpolateRdBu(1-t)],["buylrd",t=>e.interpolateRdYlBu(1-t)],["blues",e.interpolateBlues],["greens",e.interpolateGreens],["greys",e.interpolateGreys],["purples",e.interpolatePurples],["reds",e.interpolateReds],["oranges",e.interpolateOranges],["turbo",e.interpolateTurbo],["viridis",e.interpolateViridis],["magma",e.interpolateMagma],["inferno",e.interpolateInferno],["plasma",e.interpolatePlasma],["cividis",e.interpolateCividis],["cubehelix",e.interpolateCubehelixDefault],["warm",e.interpolateWarm],["cool",e.interpolateCool],["bugn",e.interpolateBuGn],["bupu",e.interpolateBuPu],["gnbu",e.interpolateGnBu],["orrd",e.interpolateOrRd],["pubugn",e.interpolatePuBuGn],["pubu",e.interpolatePuBu],["purd",e.interpolatePuRd],["rdpu",e.interpolateRdPu],["ylgnbu",e.interpolateYlGnBu],["ylgn",e.interpolateYlGn],["ylorbr",e.interpolateYlOrBr],["ylorrd",e.interpolateYlOrRd],["rainbow",e.interpolateRainbow],["sinebow",e.interpolateSinebow]]);function Ln(t){const e=`${t}`.toLowerCase();if(!Mn.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return Mn.get(e)}const An=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);const Sn=t=>e=>t(1-e),zn=[0,1],En=new Map([["number",e.interpolateNumber],["rgb",e.interpolateRgb],["hsl",e.interpolateHsl],["hcl",e.interpolateHcl],["lab",e.interpolateLab]]);function Rn(t){const e=`${t}`.toLowerCase();if(!En.has(e))throw new Error(`unknown interpolator: ${e}`);return En.get(e)}function On(t,n,r,{type:o,nice:i,clamp:a,zero:l,domain:s=Nn(t,r),unknown:c,round:u,scheme:f,interval:h,range:d=(Zt.get(t)===Gt?In(r,s):Zt.get(t)===Xt?Wn(r,s):Zt.get(t)===Ut?zn:void 0),interpolate:p=(Zt.get(t)===_t?null==f&&void 0!==d?e.interpolateRgb:Ln(void 0!==f?f:"cyclical"===o?"rainbow":"turbo"):u?e.interpolateRound:e.interpolateNumber),reverse:m}){if(h=Lt(h,o),"cyclical"!==o&&"sequential"!==o||(o="linear"),"function"!=typeof p&&(p=Rn(p)),m=!!m,void 0!==d){if((s=J(s)).length!==(d=J(d)).length){if(1===p.length)throw new Error("invalid piecewise interpolator");p=e.piecewise(p,d),d=void 0}}if(1===p.length?(m&&(p=Sn(p),m=!1),void 0===d&&2===(d=Float64Array.from(s,((t,e)=>e/(s.length-1)))).length&&(d=zn),n.interpolate((d===zn?q:Dn)(p))):n.interpolate(p),l){const[t,n]=e.extent(s);(t>0||n<0)&&(Dt(s=tt(s))!==Math.sign(t)?s[s.length-1]=0:s[0]=0)}return m&&(s=e.reverse(s)),n.domain(s).unknown(c),i&&(n.nice(function(t,e){return!0===t?void 0:"number"==typeof t?t:function(t,e){if((t=Lt(t,e))&&"function"!=typeof t.ceil)throw new Error("invalid interval: missing ceil method");return t}(t,e)}(i,o)),s=n.domain()),void 0!==d&&n.range(d),a&&n.clamp(a),{type:o,domain:s,range:d,scale:n,interpolate:p,interval:h}}function Cn(t,n,{exponent:r=1,...o}){return On(t,e.scalePow().exponent(r),n,{...o,type:"pow"})}function Tn(t,n,{domain:r=[0],unknown:o,scheme:i="rdylbu",interpolate:a,range:l=(void 0!==a?e.quantize(a,r.length+1):Zt.get(t)===_t?$n(i,r.length+1):void 0),reverse:s}){const c=Dt(r=J(r));if(!isNaN(c)&&!function(t,n){for(let r=1,o=t.length,i=t[0];r<o;++r){const o=e.descending(i,i=t[r]);if(0!==o&&o!==n)return!1}return!0}(r,c))throw new Error(`the ${t} scale has a non-monotonic domain`);return s&&(l=e.reverse(l)),{type:"threshold",scale:e.scaleThreshold(c<0?e.reverse(r):r,void 0===l?[]:l).unknown(o),domain:r,range:l}}function Bn(t,n=a){return t.length?[e.min(t,(({value:t})=>void 0===t?t:e.min(t,n))),e.max(t,(({value:t})=>void 0===t?t:e.max(t,n)))]:[0,1]}function Nn(t,e){const n=Zt.get(t);return(n===Gt||n===Ut||n===Xt?Pn:Bn)(e)}function Pn(t){return[0,t.length?e.max(t,(({value:t})=>void 0===t?t:e.max(t,a))):1]}function In(t,n){const r=t.find((({radius:t})=>void 0!==t));if(void 0!==r)return[0,r.radius];const o=e.quantile(t,.5,(({value:t})=>void 0===t?NaN:e.quantile(t,.25,l))),i=n.map((t=>3*Math.sqrt(t/o))),a=30/e.max(i);return a<1?i.map((t=>t*a)):i}function Wn(t,n){const r=e.median(t,(({value:t})=>void 0===t?NaN:e.median(t,Math.abs))),o=n.map((t=>12*t/r)),i=60/e.max(o);return i<1?o.map((t=>t*i)):o}function jn(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n>0)return Bn(t,l);if(n<0)return Bn(t,s)}return[1,10]}function Fn(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function Dn(t){return(e,n)=>r=>t(e+r*(n-e))}function qn(t,n,r,o,{type:i,nice:a,clamp:l,domain:s=Bn(o),unknown:c,pivot:u=0,scheme:f,range:h,symmetric:d=!0,interpolate:p=(Zt.get(t)===_t?null==f&&void 0!==h?e.interpolateRgb:Ln(void 0!==f?f:"rdbu"):e.interpolateNumber),reverse:m}){u=+u,s=J(s);let[y,g]=s;if(s.length>2&&tn(`Warning: the diverging ${t} scale domain contains extra elements.`),e.descending(y,g)<0&&([y,g]=[g,y],m=!m),y=Math.min(y,u),g=Math.max(g,u),"function"!=typeof p&&(p=Rn(p)),void 0!==h&&(p=1===p.length?Dn(p)(...h):e.piecewise(p,h)),m&&(p=Sn(p)),d){const t=r.apply(u),e=t-r.apply(y),n=r.apply(g)-t;e<n?y=r.invert(t-n):e>n&&(g=r.invert(t+e))}return n.domain([y,u,g]).unknown(c).interpolator(p),l&&n.clamp(l),a&&n.nice(a),{type:i,domain:[y,g],pivot:u,interpolate:p,scale:n}}function Yn(t,n,{exponent:r=1,...o}){return qn(t,e.scaleDivergingPow().exponent(r=+r),function(t){return.5===t?Un:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),n,{...o,type:"diverging-pow"})}function _n(t,n,{constant:r=1,...o}){return qn(t,e.scaleDivergingSymlog().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),n,o)}const Gn={apply:t=>t,invert:t=>t},Xn={apply:Math.log,invert:Math.exp},Un={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function Vn(t,e,n,r){return On(t,e,n,r)}const Hn=Symbol("ordinal");function Zn(t,n,r,{type:o,interval:i,domain:a,range:l,reverse:s,hint:c}){return i=Lt(i,o),void 0===a&&(a=Kn(r,i,t)),"categorical"!==o&&o!==Hn||(o="ordinal"),s&&(a=e.reverse(a)),n.domain(a),void 0!==l&&("function"==typeof l&&(l=l(a)),n.range(l)),{type:o,domain:a,range:l,scale:n,hint:c,interval:i}}function Qn(t,n,{type:r,interval:o,domain:i,range:a,scheme:l,unknown:s,...c}){let u;if(o=Lt(o,r),void 0===i&&(i=Kn(n,o,t)),Zt.get(t)===Vt)u=function(t){return{fill:tr(t,"fill"),stroke:tr(t,"stroke")}}(n),a=void 0===a?function(t){return It(t.fill)?e.symbolsStroke:e.symbolsFill}(u):K(a,re);else if(Zt.get(t)===_t&&(void 0!==a||"ordinal"!==r&&r!==Hn||(a=function(t,e="greys"){const n=new Set,[r,o]=$n(e,2);for(const e of t)if(null!=e)if(!0===e)n.add(o);else{if(!1!==e)return;n.add(r)}return[...n]}(i,l),void 0!==a&&(l=void 0)),void 0===l&&void 0===a&&(l="ordinal"===r?"turbo":"tableau10"),void 0!==l))if(void 0!==a){const t=Ln(l),n=a[0],r=a[1]-a[0];a=({length:o})=>e.quantize((e=>t(n+r*e)),o)}else a=kn(l);if(s===e.scaleImplicit)throw new Error(`implicit unknown on ${t} scale is not supported`);return Zn(t,e.scaleOrdinal().unknown(s),n,{...c,type:r,domain:i,range:a,hint:u})}function Jn(t,e,n,r){let{round:o}=n;return void 0!==o&&t.round(o=!!o),(t=Zn(r,t,e,n)).round=o,t}function Kn(t,n,o){const i=new e.InternSet;for(const{value:e,domain:n}of t){if(void 0!==n)return n();if(void 0!==e)for(const t of e)i.add(t)}if(void 0!==n){const[t,r]=e.extent(i).map(n.floor,n);return n.range(t,n.offset(r))}if(i.size>1e4&&Zt.get(o)===Yt)throw new Error(`implicit ordinal domain of ${o} scale has more than 10,000 values`);return e.sort(i,r)}function tr(t,e){let n;for(const{hint:r}of t){const t=r?.[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}function er(t,{label:e,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n,round:l,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,facet:{label:p=e}={},...m}={}){const y={};for(const[n,g]of t){const t=m[n],v=fr(n,g,{round:Zt.get(n)===Yt?l:void 0,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,...t});if(v){let{label:l=("fx"===n||"fy"===n?p:e),percent:s,transform:c,inset:u,insetTop:f=(void 0!==u?u:"y"===n?r:0),insetRight:h=(void 0!==u?u:"x"===n?o:0),insetBottom:d=(void 0!==u?u:"y"===n?i:0),insetLeft:m=(void 0!==u?u:"x"===n?a:0)}=t||{};if(null==c)c=void 0;else if("function"!=typeof c)throw new Error("invalid scale transform; not a function");v.percent=!!s,v.label=void 0===l?rr(g,v):l,v.transform=c,"x"===n||"fx"===n?(v.insetLeft=+m,v.insetRight=+h):"y"!==n&&"fy"!==n||(v.insetTop=+f,v.insetBottom=+d),y[n]=v}}return y}function nr(t){return Object.fromEntries(Object.entries(t).filter((([,{scale:t}])=>t)).map((([t,{scale:e,type:n,interval:r,label:o}])=>(e.type=n,null!=r&&(e.interval=r),null!=o&&(e.label=o),[t,e]))))}function rr(t=[],e){let n;for(const{label:e}of t)if(void 0!==e)if(void 0===n)n=e;else if(n!==e)return;if(void 0!==n)return!yr(e)&&e.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function or(t){const{marginTop:e,marginRight:n,marginBottom:r,marginLeft:o,width:i,height:a,facet:{marginTop:l,marginRight:s,marginBottom:c,marginLeft:u}}=t;return{marginTop:Math.max(e,l),marginRight:Math.max(n,s),marginBottom:Math.max(r,c),marginLeft:Math.max(o,u),width:i,height:a}}function ir({fx:t,fy:e},n){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=or(n);return{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:t?t.scale.bandwidth()+a+o:l,height:e?e.scale.bandwidth()+r+i:s,facet:{width:l,height:s}}}function ar(t,e){if(void 0===t.range){const{insetLeft:n,insetRight:r}=t,{width:o,marginLeft:i=0,marginRight:a=0}=e,l=i+n,s=o-a-r;t.range=[l,Math.max(l,s)],yr(t)||(t.range=cr(t)),t.scale.range(t.range)}sr(t)}function lr(t,e){if(void 0===t.range){const{insetTop:n,insetBottom:r}=t,{height:o,marginTop:i=0,marginBottom:a=0}=e,l=i+n,s=o-a-r;t.range=[Math.max(l,s),l],yr(t)?t.range.reverse():t.range=cr(t),t.scale.range(t.range)}sr(t)}function sr(t){void 0===t.round&&function({type:t}){return"point"===t||"band"===t}(t)&&function({scale:t}){const e=t.domain().length,[n,r]=t.range(),o=t.paddingInner?t.paddingInner():1,i=t.paddingOuter?t.paddingOuter():t.padding(),a=e-o,l=Math.abs(r-n)/Math.max(1,a+2*i);return(l-Math.floor(l))*a}(t)<=30&&t.scale.round(!0)}function cr(t){const e=t.scale.domain().length+gr(t);if(!(e>2))return t.range;const[n,r]=t.range;return Array.from({length:e},((t,o)=>n+o/(e-1)*(r-n)))}function ur(t,e,n){return fr(t,void 0===n?void 0:[{hint:n}],{...e})}function fr(t,n=[],r={}){const o=function(t,e,{type:n,domain:r,range:o,scheme:i,pivot:a,projection:l}){if("fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==l||(n=dr);for(const{type:t}of e)if(void 0!==t)if(void 0===n)n=t;else if(n!==t)throw new Error(`scale incompatible with channel: ${n} !== ${t}`);if(n===dr)return;if(void 0!==n)return n;if(void 0===r&&!e.some((({value:t})=>void 0!==t)))return;const s=Zt.get(t);if(s===Gt)return"sqrt";if(s===Ut||s===Xt)return"linear";if(s===Vt)return"ordinal";if((r||o||[]).length>2)return pr(s);if(void 0!==r){if(Et(r))return pr(s);if(Rt(r))return"utc"}else{const t=e.map((({value:t})=>t)).filter((t=>void 0!==t));if(t.some(Et))return pr(s);if(t.some(Rt))return"utc"}if(s===_t){if(null!=a||function(t){return null!=t&&An.has(`${t}`.toLowerCase())}(i))return"diverging";if(function(t){return null!=t&&mn.has(`${t}`.toLowerCase())}(i))return"categorical"}return"linear"}(t,n,r);if(void 0===r.type&&void 0===r.domain&&void 0===r.range&&null==r.interval&&"fx"!==t&&"fy"!==t&&yr({type:o})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(Rt)?tn(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${hr(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${hr(o)}".`):e.some(Ot)?tn(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${hr(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${hr(o)}".`):e.some(Ct)&&tn(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${hr(o)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${hr(o)}".`)}switch(r.type=o,o){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=xr(n,r,_);break;case"identity":switch(Zt.get(t)){case Yt:r=xr(n,r,_);break;case Vt:r=xr(n,r,wr)}break;case"utc":case"time":r=xr(n,r,X)}switch(o){case"diverging":return function(t,n,r){return qn(t,e.scaleDiverging(),Gn,n,r)}(t,n,r);case"diverging-sqrt":return function(t,e,n){return Yn(t,e,{...n,exponent:.5})}(t,n,r);case"diverging-pow":return Yn(t,n,r);case"diverging-log":return function(t,n,{base:r=10,pivot:o=1,domain:i=Bn(n,o<0?s:l),...a}){return qn(t,e.scaleDivergingLog().base(r=+r),Xn,n,{domain:i,pivot:o,...a})}(t,n,r);case"diverging-symlog":return _n(t,n,r);case"categorical":case"ordinal":case Hn:return Qn(t,n,r);case"cyclical":case"sequential":case"linear":return function(t,n,r){return On(t,e.scaleLinear(),n,r)}(t,n,r);case"sqrt":return function(t,e,n){return Cn(t,e,{...n,exponent:.5})}(t,n,r);case"threshold":return Tn(t,0,r);case"quantile":return function(t,n,{range:r,quantiles:o=(void 0===r?5:(r=[...r]).length),n:i=o,scheme:a="rdylbu",domain:l=Fn(n),unknown:s,interpolate:c,reverse:u}){return void 0===r&&(r=void 0!==c?e.quantize(c,i):Zt.get(t)===_t?$n(a,i):void 0),l.length>0&&(l=e.scaleQuantile(l,void 0===r?{length:i}:r).quantiles()),Tn(t,0,{domain:l,range:r,reverse:u,unknown:s})}(t,n,r);case"quantize":return function(t,n,{range:r,n:o=(void 0===r?5:(r=[...r]).length),scheme:i="rdylbu",domain:a=Nn(t,n),unknown:l,interpolate:s,reverse:c}){const[u,f]=e.extent(a);let h;return void 0===r?(h=e.ticks(u,f,o),h[0]<=u&&h.splice(0,1),h[h.length-1]>=f&&h.pop(),o=h.length+1,r=void 0!==s?e.quantize(s,o):Zt.get(t)===_t?$n(i,o):void 0):(h=e.quantize(e.interpolateNumber(u,f),o+1).slice(1,-1),u instanceof Date&&(h=h.map((t=>new Date(t))))),Dt(J(a))<0&&h.reverse(),Tn(t,0,{domain:h,range:r,reverse:c,unknown:l})}(t,n,r);case"pow":return Cn(t,n,r);case"log":return function(t,n,{base:r=10,domain:o=jn(n),...i}){return On(t,e.scaleLog().base(r),n,{...i,domain:o})}(t,n,r);case"symlog":return function(t,n,{constant:r=1,...o}){return On(t,e.scaleSymlog().constant(r),n,o)}(t,n,r);case"utc":return function(t,n,r){return Vn(t,e.scaleUtc(),n,r)}(t,n,r);case"time":return function(t,n,r){return Vn(t,e.scaleTime(),n,r)}(t,n,r);case"point":return function(t,n,{align:r=.5,padding:o=.5,...i}){return Jn(e.scalePoint().align(r).padding(o),n,i,t)}(t,n,r);case"band":return function(t,n,{align:r=.5,padding:o=.1,paddingInner:i=o,paddingOuter:a=("fx"===t||"fy"===t?0:o),...l}){return Jn(e.scaleBand().align(r).paddingInner(i).paddingOuter(a),n,l,t)}(t,n,r);case"identity":return Zt.get(t)===Yt?{type:"identity",scale:e.scaleIdentity()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${o}`)}}function hr(t){return"symbol"==typeof t?t.description:t}const dr={toString:()=>"projection"};function pr(t){switch(t){case Yt:return"point";case _t:return Hn;default:return"ordinal"}}function mr({type:t}){return"time"===t||"utc"===t}function yr({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===Hn}function gr({type:t}){return"threshold"===t}function vr(t){if(void 0===t)return!0;const e=t.domain(),n=t(e[0]);for(let r=1,o=e.length;r<o;++r)if(t(e[r])-n)return!1;return!0}function xr(t,{domain:e,...n},r){for(const e of t)void 0!==e.value&&(e.value=r(e.value));return{domain:void 0===e?e:r(e),...n}}function wr(t){return K(t,re)}function br({scale:t,type:e,domain:n,range:r,interpolate:o,interval:i,transform:a,percent:l,pivot:s}){if("identity"===e)return{type:"identity",apply:t=>t,invert:t=>t};const c=t.unknown?t.unknown():void 0;return{type:e,domain:tt(n),...void 0!==r&&{range:tt(r)},...void 0!==a&&{transform:a},...l&&{percent:l},...void 0!==c&&{unknown:c},...void 0!==i&&{interval:i},...void 0!==o&&{interpolate:o},...t.clamp&&{clamp:t.clamp()},...void 0!==s&&{pivot:s,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:e=>t(e),...t.invert&&{invert:e=>t.invert(e)}}}function kr(t){let e,n;return(...r)=>((n?.length!==r.length||n.some(((t,e)=>t!==r[e])))&&(n=r,e=t(...r)),e)}const $r=kr((t=>new Intl.NumberFormat(t))),Mr=kr(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{month:e}}))),Lr=kr(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{weekday:e}})));function Ar(t){return c(t,"Invalid Date")}const Sr=function(t="en-US"){const e=function(t="en-US"){const e=$r(t);return t=>null==t||isNaN(t)?void 0:e.format(t)}(t);return t=>(t instanceof Date?Ar:"number"==typeof t?e:I)(t)}(),zr=("undefined"!=typeof window?window.devicePixelRatio>1:"undefined"==typeof it)?0:.5;let Er=0;function Rr(){return"plot-clip-"+ ++Er}function Or(t,{title:e,href:n,ariaLabel:r,ariaDescription:o,ariaHidden:i,target:a,fill:l,fillOpacity:s,stroke:c,strokeWidth:u,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:y,opacity:g,mixBlendMode:v,imageFilter:x,paintOrder:w,pointerEvents:b,shapeRendering:k,channels:$},{ariaLabel:M,fill:L="currentColor",fillOpacity:A,stroke:S="none",strokeOpacity:z,strokeWidth:E,strokeLinecap:R,strokeLinejoin:O,strokeMiterlimit:C,paintOrder:T}){null===L&&(l=null,s=null),null===S&&(c=null,f=null),It(L)?It(S)||It(l)&&!$?.fill||(S="none"):!It(S)||It(c)&&!$?.stroke||(L="none");const[B,N]=V(l,L),[P,W]=H(s,A),[j,F]=V(c,S),[D,q]=H(f,z),[Y,_]=H(g);Wt(F)||(void 0===u&&(u=E),void 0===d&&(d=R),void 0===h&&(h=O),void 0!==p||/^\s*round\s*$/i.test(h)||(p=C),Wt(N)||void 0!==w||(w=T));const[G,X]=H(u);return null!==L&&(t.fill=Yr(N,"currentColor"),t.fillOpacity=_r(W,1)),null!==S&&(t.stroke=Yr(F,"none"),t.strokeWidth=_r(X,1),t.strokeOpacity=_r(q,1),t.strokeLinejoin=Yr(h,"miter"),t.strokeLinecap=Yr(d,"butt"),t.strokeMiterlimit=_r(p,4),t.strokeDasharray=Yr(m,"none"),t.strokeDashoffset=Yr(y,"0")),t.target=I(a),t.ariaLabel=I(M),t.ariaDescription=I(o),t.ariaHidden=I(i),t.opacity=_r(_,1),t.mixBlendMode=Yr(v,"normal"),t.imageFilter=Yr(x,"none"),t.paintOrder=Yr(w,"normal"),t.pointerEvents=Yr(b,"auto"),t.shapeRendering=Yr(k,"auto"),{title:{value:e,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:B,scale:"auto",optional:!0},fillOpacity:{value:P,scale:"auto",optional:!0},stroke:{value:j,scale:"auto",optional:!0},strokeOpacity:{value:D,scale:"auto",optional:!0},strokeWidth:{value:G,optional:!0},opacity:{value:Y,scale:"auto",optional:!0}}}function Cr(t,e){e&&t.text((t=>Sr(e[t])))}function Tr(t,e){e&&t.text((([t])=>Sr(e[t])))}function Br(t,{target:e,tip:n},{ariaLabel:r,title:o,fill:a,fillOpacity:l,stroke:s,strokeOpacity:c,strokeWidth:u,opacity:f,href:h}){r&&Dr(t,"aria-label",(t=>r[t])),a&&Dr(t,"fill",(t=>a[t])),l&&Dr(t,"fill-opacity",(t=>l[t])),s&&Dr(t,"stroke",(t=>s[t])),c&&Dr(t,"stroke-opacity",(t=>c[t])),u&&Dr(t,"stroke-width",(t=>u[t])),f&&Dr(t,"opacity",(t=>f[t])),h&&Fr(t,(t=>h[t]),e),n||function(t,e){e&&t.filter((t=>i(e[t]))).append("title").call(Cr,e)}(t,o)}function Nr(t,{target:e,tip:n},{ariaLabel:r,title:o,fill:a,fillOpacity:l,stroke:s,strokeOpacity:c,strokeWidth:u,opacity:f,href:h}){r&&Dr(t,"aria-label",(([t])=>r[t])),a&&Dr(t,"fill",(([t])=>a[t])),l&&Dr(t,"fill-opacity",(([t])=>l[t])),s&&Dr(t,"stroke",(([t])=>s[t])),c&&Dr(t,"stroke-opacity",(([t])=>c[t])),u&&Dr(t,"stroke-width",(([t])=>u[t])),f&&Dr(t,"opacity",(([t])=>f[t])),h&&Fr(t,(([t])=>h[t]),e),n||function(t,e){e&&t.filter((([t])=>i(e[t]))).append("title").call(Tr,e)}(t,o)}function Pr(t,n,r){const o=e.group(t,(t=>n[t]));return void 0===r&&o.size>1+t.length>>1&&tn("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),o.values()}function*Ir(t,e,r,o){const{z:i}=r,{z:a}=o,l=function({ariaLabel:t,title:e,fill:n,fillOpacity:r,stroke:o,strokeOpacity:i,strokeWidth:a,opacity:l,href:s},{tip:c}){return[t,c?void 0:e,n,r,o,i,a,l,s].filter((t=>void 0!==t))}(o,r),s=[...e,...l];for(const e of a?Pr(t,a,i):[t]){let t,r;t:for(const o of e){for(const t of s)if(!n(t[o])){r&&r.push(-1);continue t}if(void 0!==t){r.push(o);for(let e=0;e<l.length;++e){if(yt(l[e][o])!==t[e]){yield r,t=l.map((t=>yt(t[o]))),r=[o];continue t}}}else r&&(yield r),t=l.map((t=>yt(t[o]))),r=[o]}r&&(yield r)}}function Wr(t,n,r,o){!function(t,n,r,o){let i;switch(n.clip){case"frame":{const{width:e,height:n,marginLeft:a,marginRight:l,marginTop:s,marginBottom:c}=r,u=Rr();i=`url(#${u})`,t=Je("svg:g",o).call((t=>t.append("svg:clipPath").attr("id",u).append("rect").attr("x",a).attr("y",s).attr("width",e-l-a).attr("height",n-s-c))).each((function(){this.appendChild(t.node()),t.node=()=>this}));break}case"sphere":{const{projection:n}=o;if(!n)throw new Error('the "sphere" clip option requires a projection');const r=Rr();i=`url(#${r})`,t.append("clipPath").attr("id",r).append("path").attr("d",e.geoPath(n)({type:"Sphere"}));break}}Dr(t,"aria-label",n.ariaLabel),Dr(t,"aria-description",n.ariaDescription),Dr(t,"aria-hidden",n.ariaHidden),Dr(t,"clip-path",i)}(t,n,r,o),Dr(t,"fill",n.fill),Dr(t,"fill-opacity",n.fillOpacity),Dr(t,"stroke",n.stroke),Dr(t,"stroke-width",n.strokeWidth),Dr(t,"stroke-opacity",n.strokeOpacity),Dr(t,"stroke-linejoin",n.strokeLinejoin),Dr(t,"stroke-linecap",n.strokeLinecap),Dr(t,"stroke-miterlimit",n.strokeMiterlimit),Dr(t,"stroke-dasharray",n.strokeDasharray),Dr(t,"stroke-dashoffset",n.strokeDashoffset),Dr(t,"shape-rendering",n.shapeRendering),Dr(t,"filter",n.imageFilter),Dr(t,"paint-order",n.paintOrder);const{pointerEvents:i=(!1===o.pointerSticky?"none":void 0)}=n;Dr(t,"pointer-events",i)}function jr(t,e){!function(t,e,n){null!=n&&t.style(e,n)}(t,"mix-blend-mode",e.mixBlendMode),Dr(t,"opacity",e.opacity)}function Fr(t,n,r){t.each((function(t){const o=n(t);if(null!=o){const t=this.ownerDocument.createElementNS(e.namespaces.svg,"a");t.setAttribute("fill","inherit"),t.setAttributeNS(e.namespaces.xlink,"href",o),null!=r&&t.setAttribute("target",r),this.parentNode.insertBefore(t,this).appendChild(this)}}))}function Dr(t,e,n){null!=n&&t.attr(e,n)}function qr(t,e,{x:n,y:r},o=zr,i=zr){o+=e.dx,i+=e.dy,n?.bandwidth&&(o+=n.bandwidth()/2),r?.bandwidth&&(i+=r.bandwidth()/2),(o||i)&&t.attr("transform",`translate(${o},${i})`)}function Yr(t,e){if((t=I(t))!==e)return t}function _r(t,e){if((t=W(t))!==e)return t}const Gr=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function Xr(t){if(void 0===t)return"plot-d6a7b5";if(t=`${t}`,!Gr.test(t))throw new Error(`invalid class name: ${t}`);return t}function Ur(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function Vr({frameAnchor:t},{width:e,height:n,marginTop:r,marginRight:o,marginBottom:i,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?e-o:(a+e-o)/2,/^top/.test(t)?r:/^bottom/.test(t)?n-i:(r+n-i)/2]}function Hr({x:t,y:e,fy:n,fx:r},{projection:o,aspectRatio:i},{width:a,marginTopDefault:l,marginRightDefault:s,marginBottomDefault:c,marginLeftDefault:u}){const f=n?n.scale.domain().length:1,h=function(t){if("function"==typeof t?.stream)return rn;if(ot(t)&&(t=t.type),null!=t){if("function"!=typeof t){const{aspectRatio:e}=an(t);if(e)return e}return rn}}(o);if(h){const t=(1.1*f-.1)/(1.1*(r?r.scale.domain().length:1)-.1)*h,e=Math.max(.1,Math.min(10,t));return Math.round((a-u-s)*e+l+c)}const d=e?yr(e)?e.scale.domain().length:Math.max(7,17/f):1;if(null!=i){if(i=+i,!(isFinite(i)&&i>0))throw new Error(`invalid aspectRatio: ${i}`);const o=Zr("y",e)/(Zr("x",t)*i),f=r?r.scale.bandwidth():1,h=n?n.scale.bandwidth():1;return(o*(f*(a-u-s)-t.insetLeft-t.insetRight)+e.insetTop+e.insetBottom)/h+l+c}return!(!e&&!n)*Math.max(1,Math.min(60,d*f))*20+30*!!r+60}function Zr(t,n){if(!n)throw new Error(`aspectRatio requires ${t} scale`);const{type:r,domain:o}=n;let i;switch(r){case"linear":case"utc":case"time":i=Number;break;case"pow":{const t=n.scale.exponent();i=e=>Math.pow(e,t);break}case"log":i=Math.log;break;case"point":case"band":return o.length;default:throw new Error(`unsupported ${t} scale for aspectRatio: ${r}`)}const[a,l]=e.extent(o);return Math.abs(i(l)-i(a))}function Qr(t,{fx:n,fy:r}){const o=ht(t),i=n?.value,a=r?.value;return n&&r?e.rollup(o,(t=>(t.fx=i[t[0]],t.fy=a[t[0]],t)),(t=>i[t]),(t=>a[t])):n?e.rollup(o,(t=>(t.fx=i[t[0]],t)),(t=>i[t])):e.rollup(o,(t=>(t.fy=a[t[0]],t)),(t=>a[t]))}function Jr(t){const n=[],r=new Uint32Array(e.sum(t,(t=>t.length)));for(const e of t){let o=0;for(const n of t)e!==n&&(r.set(n,o),o+=n.length);n.push(r.slice(0,o))}return n}const Kr=new Map([["top",oo],["right",lo],["bottom",io],["left",ao],["top-left",so(oo,ao)],["top-right",so(oo,lo)],["bottom-left",so(io,ao)],["bottom-right",so(io,lo)],["top-empty",function(t,{y:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=no(e,r);if(i>0)return ro(t,n,e[i-1])}],["right-empty",function(t,{x:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=no(e,n);if(i<e.length-1)return ro(t,e[i+1],r)}],["bottom-empty",function(t,{y:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=no(e,r);if(i<e.length-1)return ro(t,n,e[i+1])}],["left-empty",function(t,{x:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=no(e,n);if(i>0)return ro(t,e[i-1],r)}],["empty",function(t,e,{empty:n}){return n}]]);const to=new WeakMap;function eo(t){let n=to.get(t);return n||to.set(t,n=new e.InternMap(K(t,((t,e)=>[t,e])))),n}function no(t,e){return eo(t).get(e)}function ro(t,e,n){return function(t,e,n){return e=yt(e),n=yt(n),t.find((t=>Object.is(yt(t.x),e)&&Object.is(yt(t.y),n)))}(t,e,n)?.empty}function oo(t,{y:e},{y:n}){return!e||0===no(e,n)}function io(t,{y:e},{y:n}){return!e||no(e,n)===e.length-1}function ao(t,{x:e},{x:n}){return!e||0===no(e,n)}function lo(t,{x:e},{x:n}){return!e||no(e,n)===e.length-1}function so(t,e){return function(){return t.apply(null,arguments)&&e.apply(null,arguments)}}function co(t,{channels:{fx:e,fy:n},groups:r}){return e&&n?t.map((({x:t,y:e})=>r.get(t)?.get(e)??[])):e?t.map((({x:t})=>r.get(t)??[])):t.map((({y:t})=>r.get(t)??[]))}class uo{constructor(t,e={},n={},r){const{facet:o="auto",facetAnchor:i,fx:a,fy:l,sort:s,dx:c=0,dy:u=0,margin:f=0,marginTop:h=f,marginRight:d=f,marginBottom:p=f,marginLeft:m=f,clip:y,channels:g,tip:v,render:x}=n;if(this.data=t,this.sort=st(s)?s:null,this.initializer=ie(n).initializer,this.transform=this.initializer?n.transform:oe(n).transform,null===o||!1===o?this.facet=null:(this.facet=Q(!0===o?"include":o,"facet",["auto","include","exclude","super"]),this.fx=t===O&&"string"==typeof a?[a]:a,this.fy=t===O&&"string"==typeof l?[l]:l),this.facetAnchor=function(t){if(null==t)return null;const e=Kr.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid facet anchor: ${t}`)}(i),e=qt(e),void 0!==g&&(e={...po(g),...e}),void 0!==r&&(e={...Or(this,n,r),...e}),this.channels=Object.fromEntries(Object.entries(e).map((([e,n])=>{if(lt(n.value)){const{value:t,scale:e=n.scale}=n.value;n={...n,scale:e,value:t}}if(t===O&&"string"==typeof n.value){const{value:t}=n;n={...n,value:[t]}}return[e,n]})).filter((([t,{value:e,optional:n}])=>{if(null!=e)return!0;if(n)return!1;throw new Error(`missing channel value: ${t}`)}))),this.dx=+c,this.dy=+u,this.marginTop=+h,this.marginRight=+d,this.marginBottom=+p,this.marginLeft=+m,this.clip=function(t){return!0===t?t="frame":!1===t&&(t=null),Z(t,"clip",["frame","sphere"])}(y),this.tip=function(t){return!0===t?"xy":!1===t?null:Z(t,"tip",["x","y","xy"])}(v),"super"===this.facet){if(a||l)throw new Error("super-faceting cannot use fx or fy");for(const t in this.channels){const{scale:n}=e[t];if("x"===n||"y"===n)throw new Error("super-faceting cannot use x or y")}}null!=x&&(this.render=ho(x,this.render))}initialize(t,n,r){let o=J(this.data);void 0===t&&null!=o&&(t=[ht(o)]);const i=t;null!=this.transform&&(({facets:t,data:o}=this.transform(o,t,r)),o=J(o)),void 0!==t&&(t.original=i);const a=Fe(this.channels,o);return null!=this.sort&&function(t,n,r,o,i){const{order:a,reverse:l,reduce:s=!0,limit:c}=i;for(const u in i){if(!Zt.has(u))continue;let{value:f,order:h=a,reverse:d=l,reduce:p=s,limit:m=c}=At(i[u]);const y=f?.startsWith("-");if(y&&(f=f.slice(1)),h=void 0===h?y!==("width"===f||"height"===f)?He:Ve:Ue(h),null==p||!1===p)continue;const g="fx"===u||"fy"===u?_e(n,o[u]):Ye(r,u);if(!g)throw new Error(`missing channel for scale: ${u}`);const v=g.value,[x=0,w=1/0]=St(m)?m:m<0?[m]:[0,m];if(null==f)g.domain=()=>{let t=Array.from(new e.InternSet(v));return d&&(t=t.reverse()),0===x&&w===1/0||(t=t.slice(x,w)),t};else{const n="data"===f?t:"height"===f?Ge(r,"y1","y2"):"width"===f?Ge(r,"x1","x2"):Xe(r,f,"y"===f?"y2":"x"===f?"x2":void 0),o=Le(!0===p?"max":p,n);g.domain=()=>{let t=e.rollups(ht(v),(t=>o.reduceIndex(t,n)),(t=>v[t]));return h&&t.sort(h),d&&t.reverse(),0===x&&w===1/0||(t=t.slice(x,w)),t.map(j)}}}}(o,t,a,n,this.sort),{data:o,facets:t,channels:a}}filter(t,e,r){for(const o in e){const{filter:i=n}=e[o];if(null!==i){const e=r[o];t=t.filter((t=>i(e[t])))}}return t}project(t,e,n){for(const r in t)if("x"===t[r].scale&&/^x|x$/.test(r)){const o=r.replace(/^x|x$/,"y");o in t&&"y"===t[o].scale&&fn(r,o,e,n.projection)}}scale(t,e,n){const r=De(t,e);return n.projection&&this.project(t,r,n),r}}function fo(...t){return t.plot=uo.prototype.plot,t}function ho(t,e){if(null==t)return null===e?void 0:e;if(null==e)return null===t?void 0:t;if("function"!=typeof t)throw new TypeError(`invalid render transform: ${t}`);if("function"!=typeof e)throw new TypeError(`invalid render transform: ${e}`);return function(n,r,o,i,a,l){return t.call(this,n,r,o,i,a,((t,n,r,o,i)=>e.call(this,t,n,r,o,i,l)))}}function po(t){return Object.fromEntries(Object.entries(qt(t)).map((([t,e])=>(void 0===(e=At(e)).filter&&null==e.scale&&(e={...e,filter:null}),[t,e]))))}function mo(t,e){return!0===t?.tip?{...t,tip:e}:t}const yo=new WeakMap;function go(t,n,{x:r,y:o,px:i,py:a,maxRadius:l=40,channels:s,render:c,...u}={}){return l=+l,null!=i&&(r??=null,s={...s,px:{value:i,scale:"x"}}),null!=a&&(o??=null,s={...s,py:{value:a,scale:"y"}}),{x:r,y:o,channels:s,...u,render:ho((function(r,o,i,a,s,c){const u=(s={...s,pointerSticky:!1}).ownerSVGElement,{data:f}=s.getMarkState(this);let h=yo.get(u);h||yo.set(u,h={sticky:!1,roots:[],renders:[]});let d=h.renders.push(T)-1;const{x:p,y:m,fx:y,fy:g}=o;let v=y?y(r.fx)-a.marginLeft:0,x=g?g(r.fy)-a.marginTop:0;p?.bandwidth&&(v+=p.bandwidth()/2),m?.bandwidth&&(x+=m.bandwidth()/2);const w=null!=r.fi;let b;if(w){let t=h.facetStates;t||(h.facetStates=t=new Map),b=t.get(this),b||t.set(this,b=new Map)}const[k,$]=Vr(this,a),{px:M,py:L}=i,A=M?t=>M[t]:bo(i,k),S=L?t=>L[t]:ko(i,$);let z,E,R,O;function C(t,e){if(w){if(O&&(O=cancelAnimationFrame(O)),null!=t)return b.set(r.fi,e),void(O=requestAnimationFrame((()=>{O=null;for(const n of b.values())if(n<e){t=null;break}T(t)})));b.delete(r.fi)}T(t)}function T(t){if(z===t&&R===h.sticky)return;z=t,R=s.pointerSticky=h.sticky;const e=null==z?[]:[z];w&&(e.fx=r.fx,e.fy=r.fy,e.fi=r.fi);const n=c(e,o,i,a,s);if(E){if(w){const t=E.parentNode,e=E.getAttribute("transform"),r=n.getAttribute("transform");e?n.setAttribute("transform",e):n.removeAttribute("transform"),r?t.setAttribute("transform",r):t.removeAttribute("transform"),n.removeAttribute("aria-label"),n.removeAttribute("aria-description"),n.removeAttribute("aria-hidden")}E.replaceWith(n)}return h.roots[d]=E=n,s.dispatchValue(null==z?null:f[z]),n}function B(o){if(h.sticky||"mouse"===o.pointerType&&1===o.buttons)return;let[i,a]=e.pointer(o);i-=v,a-=x;let s=null,c=l*l;for(const e of r){const r=t*(A(e)-i),o=n*(S(e)-a),l=r*r+o*o;l<=c&&(s=e,c=l)}C(s,c)}return u.addEventListener("pointerenter",B),u.addEventListener("pointermove",B),u.addEventListener("pointerdown",(function(t){"mouse"===t.pointerType&&null!=z&&(h.sticky&&h.roots.some((e=>e?.contains(t.target)))||(h.sticky?(h.sticky=!1,h.renders.forEach((t=>t(null)))):(h.sticky=!0,T(z)),t.stopImmediatePropagation()))})),u.addEventListener("pointerleave",(function(t){"mouse"===t.pointerType&&(h.sticky||C(null))})),T(null)}),c)}}function vo(t){return go(1,1,t)}function xo(t){return go(1,.01,t)}function wo(t){return go(.01,1,t)}function bo({x1:t,x2:e,x:n=t},r){return t&&e?n=>(t[n]+e[n])/2:n?t=>n[t]:()=>r}function ko({y1:t,y2:e,y:n=t},r){return t&&e?n=>(t[n]+e[n])/2:n?t=>n[t]:()=>r}function $o(t){return yr(t)&&void 0===t.interval?void 0:"tabular-nums"}const Mo=Math.PI/180;function Lo(t,{marker:e,markerStart:n=e,markerMid:r=e,markerEnd:o=e}={}){t.markerStart=Ao(n),t.markerMid=Ao(r),t.markerEnd=Ao(o)}function Ao(t){if(null==t||!1===t)return null;if(!0===t)return Eo;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return So("auto");case"arrow-reverse":return So("auto-start-reverse");case"dot":return zo;case"circle":case"circle-fill":return Eo;case"circle-stroke":return Ro}throw new Error(`invalid marker: ${t}`)}function So(t){return(e,n)=>Je("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",t).attr("fill","none").attr("stroke",e).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call((t=>t.append("path").attr("d","M-1.5,-3l3,3l-3,3"))).node()}function zo(t,e){return Je("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call((t=>t.append("circle").attr("r",2.5))).node()}function Eo(t,e){return Je("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","white").attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function Ro(t,e){return Je("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","white").attr("stroke",t).attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}let Oo=0;function Co(t,e,{stroke:n},r){return Bo(t,e,n&&(t=>n[t]),r)}function To(t,e,{stroke:n},r){return Bo(t,e,n&&(([t])=>n[t]),r)}function Bo(t,{markerStart:e,markerMid:n,markerEnd:r,stroke:o},i=(()=>o),a){const l=new Map;function s(t){return function(e){const n=i(e);let r=l.get(t);r||l.set(t,r=new Map);let o=r.get(n);if(!o){const e=this.parentNode.insertBefore(t(n,a),this),i="plot-marker-"+ ++Oo;e.setAttribute("id",i),r.set(n,o=`url(#${i})`)}return o}}e&&t.attr("marker-start",s(e)),n&&t.attr("marker-mid",s(n)),r&&t.attr("marker-end",s(r))}function No({inset:t,insetLeft:e,insetRight:n,...r}={}){return[e,n]=Io(t,e,n),{inset:t,insetLeft:e,insetRight:n,...r}}function Po({inset:t,insetTop:e,insetBottom:n,...r}={}){return[e,n]=Io(t,e,n),{inset:t,insetTop:e,insetBottom:n,...r}}function Io(t,e,n){return void 0===t&&void 0===e&&void 0===n?zr?[1,0]:[.5,.5]:[e,n]}function Wo(t,{interval:e}){return(t={...At(t)}).interval=Mt(void 0===t.interval?e:t.interval),t}function jo(t,e,n,r){const{[t]:o,[`${t}1`]:i,[`${t}2`]:a}=n,{value:l,interval:s}=Wo(o,n);if(null==l||null==s&&!r)return n;const c=wt(o);if(null==s){let e;const r={transform:t=>e||(e=z(t,l)),label:c};return{...n,[t]:void 0,[`${t}1`]:void 0===i?r:i,[`${t}2`]:void 0===a?r:a}}let u,f;function h(t){return void 0!==f&&t===u?f:f=K(z(u=t,l),(t=>s.floor(t)))}return e({...n,[t]:void 0,[`${t}1`]:void 0===i?{transform:h,label:c}:i,[`${t}2`]:void 0===a?{transform:t=>h(t).map((t=>s.offset(t))),label:c}:a})}function Fo(t,e,n){const{[t]:r}=n,{value:o,interval:i}=Wo(r,n);return null==o||null==i?n:e({...n,[t]:{label:wt(r),transform:t=>{const e=K(z(t,o),(t=>i.floor(t))),n=e.map((t=>i.offset(t)));return e.map(Rt(e)?(t,e)=>null==t||isNaN(t=+t)||null==(e=n[e])||isNaN(e=+e)?void 0:new Date((t+e)/2):(t,e)=>null==t||null==(e=n[e])?NaN:(+t+ +e)/2)}}})}function Do(t={}){return jo("x",No,t,!0)}function qo(t={}){return jo("y",Po,t,!0)}function Yo(t={}){return jo("x",No,t)}function _o(t={}){return jo("y",Po,t)}function Go(t={}){return Fo("x",No,t)}function Xo(t={}){return Fo("y",Po,t)}const Uo={ariaLabel:"rule",fill:null,stroke:"currentColor"};class Vo extends uo{constructor(t,e={}){const{x:n,y1:r,y2:o,inset:i=0,insetTop:a=i,insetBottom:l=i}=e;super(t,{x:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},mo(e,"x"),Uo),this.insetTop=W(a),this.insetBottom=W(l),Lo(this,e)}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y1:s,y2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetTop:y,insetBottom:g}=this;return Je("svg:g",o).call(Wr,this,r,o).call(qr,this,{x:l&&i},zr,0).call((e=>e.selectAll().data(t).enter().append("line").call(jr,this).attr("x1",l?t=>l[t]:(p+u-d)/2).attr("x2",l?t=>l[t]:(p+u-d)/2).attr("y1",s&&!vr(a)?t=>s[t]+y:h+y).attr("y2",c&&!vr(a)?a.bandwidth?t=>c[t]+a.bandwidth()-g:t=>c[t]-g:f-m-g).call(Br,this,n).call(Co,this,n,o))).node()}}class Ho extends uo{constructor(t,e={}){const{x1:n,x2:r,y:o,inset:i=0,insetRight:a=i,insetLeft:l=i}=e;super(t,{y:{value:o,scale:"y",optional:!0},x1:{value:n,scale:"x",optional:!0},x2:{value:r,scale:"x",optional:!0}},mo(e,"y"),Uo),this.insetRight=W(a),this.insetLeft=W(l),Lo(this,e)}render(t,e,n,r,o){const{x:i,y:a}=e,{y:l,x1:s,x2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetLeft:y,insetRight:g}=this;return Je("svg:g",o).call(Wr,this,r,o).call(qr,this,{y:l&&a},0,zr).call((e=>e.selectAll().data(t).enter().append("line").call(jr,this).attr("x1",s&&!vr(i)?t=>s[t]+y:p+y).attr("x2",c&&!vr(i)?i.bandwidth?t=>c[t]+i.bandwidth()-g:t=>c[t]-g:u-d-g).attr("y1",l?t=>l[t]:(h+f-m)/2).attr("y2",l?t=>l[t]:(h+f-m)/2).call(Br,this,n).call(Co,this,n,o))).node()}}function Zo(t,e){let{x:n=B,y:r,y1:o,y2:i,...a}=_o(e);return[o,i]=Jo(r,o,i),new Vo(t,{...a,x:n,y1:o,y2:i})}function Qo(t,e){let{y:n=B,x:r,x1:o,x2:i,...a}=Yo(e);return[o,i]=Jo(r,o,i),new Ho(t,{...a,y:n,x1:o,x2:i})}function Jo(t,e,n){if(null==t){if(void 0===e){if(void 0!==n)return[0,n]}else if(void 0===n)return[0,e]}else{if(void 0===e)return void 0===n?[0,t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}function Ko(t,...e){let n=e.length;for(let r=0,o=!0;r<n;++r)"function"!=typeof e[r]&&(o&&(t=t.slice(),o=!1),t.splice(r,2,t[r]+e[r]+t[r+1]),e.splice(r,1),--r,--n);return r=>{let o=t[0];for(let i=0;i<n;++i)o+=e[i](r)+t[i+1];return o}}const ti={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},ei="Â­";class ni extends uo{constructor(t,e={}){const{x:n,y:r,text:o=(St(t)&&zt(t)?B:T),frameAnchor:a,textAnchor:l=(/right$/i.test(a)?"end":/left$/i.test(a)?"start":"middle"),lineAnchor:s=(/^top/i.test(a)?"top":/^bottom/i.test(a)?"bottom":"middle"),lineHeight:c=1,lineWidth:u=1/0,textOverflow:f,monospace:h,fontFamily:d=(h?"ui-monospace, monospace":void 0),fontSize:p,fontStyle:m,fontVariant:y,fontWeight:g,rotate:v}=e,[x,w]=H(v,0),[b,k]=function(t){return null==t||"number"==typeof t?[void 0,t]:"string"!=typeof t?[t,void 0]:(t=t.trim().toLowerCase(),ci.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}(p);var $;if(super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},fontSize:{value:b,optional:!0},rotate:{value:($=x,null==$?null:{transform:t=>z(t,$,Float64Array),label:wt($)}),optional:!0},text:{value:o,filter:i,optional:!0}},e,ti),this.rotate=w,this.textAnchor=Yr(l,"middle"),this.lineAnchor=Q(s,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+c,this.lineWidth=+u,this.textOverflow=ri(f),this.monospace=!!h,this.fontFamily=I(d),this.fontSize=k,this.fontStyle=I(m),this.fontVariant=I(y),this.fontWeight=I(g),this.frameAnchor=Ft(a),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${u}`);this.splitLines=pi(this),this.clipLine=mi(this)}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y:s,rotate:c,text:u,title:f,fontSize:h}=n,{rotate:d}=this,[p,m]=Vr(this,r);return Je("svg:g",o).call(Wr,this,r,o).call(si,this,u,r).call(qr,this,{x:l&&i,y:s&&a}).call((e=>e.selectAll().data(t).enter().append("text").call(jr,this).call(oi,this,u,f).attr("transform",Ko`translate(${l?t=>l[t]:p},${s?t=>s[t]:m})${c?t=>` rotate(${c[t]})`:d?` rotate(${d})`:""}`).call(Dr,"font-size",h&&(t=>h[t])).call(Br,this,n))).node()}}function ri(t){return null==t?null:Q(t,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function oi(t,n,r,o){if(!r)return;const{lineAnchor:i,lineHeight:a,textOverflow:l,splitLines:s,clipLine:c}=n;t.each((function(t){const n=s(Sr(r[t])??"").map(c),u=n.length,f="top"===i?.71:"bottom"===i?1-u:(164-100*u)/200;if(u>1){let t=0;for(let r=0;r<u;++r){if(++t,!n[r])continue;const o=this.ownerDocument.createElementNS(e.namespaces.svg,"tspan");o.setAttribute("x",0),r===t-1?o.setAttribute("y",(f+r)*a+"em"):o.setAttribute("dy",t*a+"em"),o.textContent=n[r],this.appendChild(o),t=0}}else f&&this.setAttribute("y",f*a+"em"),this.textContent=n[0];if(l&&!o&&n[0]!==r[t]){const n=this.ownerDocument.createElementNS(e.namespaces.svg,"title");n.textContent=r[t],this.appendChild(n)}}))}function ii(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=ut(e,n)),new ni(t,{...r,x:e,y:n})}function ai(t,{x:e=B,...n}={}){return new ni(t,Xo({...n,x:e}))}function li(t,{y:e=B,...n}={}){return new ni(t,Go({...n,y:e}))}function si(t,e,n){Dr(t,"text-anchor",e.textAnchor),Dr(t,"font-family",e.fontFamily),Dr(t,"font-size",e.fontSize),Dr(t,"font-style",e.fontStyle),Dr(t,"font-variant",void 0===e.fontVariant?function(t){return t&&(Tt(t)||Rt(t))?"tabular-nums":void 0}(n):e.fontVariant),Dr(t,"font-weight",e.fontWeight)}const ci=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function ui(t,e,n){const r=[];let o,i=0;for(const[a,l,s]of function*(t){let e=0,n=0;const r=t.length;for(;n<r;){let r=1;switch(t[n]){case ei:case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];" "===t[++n];);e=n;break;case"\r":"\n"===t[n+1]&&++r;case"\n":yield[e,n,!0],n+=r,e=n;break;default:++n}}yield[e,n,!0]}(t))void 0===o&&(o=a),i>o&&n(t,o,l)>e&&(r.push(t.slice(o,i)+(t[i-1]===ei?"-":"")),o=a),s?(r.push(t.slice(o,l)),o=void 0):i=l;return r}const fi={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"â€˜":31,"â€™":31,"â€œ":47,"â€":47,"â€¦":82};function hi(t,e=0,n=t.length){let r=0;for(let o=e;o<n;o=ki(t,o))r+=fi[t[o]]??(Mi(t,o)?120:fi.e);return r}function di(t,e=0,n=t.length){let r=0;for(let o=e;o<n;o=ki(t,o))r+=Mi(t,o)?200:100;return r}function pi({monospace:t,lineWidth:e,textOverflow:n}){if(null!=n||e==1/0)return t=>t.split(/\r\n?|\n/g);const r=t?di:hi,o=100*e;return t=>ui(t,o,r)}function mi({monospace:t,lineWidth:e,textOverflow:n}){if(null==n||e==1/0)return t=>t;const r=t?di:hi,o=100*e;switch(n){case"clip-start":return t=>xi(t,o,r,"");case"clip-end":return t=>vi(t,o,r,"");case"ellipsis-start":return t=>xi(t,o,r,yi);case"ellipsis-middle":return t=>function(t,e,n,r){t=t.trim();const o=n(t);if(o<=e)return t;const i=n(r)/2,[a,l]=gi(t,e/2,n,i),[s]=gi(t,o-e/2-l+i,n,-i);return s<0?r:t.slice(0,a).trimEnd()+r+t.slice(ki(t,s)).trimStart()}(t,o,r,yi);case"ellipsis-end":return t=>vi(t,o,r,yi)}}const yi="â€¦";function gi(t,e,n,r){const o=[];let i=0;for(let a=0,l=0,s=t.length;a<s;a=l){l=ki(t,a);const s=n(t,a,l);if(i+s>e){for(i+=r;i>e&&a>0;)l=a,a=o.pop(),i-=n(t,a,l);return[a,e-i]}i+=s,o.push(a)}return[-1,0]}function vi(t,e,n,r){t=t.trim();const o=n(r),[i]=gi(t,e,n,o);return i<0?t:t.slice(0,i).trimEnd()+r}function xi(t,e,n,r){const o=n(t=t.trim());if(o<=e)return t;const i=n(r),[a]=gi(t,o-e+i,n,-i);return a<0?r:r+t.slice(ki(t,a)).trimStart()}const wi=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,bi=/\p{Extended_Pictographic}/uy;function ki(t,e){return e+=function(t,e){const n=t.charCodeAt(e);if(n>=55296&&n<56320){const n=t.charCodeAt(e+1);return n>=56320&&n<57344}return!1}(t,e)?2:1,function(t,e){return!$i(t,e)&&(wi.lastIndex=e,wi.test(t))}(t,e)&&(e=wi.lastIndex),function(t,e){return 8205===t.charCodeAt(e)}(t,e)?ki(t,e+1):e}function $i(t,e){return t.charCodeAt(e)<128}function Mi(t,e){return!$i(t,e)&&(bi.lastIndex=e,bi.test(t))}const Li={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},Ai=3.5,Si=5*Ai,zi={draw(t,e,n){const r=e*n/Si;t.moveTo(0,0),t.lineTo(0,-e),t.moveTo(-r,r-e),t.lineTo(0,-e),t.lineTo(r,r-e)}},Ei={draw(t,e,n){t.moveTo(-n,0),t.lineTo(0,-e),t.lineTo(n,0)}},Ri=new Map([["arrow",zi],["spike",Ei]]);class Oi extends uo{constructor(t,e={}){const{x:n,y:r,r:o=Ai,length:i,rotate:a,shape:l=zi,anchor:s="middle",frameAnchor:c}=e,[u,f]=H(i,12),[h,d]=H(a,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},length:{value:u,scale:"length",optional:!0},rotate:{value:h,optional:!0}},e,Li),this.r=+o,this.length=f,this.rotate=d,this.shape=function(t){if(function(t){return t&&"function"==typeof t.draw}(t))return t;const e=Ri.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid shape: ${t}`)}(l),this.anchor=Q(s,"anchor",["start","middle","end"]),this.frameAnchor=Ft(c)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,length:u,rotate:f}=r,{length:h,rotate:d,anchor:p,shape:m,r:y}=this,[g,v]=Vr(this,o);return Je("svg:g",i).call(Wr,this,o,i).call(qr,this,{x:s&&a,y:c&&l}).call((n=>n.selectAll().data(t).enter().append("path").call(jr,this).attr("transform",Ko`translate(${s?t=>s[t]:g},${c?t=>c[t]:v})${f?t=>` rotate(${f[t]})`:d?` rotate(${d})`:""}${"start"===p?"":"end"===p?u?t=>` translate(0,${u[t]})`:` translate(0,${h})`:u?t=>` translate(0,${u[t]/2})`:` translate(0,${h/2})`}`).attr("d",u?t=>{const n=e.pathRound();return m.draw(n,u[t],y),n}:(()=>{const t=e.pathRound();return m.draw(t,h,y),t})()).call(Br,this,r))).node()}}function Ci(t,e={}){let{x:n,y:r,...o}=e;return void 0===e.frameAnchor&&([n,r]=ut(n,r)),new Oi(t,{...o,x:n,y:r})}function Ti(t,e={}){const{x:n=B,...r}=e;return new Oi(t,{...r,x:n})}function Bi(t,e={}){const{y:n=B,...r}=e;return new Oi(t,{...r,y:n})}function Ni(t,e){return arguments.length<2&&!St(t)&&(e=t,t=null),void 0===e&&(e={}),[t,e]}function Pi({anchor:t}={},e){return void 0===t?e[0]:Q(t,"anchor",e)}function Ii(t){return Pi(t,["left","right"])}function Wi(t){return Pi(t,["right","left"])}function ji(t){return Pi(t,["bottom","top"])}function Fi(t){return Pi(t,["top","bottom"])}function Di(){const[t,e]=Ni(...arguments);return Gi("y",Ii(e),t,e)}function qi(){const[t,e]=Ni(...arguments);return Gi("fy",Wi(e),t,e)}function Yi(){const[t,e]=Ni(...arguments);return Xi("x",ji(e),t,e)}function _i(){const[t,e]=Ni(...arguments);return Xi("fx",Fi(e),t,e)}function Gi(t,e,n,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("y"===t?6:0),tickPadding:m,tickRotate:y,x:g,margin:v,marginTop:x=(void 0===v?20:v),marginRight:w=(void 0===v?"right"===e?40:0:v),marginBottom:b=(void 0===v?20:v),marginLeft:k=(void 0===v?"left"===e?40:0:v),label:$,labelAnchor:M,labelArrow:L,labelOffset:A,...S}){return p=W(p),m=W(m),y=W(y),void 0!==M&&(M=Q(M,"labelAnchor",["center","top","bottom"])),L=ua(L),fo(p&&!It(i)?function(t,e,n,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=e+("y"===t?"-empty":""),frameAnchor:l=e,tickSize:s,inset:c=0,insetLeft:u=c,insetRight:f=c,dx:h=0,y:d=("y"===t?void 0:null),...p}){return ea(Bi,t,`${t}-axis tick`,n,{strokeWidth:r,strokeLinecap:o,strokeLinejoin:i,facetAnchor:a,frameAnchor:l,y:d,...p,dx:"left"===e?+h-zr+ +u:+h+zr-f,anchor:"start",length:s,shape:"left"===e?aa:la})}(t,e,n,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,x:g,...S}):null,It(s)?null:function(t,e,n,{facetAnchor:r=e+("y"===t?"-empty":""),frameAnchor:o=e,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>60?4*Math.cos(a*Mo):0),tickFormat:s,text:c=("function"==typeof s?s:void 0),textAnchor:u=(Math.abs(a)>60?"middle":"left"===e?"end":"start"),lineAnchor:f=(a>60?"top":a<-60?"bottom":"middle"),fontVariant:h,inset:d=0,insetLeft:p=d,insetRight:m=d,dx:y=0,y:g=("y"===t?void 0:null),...v}){return ea(li,t,`${t}-axis tick label`,n,{facetAnchor:r,frameAnchor:o,text:void 0===c?null:c,textAnchor:u,lineAnchor:f,fontVariant:h,rotate:a,y:g,...v,dx:"left"===e?+y-i-l+ +p:+y+ +i+ +l-m},(function(t,n,r,o){void 0===h&&(this.fontVariant=sa(t)),void 0===c&&(o.text=na(t,n,r,s,e))}))}(t,e,n,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,x:g,marginTop:x,marginRight:w,marginBottom:b,marginLeft:k,...S}),It(s)||null===$?null:ii([],ta({fill:s,fillOpacity:c,...S},(function(n,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="y"===t&&a.inset||a,h=M??(l.bandwidth?"center":"top"),d=A??("right"===e?c:f)-3;return"center"===h?(this.textAnchor=void 0,this.lineAnchor="right"===e?"bottom":"top",this.frameAnchor=e,this.rotate=-90):(this.textAnchor="right"===e?"end":"start",this.lineAnchor=h,this.frameAnchor=`${h}-${e}`,this.rotate=0),this.dy="top"===h?3-s:"bottom"===h?u-3:0,this.dx="right"===e?d:-d,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[ca(t,l,{anchor:e,label:$,labelAnchor:h,labelArrow:L})]}}}}))))}function Xi(t,e,n,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("x"===t?6:0),tickPadding:m,tickRotate:y,y:g,margin:v,marginTop:x=(void 0===v?"top"===e?30:0:v),marginRight:w=(void 0===v?20:v),marginBottom:b=(void 0===v?"bottom"===e?30:0:v),marginLeft:k=(void 0===v?20:v),label:$,labelAnchor:M,labelArrow:L,labelOffset:A,...S}){return p=W(p),m=W(m),y=W(y),void 0!==M&&(M=Q(M,"labelAnchor",["center","left","right"])),L=ua(L),fo(p&&!It(i)?function(t,e,n,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=e+("x"===t?"-empty":""),frameAnchor:l=e,tickSize:s,inset:c=0,insetTop:u=c,insetBottom:f=c,dy:h=0,x:d=("x"===t?void 0:null),...p}){return ea(Ti,t,`${t}-axis tick`,n,{strokeWidth:r,strokeLinejoin:i,strokeLinecap:o,facetAnchor:a,frameAnchor:l,x:d,...p,dy:"bottom"===e?+h-zr-f:+h+zr+ +u,anchor:"start",length:s,shape:"bottom"===e?oa:ia})}(t,e,n,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,y:g,...S}):null,It(s)?null:function(t,e,n,{facetAnchor:r=e+("x"===t?"-empty":""),frameAnchor:o=e,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>=10?4*Math.cos(a*Mo):0),tickFormat:s,text:c=("function"==typeof s?s:void 0),textAnchor:u=(Math.abs(a)>=10?a<0^"bottom"===e?"start":"end":"middle"),lineAnchor:f=(Math.abs(a)>=10?"middle":"bottom"===e?"top":"bottom"),fontVariant:h,inset:d=0,insetTop:p=d,insetBottom:m=d,dy:y=0,x:g=("x"===t?void 0:null),...v}){return ea(ai,t,`${t}-axis tick label`,n,{facetAnchor:r,frameAnchor:o,text:void 0===c?null:c,textAnchor:u,lineAnchor:f,fontVariant:h,rotate:a,x:g,...v,dy:"bottom"===e?+y+ +i+ +l-m:+y-i-l+ +p},(function(t,n,r,o){void 0===h&&(this.fontVariant=sa(t)),void 0===c&&(o.text=na(t,n,r,s,e))}))}(t,e,n,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,y:g,marginTop:x,marginRight:w,marginBottom:b,marginLeft:k,...S}),It(s)||null===$?null:ii([],ta({fill:s,fillOpacity:c,...S},(function(n,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="x"===t&&a.inset||a,h=M??(l.bandwidth?"center":"right"),d=A??("top"===e?s:u)-3;return"center"===h?(this.frameAnchor=e,this.textAnchor=void 0):(this.frameAnchor=`${e}-${h}`,this.textAnchor="right"===h?"end":"start"),this.lineAnchor=e,this.dy="top"===e?-d:d,this.dx="right"===h?c-3:"left"===h?3-f:0,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[ca(t,l,{anchor:e,label:$,labelAnchor:h,labelArrow:L})]}}}}))))}function Ui(){const[t,e]=Ni(...arguments);return Qi("y",Ii(e),t,e)}function Vi(){const[t,e]=Ni(...arguments);return Qi("fy",Wi(e),t,e)}function Hi(){const[t,e]=Ni(...arguments);return Ji("x",ji(e),t,e)}function Zi(){const[t,e]=Ni(...arguments);return Ji("fx",Fi(e),t,e)}function Qi(t,e,n,{y:r=("y"===t?void 0:null),x:o=null,x1:i=("left"===e?o:null),x2:a=("right"===e?o:null),...l}){return ea(Qo,t,`${t}-grid`,n,{y:r,x1:i,x2:a,...Ki(l)})}function Ji(t,e,n,{x:r=("x"===t?void 0:null),y:o=null,y1:i=("top"===e?o:null),y2:a=("bottom"===e?o:null),...l}){return ea(Zo,t,`${t}-grid`,n,{x:r,y1:i,y2:a,...Ki(l)})}function Ki({color:t="currentColor",opacity:e=.1,stroke:n=t,strokeOpacity:r=e,strokeWidth:o=1,...i}){return{stroke:n,strokeOpacity:r,strokeWidth:o,...i}}function ta({fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:o,fontWeight:i,monospace:a,pointerEvents:l,shapeRendering:s},c){return[,t]=V(t),[,e]=H(e),{facet:"super",x:null,y:null,fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:o,fontWeight:i,monospace:a,pointerEvents:l,shapeRendering:s,initializer:c}}function ea(t,n,r,o,i,a){let l;const s=ie(i).initializer,c=t(o,ie({...i,initializer:function(t,r,o,s,c,u){const f=null==t&&("fx"===n||"fy"===n),{[n]:h}=s;if(!h)throw new Error(`missing scale: ${n}`);let{ticks:d,tickSpacing:p,interval:m}=i;if(mr(h)&&"string"==typeof d&&(m=d,d=void 0),null==t){if(St(d))t=J(d);else if(h.ticks)if(void 0!==d)t=h.ticks(d);else if(m=Lt(void 0===m?h.interval:m,h.type),void 0!==m){const[n,r]=e.extent(h.domain());t=m.range(n,m.offset(m.floor(r)))}else{const[r,o]=e.extent(h.range());d=(o-r)/(void 0===p?"x"===n?80:35:p),t=h.ticks(d)}else t=h.domain();"y"===n||"x"===n?r=[ht(t)]:l[n]={scale:n,value:B}}a?.call(this,h,t,d,l);const y=Object.fromEntries(Object.entries(l).map((([e,n])=>[e,{...n,value:z(t,n.value)}])));return f&&(r=u.filterFacets(t,y)),{data:t,facets:r,channels:y}}},s));return null==o?(l=c.channels,c.channels={}):l={},c.ariaLabel=r,c}function na(t,e,n,r,o){return{value:ra(t,e,n,r,o)}}function ra(t,n,r,o,i){return void 0===o&&mr(t)?M(t,n,r,i):t.tickFormat?t.tickFormat(St(r)?null:r,o):void 0===o?function(t){if(!t)return!1;const n=t.floor(new Date(Date.UTC(2e3,11,31)));return e.utcYear(n)>=n}(t.interval)?e.utcFormat("%Y"):function(t){if(!t)return!1;const n=t.floor(new Date(2e3,11,31));return e.timeYear(n)>=n}(t.interval)?e.timeFormat("%Y"):Sr:"string"==typeof o?(Rt(t.domain())?e.utcFormat:e.format)(o):q(o)}const oa={draw(t,e){t.moveTo(0,0),t.lineTo(0,e)}},ia={draw(t,e){t.moveTo(0,0),t.lineTo(0,-e)}},aa={draw(t,e){t.moveTo(0,0),t.lineTo(-e,0)}},la={draw(t,e){t.moveTo(0,0),t.lineTo(e,0)}};function sa(t){return t.bandwidth&&!t.interval?void 0:"tabular-nums"}function ca(t,e,{anchor:n,label:r=e.label,labelAnchor:o,labelArrow:i}={}){if(!(null==r||r.inferred&&function(t){return mr(t)||null!=t.interval}(e)&&/^(date|time|year)$/i.test(r))){if(r=String(r),"auto"===i&&(i=(!e.bandwidth||e.interval)&&!/[â†‘â†“â†’â†]/.test(r)),!i)return r;if(!0===i){const n=function(t){return Math.sign(Dt(t.domain()))*Math.sign(Dt(t.range()))}(e);n&&(i=/x$/.test(t)||"center"===o?/x$/.test(t)===n<0?"left":"right":n<0?"up":"down")}switch(i){case"left":return`â† ${r}`;case"right":return`${r} â†’`;case"up":return"right"===n?`${r} â†‘`:`â†‘ ${r}`;case"down":return"right"===n?`${r} â†“`:`â†“ ${r}`}return r}}function ua(t="auto"){return!It(t)&&("boolean"==typeof t?t:Q(t,"labelArrow",["auto","up","right","down","left"]))}function fa(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function ha(t,e={},n){let{columns:r,tickFormat:o,fontVariant:i=$o(t),swatchSize:a=15,swatchWidth:l=a,swatchHeight:s=a,marginLeft:c=0,className:u,style:f,width:h}=e;const d=Qe(e);u=Xr(u),"function"!=typeof o&&(o=ra(t.scale,t.domain,void 0,o));const p=Je("div",d).attr("class",`${u}-swatches ${u}-swatches-${null!=r?"columns":"wrap"}`);let m;return null!=r?(m=`.${u}-swatches-columns .${u}-swatch {\n  display: flex;\n  align-items: center;\n  break-inside: avoid;\n  padding-bottom: 1px;\n}\n.${u}-swatches-columns .${u}-swatch::before {\n  flex-shrink: 0;\n}\n.${u}-swatches-columns .${u}-swatch-label {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}`,p.style("columns",r).selectAll().data(t.domain).enter().append("div").attr("class",`${u}-swatch`).call(n,t,l,s).call((t=>t.append("div").attr("class",`${u}-swatch-label`).attr("title",o).text(o)))):(m=`.${u}-swatches-wrap {\n  display: flex;\n  align-items: center;\n  min-height: 33px;\n  flex-wrap: wrap;\n}\n.${u}-swatches-wrap .${u}-swatch {\n  display: inline-flex;\n  align-items: center;\n  margin-right: 1em;\n}`,p.selectAll().data(t.domain).enter().append("span").attr("class",`${u}-swatch`).call(n,t,l,s).append((function(){return this.ownerDocument.createTextNode(o.apply(this,arguments))}))),p.call((t=>t.insert("style","*").text(`.${u}-swatches {\n  font-family: system-ui, sans-serif;\n  font-size: 10px;\n  margin-bottom: 0.5em;\n}\n.${u}-swatch > svg {\n  margin-right: 0.5em;\n  overflow: visible;\n}\n${m}`))).style("margin-left",c?+c+"px":null).style("width",void 0===h?null:+h+"px").style("font-variant",Yr(i,"normal")).call(Ur,f).node()}const da=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:r=1,stroke:o=(void 0!==t.hint?.stroke?t.hint.stroke:It(n)?"currentColor":"none"),strokeOpacity:i=1,strokeWidth:a=1.5,r:l=4.5,...s}={},c){const[u,f]=V(n),[h,d]=V(o),p=fa(c,u),m=fa(c,h),y=l*l*Math.PI;return r=H(r)[1],i=H(i)[1],a=H(a)[1],ha(t,s,((n,o,l,s)=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("width",l).attr("height",s).attr("fill","color"===u?t=>p.scale(t):f).attr("fill-opacity",r).attr("stroke","color"===h?t=>m.scale(t):d).attr("stroke-opacity",i).attr("stroke-width",a).append("path").attr("d",(n=>{const r=e.pathRound();return t.scale(n).draw(r,y),r}))))}],["color",ma],["opacity",function({type:t,interpolate:n,...r},{legend:o=!0,color:i=e.rgb(0,0,0),...a}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===o&&(o="ramp");if("ramp"!==`${o}`.toLowerCase())throw new Error(`${o} opacity legends are not supported`);return ma({type:t,...r,interpolate:ya(i)},{legend:o,...a})}]]);function pa({className:t,...e},{label:n,ticks:r,tickFormat:o}={},i){return function(t={},...e){let n=t;for(const r of e)for(const e in r)if(void 0===n[e]){const o=r[e];n===t?n={...n,[e]:o}:n[e]=o}return n}(i,{className:t,...e},{label:n,ticks:r,tickFormat:o})}function ma(t,{legend:n=!0,...r}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,{opacity:e,...n}={}){if(!yr(t)&&!gr(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return ha(t,n,((t,n,r,o)=>t.append("svg").attr("width",r).attr("height",o).attr("fill",n.scale).attr("fill-opacity",H(e)[1]).append("rect").attr("width","100%").attr("height","100%")))}(t,r);case"ramp":return function(t,n){let{label:r=t.label,tickSize:o=6,width:i=240,height:a=44+o,marginTop:l=18,marginRight:s=0,marginBottom:c=16+o,marginLeft:u=0,style:f,ticks:h=(i-u-s)/64,tickFormat:d,fontVariant:p=$o(t),round:m=!0,opacity:y,className:g}=n;const v=Qe(n);g=Xr(g),y=H(y)[1],null===d&&(d=()=>null);const x=Je("svg",v).attr("class",`${g}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",a).attr("viewBox",`0 0 ${i} ${a}`).call((t=>t.append("style").text(`.${g}-ramp {\n  display: block;\n  background: white;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n  overflow: visible;\n}\n.${g}-ramp text {\n  white-space: pre;\n}`))).call(Ur,f);let w,b=t=>t.selectAll(".tick line").attr("y1",l+c-a);const k=m?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:$,domain:M,range:L,interpolate:A,scale:S,pivot:z}=t;if(A){const t=void 0===L?A:e.piecewise(1===A.length?Dn(A):A,L);w=k(S.copy(),e.quantize(e.interpolateNumber(u,i-s),Math.min(M.length+(void 0!==z),void 0===L?1/0:L.length)));const n=256,r=v.document.createElement("canvas");r.width=n,r.height=1;const o=r.getContext("2d");for(let e=0,r=n-1;e<n;++e)o.fillStyle=t(e/r),o.fillRect(e,0,1,1);x.append("image").attr("opacity",y).attr("x",u).attr("y",l).attr("width",i-u-s).attr("height",a-l-c).attr("preserveAspectRatio","none").attr("xlink:href",r.toDataURL())}else if("threshold"===$){const t=M,n=void 0===d?t=>t:"string"==typeof d?e.format(d):d;w=k(e.scaleLinear().domain([-1,L.length-1]),[u,i-s]),x.append("g").attr("fill-opacity",y).selectAll().data(L).enter().append("rect").attr("x",((t,e)=>w(e-1))).attr("y",l).attr("width",((t,e)=>w(e)-w(e-1))).attr("height",a-l-c).attr("fill",(t=>t)),h=K(t,((t,e)=>e)),d=e=>n(t[e],e)}else w=k(e.scaleBand().domain(M),[u,i-s]),x.append("g").attr("fill-opacity",y).selectAll().data(M).enter().append("rect").attr("x",w).attr("y",l).attr("width",Math.max(0,w.bandwidth()-1)).attr("height",a-l-c).attr("fill",S),b=()=>{};return x.append("g").attr("transform",`translate(0,${a-c})`).call(e.axisBottom(w).ticks(Array.isArray(h)?null:h,"string"==typeof d?d:void 0).tickFormat("function"==typeof d?d:void 0).tickSize(o).tickValues(Array.isArray(h)?h:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Yr(p,"normal")).call(b).call((t=>t.select(".domain").remove())),void 0!==r&&x.append("text").attr("x",u).attr("y",l-6).attr("fill","currentColor").attr("font-weight","bold").text(r),x.node()}(t,r);default:throw new Error(`unknown legend type: ${n}`)}}function ya(t){const{r:n,g:r,b:o}=e.rgb(t)||e.rgb(0,0,0);return t=>`rgba(${n},${r},${o},${t})`}const ga={ariaLabel:"frame",fill:"none",stroke:"currentColor"},va={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square"};class xa extends uo{constructor(t={}){const{anchor:e=null,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n,rx:l,ry:s}=t;super(O,void 0,t,null==e?ga:va),this.anchor=Z(e,"anchor",["top","right","bottom","left"]),this.insetTop=W(r),this.insetRight=W(o),this.insetBottom=W(i),this.insetLeft=W(a),this.rx=W(l),this.ry=W(s)}render(t,e,n,r,o){const{marginTop:i,marginRight:a,marginBottom:l,marginLeft:s,width:c,height:u}=r,{anchor:f,insetTop:h,insetRight:d,insetBottom:p,insetLeft:m,rx:y,ry:g}=this,v=s+m,x=c-a-d,w=i+h,b=u-l-p;return Je(f?"svg:line":"svg:rect",o).datum(0).call(Wr,this,r,o).call(jr,this).call(Br,this,n).call(qr,this,{}).call("left"===f?t=>t.attr("x1",v).attr("x2",v).attr("y1",w).attr("y2",b):"right"===f?t=>t.attr("x1",x).attr("x2",x).attr("y1",w).attr("y2",b):"top"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",w).attr("y2",w):"bottom"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",b).attr("y2",b):t=>t.attr("x",v).attr("y",w).attr("width",x-v).attr("height",b-w).attr("rx",y).attr("ry",g)).node()}}function wa(t){return new xa(t)}const ba={ariaLabel:"tip",fill:"white",stroke:"currentColor"},ka=new Set(["geometry","href","src","ariaLabel"]);class $a extends uo{constructor(t,e={}){e.tip&&(e={...e,tip:!1}),void 0===e.title&&St(t)&&zt(t)&&(e={...e,title:B});const{x:n,y:r,x1:o,x2:i,y1:a,y2:l,anchor:s,monospace:c,fontFamily:u=(c?"ui-monospace, monospace":void 0),fontSize:f,fontStyle:h,fontVariant:d,fontWeight:p,lineHeight:m=1,lineWidth:y=20,frameAnchor:g,textAnchor:v="start",textOverflow:x,textPadding:w=8,title:b,pointerSize:k=12,pathFilter:$="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=e;super(t,{x:{value:null!=o&&null!=i?null:n,scale:"x",optional:!0},y:{value:null!=a&&null!=l?null:r,scale:"y",optional:!0},x1:{value:o,scale:"x",optional:null==i},y1:{value:a,scale:"y",optional:null==l},x2:{value:i,scale:"x",optional:null==o},y2:{value:l,scale:"y",optional:null==a},title:{value:b,optional:!0}},e,ba),this.anchor=jt(s,"anchor"),this.previousAnchor=this.anchor??"top-left",this.frameAnchor=Ft(g),this.textAnchor=Yr(v,"middle"),this.textPadding=+w,this.pointerSize=+k,this.pathFilter=I($),this.lineHeight=+m,this.lineWidth=+y,this.textOverflow=ri(x),this.monospace=!!c,this.fontFamily=I(u),this.fontSize=W(f),this.fontStyle=I(h),this.fontVariant=I(d),this.fontWeight=I(p);for(const t in ba)t in this.channels&&(this[t]=ba[t]);this.splitLines=pi(this),this.clipLine=mi(this)}render(t,r,o,i,a){const l=this,{x:s,y:c,fx:u,fy:f}=r,{ownerSVGElement:h,document:d}=a,{anchor:p,monospace:m,lineHeight:y,lineWidth:g}=this,{textPadding:v,pointerSize:x,pathFilter:w}=this,{marginTop:b,marginLeft:k}=i,$=function({channels:t}){const e={};for(const n in t){if(ka.has(n))continue;const r=Ze(t,n);r&&(e[n]=r)}return e}(o),{x1:M,y1:L,x2:A,y2:S,x:z=M??A,y:E=L??S}=o,R=u?u(t.fx)-k:0,O=f?f(t.fy)-b:0,[C,T]=Vr(this,i),B=bo(o,C),N=ko(o,T),P=m?di:hi,I=P(yi),W=u&&ra(u),j=f&&ra(f);const F=Je("svg:g",a).call(Wr,this,i,a).call(si,this).call(qr,this,{x:z&&s,y:E&&c}).call((i=>i.selectAll().data(t).enter().append("g").attr("transform",(t=>`translate(${Math.round(B(t))},${Math.round(N(t))})`)).call(jr,this).call((t=>t.append("path").attr("filter",w))).call((i=>i.append("text").each((function(i){const a=e.select(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const s=new Set;for(const e of function*(e,i){if("title"in e){const t=e.title.value[i];for(const e of l.splitLines(Sr(t)))yield{name:"",value:l.clipLine(e)}}else{for(const t in e){if("x1"===t&&"x2"in e)continue;if("y1"===t&&"y2"in e)continue;const a=e[t],l=a.value[i];if(n(l)||null!=a.scale)if("x2"===t&&"x1"in e)yield{name:Aa(r,a,"x"),value:La(e.x1,a,i)};else if("y2"===t&&"y1"in e)yield{name:Aa(r,a,"y"),value:La(e.y1,a,i)};else{const e=a.scale,n={name:Aa(r,a,t),value:Sr(l)};"color"!==e&&"opacity"!==e||(n[e]=o[t][i]),yield n}}null!=t.fi&&u&&(yield{name:String(u.label??"fx"),value:W(t.fx)}),null!=t.fi&&f&&(yield{name:String(f.label??"fy"),value:j(t.fy)})}}($,i)){const t=e.name;t&&s.has(t)||(s.add(t),D(a,e))}}))))));function D(t,{name:e,value:n,color:r,opacity:o}){const i=null!=r||null!=o;let a,l=100*g;const[s]=gi(e,l,P,I);if(s>=0)e=e.slice(0,s).trimEnd()+yi,a=n.trim(),n="";else{(e||!n&&!i)&&(n=" "+n);const[t]=gi(n,l-P(e),P,I);t>=0&&(a=(n=n.slice(0,t).trimEnd()+yi).trim())}const c=t.append("tspan").attr("x",0).attr("dy",`${y}em`).text("â€‹");e&&c.append("tspan").attr("font-weight","bold").text(e),n&&c.append((()=>d.createTextNode(n))),i&&c.append("tspan").text(" â– ").attr("fill",r).attr("fill-opacity",o).style("user-select","none"),a&&c.append("title").text(a)}function q(){const{width:t,height:e}=i.facet??i;F.selectChildren().each((function(n){let{x:r,width:o,height:i}=this.getBBox();o=Math.round(o),i=Math.round(i);let a=p;if(void 0===a){a=l.previousAnchor;const r=B(n)+R,s=N(n)+O,c=r+o+2*v<t,u=r-o-2*v>0,f=s+i+x+2*v+7<e,h=s-i-x-2*v>0,d=(/-left$/.test(a)?c||!u:c&&!u)?"left":"right",p=(/^top-/.test(a)?f||!h:f&&!h)?"top":"bottom";a=l.previousAnchor=`${p}-${d}`}const s=this.firstChild,c=this.lastChild;if(s.setAttribute("d",function(t,e,n,r,o){const i=r+2*n,a=o+2*n;switch(t){case"middle":return`M${-i/2},${-a/2}h${i}v${a}h${-i}z`;case"top-left":return`M0,0l${e},${e}h${i-e}v${a}h${-i}z`;case"top":return`M0,0l${e/2},${e/2}h${(i-e)/2}v${a}h${-i}v${-a}h${(i-e)/2}z`;case"top-right":return`M0,0l${-e},${e}h${e-i}v${a}h${i}z`;case"right":return`M0,0l${-e/2},${-e/2}v${e/2-a/2}h${-i}v${a}h${i}v${e/2-a/2}z`;case"bottom-left":return`M0,0l${e},${-e}h${i-e}v${-a}h${-i}z`;case"bottom":return`M0,0l${e/2},${-e/2}h${(i-e)/2}v${-a}h${-i}v${a}h${(i-e)/2}z`;case"bottom-right":return`M0,0l${-e},${-e}h${e-i}v${-a}h${i}z`;case"left":return`M0,0l${e/2},${-e/2}v${e/2-a/2}h${i}v${a}h${-i}v${e/2-a/2}z`}}(a,x,v,o,i)),r)for(const t of c.childNodes)t.setAttribute("x",-r);c.setAttribute("y",+function(t,e,n){return/^top(?:-|$)/.test(t)?.94-n:-.29-e*n}(a,c.childNodes.length,y).toFixed(6)+"em"),c.setAttribute("transform",`translate(${function(t,e,n,r,o){switch(t){case"middle":return[-r/2,o/2];case"top-left":return[n,e+n];case"top":return[-r/2,e/2+n];case"top-right":return[-r-n,e+n];case"right":return[-e/2-r-n,o/2];case"bottom-left":return[n,-e-n];case"bottom":return[-r/2,-e/2-n];case"bottom-right":return[-r-n,-e-n];case"left":return[n+e/2,o/2]}}(a,x,v,o,i)})`)}))}return h.isConnected?Promise.resolve().then(q):"undefined"!=typeof requestAnimationFrame&&requestAnimationFrame(q),F.node()}}function Ma(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=ut(e,n)),new $a(t,{...r,x:e,y:n})}function La(t,e,n){return e.hint?.length?`${Sr(e.value[n]-t.value[n])}`:`${Sr(t.value[n])}â€“${Sr(e.value[n])}`}function Aa(t,e,n){return String(t[e.scale]?.label??e?.label??n)}function Sa(t={}){const{facet:n,style:r,caption:o,ariaLabel:i,ariaDescription:a}=t,l=Xr(t.className),s=void 0===t.marks?[]:za(t.marks);s.push(...function(t){const e=[];for(const n of t){const t=n.tip;if(t){const r=("x"===t?xo:"y"===t?wo:vo)(Ia(n));r.title=null,e.push(Ma(n.data,r))}}return e}(s));const c=function(t,e){if(null==t)return;const{x:n,y:r}=t;if(null==n&&null==r)return;const o=J(t.data);if(null==o)throw new Error("missing facet data");const i={};null!=n&&(i.fx=je(o,{value:n,scale:"fx"}));null!=r&&(i.fy=je(o,{value:r,scale:"fy"}));Oa(i,e);const a=Qr(o,i);return{channels:i,groups:a,data:t.data}}(n,t),u=new Map;for(const e of s){const n=Pa(e,c,t);n&&u.set(e,n)}const f=new Map;c&&Ba(f,[c],t),Ba(f,u,t);const h=za(function(t,e,n){let{projection:r,x:o={},y:i={},fx:a={},fy:l={},axis:s,grid:c,facet:u={},facet:{axis:f=s,grid:h}=u,x:{axis:d=s,grid:p=(null===d?null:c)}=o,y:{axis:m=s,grid:y=(null===m?null:c)}=i,fx:{axis:g=f,grid:v=(null===g?null:h)}=a,fy:{axis:x=f,grid:w=(null===x?null:h)}=l}=n;(r||!at(o)&&!qa("x",t))&&(d=p=null);(r||!at(i)&&!qa("y",t))&&(m=y=null);e.has("fx")||(g=v=null);e.has("fy")||(x=w=null);void 0===d&&(d=!Da(t,"x"));void 0===m&&(m=!Da(t,"y"));void 0===g&&(g=!Da(t,"fx"));void 0===x&&(x=!Da(t,"fy"));!0===d&&(d="bottom");!0===m&&(m="left");!0===g&&(g="top"===d||null===d?"bottom":"top");!0===x&&(x="right"===m||null===m?"left":"right");const b=[];return ja(b,w,Vi,l),Wa(b,x,qi,"right","left",u,l),ja(b,v,Zi,a),Wa(b,g,_i,"top","bottom",u,a),ja(b,y,Ui,i),Wa(b,m,Di,"left","right",n,i),ja(b,p,Hi,o),Wa(b,d,Yi,"bottom","top",n,o),b}(s,f,t));for(const e of h){const n=Pa(e,c,t);n&&u.set(e,n)}s.unshift(...h);let d=function(t,n){const{fx:r,fy:o}=er(t,n),i=r?.scale.domain(),a=o?.scale.domain();return i&&a?e.cross(i,a).map((([t,e],n)=>({x:t,y:e,i:n}))):i?i.map(((t,e)=>({x:t,i:e}))):a?a.map(((t,e)=>({y:t,i:e}))):void 0}(f,t);if(void 0!==d){const t=c?co(d,c):void 0;for(const e of s){if(null===e.facet||"super"===e.facet)continue;const n=u.get(e);void 0!==n&&(n.facetsIndex=null!=e.fx||null!=e.fy?co(d,n):t)}const e=new Set;for(const{facetsIndex:t}of u.values())t?.forEach(((t,n)=>{t?.length>0&&e.add(n)}));d.forEach(0<e.size&&e.size<d.length?(t,n)=>t.empty=!e.has(n):t=>t.empty=!1);for(const t of s)if("exclude"===t.facet){const e=u.get(t);void 0!==e&&(e.facetsIndex=Jr(e.facetsIndex))}}for(const e of Zt.keys())at(t[e])&&"fx"!==e&&"fy"!==e&&f.set(e,[]);const p=new Map;for(const e of s){if(p.has(e))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:n,channels:r}=u.get(e)??{},{data:o,facets:i,channels:a}=e.initialize(n,r,t);Oa(a,t),p.set(e,{data:o,facets:i,channels:a})}const m=er(Ba(f,p,t),t),y=nr(m),g=function(t,e,n={}){let r=.5-zr,o=.5+zr,i=.5+zr,a=.5-zr;for(const{marginTop:t,marginRight:n,marginBottom:l,marginLeft:s}of e)t>r&&(r=t),n>o&&(o=n),l>i&&(i=l),s>a&&(a=s);let{margin:l,marginTop:s=(void 0!==l?l:r),marginRight:c=(void 0!==l?l:o),marginBottom:u=(void 0!==l?l:i),marginLeft:f=(void 0!==l?l:a)}=n;s=+s,c=+c,u=+u,f=+f;let{width:h=640,height:d=Hr(t,n,{width:h,marginTopDefault:r,marginRightDefault:o,marginBottomDefault:i,marginLeftDefault:a})+Math.max(0,s-r+u-i)}=n;h=+h,d=+d;const p={width:h,height:d,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f};if(t.fx||t.fy){let{margin:t,marginTop:e=(void 0!==t?t:s),marginRight:r=(void 0!==t?t:c),marginBottom:o=(void 0!==t?t:u),marginLeft:i=(void 0!==t?t:f)}=n.facet??{};e=+e,r=+r,o=+o,i=+i,p.facet={marginTop:e,marginRight:r,marginBottom:o,marginLeft:i}}return p}(m,s,t);!function(t,e){const{x:n,y:r,fx:o,fy:i}=t,a=o||i?or(e):e;o&&ar(o,a),i&&lr(i,a);const l=o||i?ir(t,e):e;n&&ar(n,l),r&&lr(r,l)}(m,g);const{fx:v,fy:x}=y,w=v||x?ir(m,g):g,b=v||x?function({fx:t,fy:e},n){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=or(n),c=t&&Ya(t),u=e&&Ya(e);return{marginTop:e?u[0]:r,marginRight:t?l-c[1]:o,marginBottom:e?s-u[1]:i,marginLeft:t?c[0]:a,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:l,height:s}}(y,g):g,k=Qe(t),$=k.document,M=e.creator("svg").call($.documentElement);let L=M;k.ownerSVGElement=M,k.className=l,k.projection=on(t,w),k.filterFacets=(t,e)=>co(d,{channels:e,groups:Qr(t,e)}),k.getMarkState=t=>{const e=p.get(t),n=u.get(t);return{...e,channels:{...e.channels,...n?.channels}}},k.dispatchValue=t=>{L.value!==t&&(L.value=t,L.dispatchEvent(new Event("input",{bubbles:!0})))};const A=new Set;for(const[e,n]of p)if(null!=e.initializer){const r="super"===e.facet?b:w,o=e.initializer(n.data,n.facets,n.channels,y,r,k);if(void 0!==o.data&&(n.data=o.data),void 0!==o.facets&&(n.facets=o.facets),void 0!==o.channels){const{fx:r,fy:i,...a}=o.channels;Ta(a),Object.assign(n.channels,a);for(const e of Object.values(a)){const{scale:n}=e;null!=n&&Zt.get(n)!==Yt&&(Ca(e,t),A.add(n))}null==r&&null==i||u.set(e,!0)}}if(A.size){const e=new Map;Ba(e,p,t,(t=>A.has(t))),Ba(f,p,t,(t=>A.has(t)));const n=function(t,e){for(const n in t){const r=t[n],o=e[n];void 0===r.label&&o&&(r.label=o.label)}return t}(er(e,t),m),r=nr(n);Object.assign(m,n),Object.assign(y,r)}let S,z;void 0!==d&&(S={x:v?.domain(),y:x?.domain()},d=function(t,{x:e,y:n}){return e&&=eo(e),n&&=eo(n),t.filter(e&&n?t=>e.has(t.x)&&n.has(t.y):e?t=>e.has(t.x):t=>n.has(t.y)).sort(e&&n?(t,r)=>e.get(t.x)-e.get(r.x)||n.get(t.y)-n.get(r.y):e?(t,n)=>e.get(t.x)-e.get(n.x):(t,e)=>n.get(t.y)-n.get(e.y))}(d,S),z=function(t,e,{marginTop:n,marginLeft:r}){return t&&e?({x:o,y:i})=>`translate(${t(o)-r},${e(i)-n})`:t?({x:e})=>`translate(${t(e)-r},0)`:({y:t})=>`translate(0,${e(t)-n})`}(v,x,g));for(const[t,e]of p)e.values=t.scale(e.channels,y,k);const{width:E,height:R}=g;e.select(M).attr("class",l).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",E).attr("height",R).attr("viewBox",`0 0 ${E} ${R}`).attr("aria-label",i).attr("aria-description",a).call((t=>t.append("style").text(`.${l} {\n  display: block;\n  background: white;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n}\n.${l} text,\n.${l} tspan {\n  white-space: pre;\n}`))).call(Ur,r);for(const t of s){const{channels:n,values:r,facets:o}=p.get(t);if(void 0===d||"super"===t.facet){let e=null;if(o&&(e=o[0],e=t.filter(e,n,r),0===e.length))continue;const i=t.render(e,y,r,b,k);if(null==i)continue;M.appendChild(i)}else{let i;for(const a of d){if(!(t.facetAnchor?.(d,S,a)??!a.empty))continue;let l=null;if(o){const e=u.has(t);if(l=o[e?a.i:0],l=t.filter(l,n,r),0===l.length)continue;e||l!==o[0]||(l=mt(l)),l.fx=a.x,l.fy=a.y,l.fi=a.i}const s=t.render(l,y,r,w,k);if(null!=s){(i??=e.select(M).append("g")).append((()=>s)).datum(a);for(const t of["aria-label","aria-description","aria-hidden","transform"])s.hasAttribute(t)&&(i.attr(t,s.getAttribute(t)),s.removeAttribute(t))}}i?.selectChildren().attr("transform",z)}}const O=function(t,e,n){const r=[];for(const[o,i]of da){const a=n[o];if(a?.legend&&o in t){const n=i(t[o],pa(e,t[o],a),(e=>t[e]));null!=n&&r.push(n)}}return r}(m,k,t);if(null!=o||O.length>0){L=$.createElement("figure"),L.style.maxWidth="initial";for(const t of O)L.appendChild(t);if(L.appendChild(M),null!=o){const t=$.createElement("figcaption");t.appendChild(o?.ownerDocument?o:$.createTextNode(o)),L.appendChild(t)}}L.scale=function(t){return e=>{if(!Zt.has(e=`${e}`))throw new Error(`unknown scale: ${e}`);return e in t?br(t[e]):void 0}}(m),L.legend=function(t,e,n={}){return(r,o)=>{if(!da.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return da.get(r)(t[r],pa(e,n[r],o),(e=>t[e]))}}(m,k,t);const C=function(){const t=Ke;return Ke=0,t}();return C>0&&e.select(M).append("text").attr("x",E).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("âš ï¸").append("title").text(`${C.toLocaleString("en-US")} warning${1===C?"":"s"}. Please check the console.`),L}function za(t){return t.flat(1/0).filter((t=>null!=t)).map(Ea)}function Ea(t){return"function"==typeof t.render?t:new Ra(t)}uo.prototype.plot=function({marks:t=[],...e}={}){return Sa({...e,marks:[...t,this]})};class Ra extends uo{constructor(t){if("function"!=typeof t)throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function Oa(t,e){for(const n in t)Ca(t[n],e);return t}function Ca(t,e){const{scale:n,transform:r=!0}=t;if(null==n||!r)return;const{type:o,percent:i,interval:a,transform:l=(i?t=>100*t:$t(a,o))}=e[n]??{};null!=l&&(t.value=K(t.value,l),t.transform=!1)}function Ta(t){for(const e in t)qe(e,t[e])}function Ba(t,e,n,r=P){for(const{channels:o}of e.values())for(const e in o){const i=o[e],{scale:a}=i;if(null!=a&&r(a))if("projection"===a){if(!hn(n)){const e=void 0===n.x?.domain,r=void 0===n.y?.domain;if(e||r){const[n,o]=pn(i);e&&Na(t,"x",n),r&&Na(t,"y",o)}}}else Na(t,a,i)}return t}function Na(t,e,n){const r=t.get(e);void 0!==r?r.push(n):t.set(e,[n])}function Pa(t,e,n){if(null===t.facet||"super"===t.facet)return;const{fx:r,fy:o}=t;if(null!=r||null!=o){const e=J(t.data??r??o);if(void 0===e)throw new Error(`missing facet data in ${t.ariaLabel}`);if(null===e)return;const i={};return null!=r&&(i.fx=je(e,{value:r,scale:"fx"})),null!=o&&(i.fy=je(e,{value:o,scale:"fy"})),Oa(i,n),{channels:i,groups:Qr(e,i)}}if(void 0===e)return;const{channels:i,groups:a,data:l}=e;if("auto"!==t.facet||t.data===l)return{channels:i,groups:a};l.length>0&&(a.size>1||1===a.size&&i.fx&&i.fy&&[...a][0][1].size>1)&&J(t.data)?.length===l.length&&tn(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isnâ€™t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function Ia(t,e={}){return ie({...e,x:null,y:null},((e,n,r,o,i,a)=>a.getMarkState(t)))}function Wa(t,e,n,r,o,i,a){if(!e)return;const l=/^\s*both\s*$/i.test(e);a=function(t,e,{line:n=e.line,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h=e.label,labelAnchor:d,labelArrow:p=e.labelArrow,labelOffset:m}){return{anchor:t,line:n,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h,labelAnchor:d,labelArrow:p,labelOffset:m}}(l?r:e,i,a);const{line:s}=a;n!==Di&&n!==Yi||!s||Wt(s)||t.push(wa(function(t){const{anchor:e,line:n}=t;return{anchor:e,facetAnchor:e+"-empty",stroke:!0===n?void 0:n}}(a))),t.push(n(a)),l&&t.push(n({...a,anchor:o,label:null}))}function ja(t,e,n,r){e&&!Wt(e)&&t.push(n(function(t,{stroke:e=(Nt(t)?t:void 0),ticks:n=(Fa(t)?t:void 0),tickSpacing:r,ariaLabel:o,ariaDescription:i}){return{stroke:e,ticks:n,tickSpacing:r,ariaLabel:o,ariaDescription:i}}(e,r)))}function Fa(t){switch(typeof t){case"number":return!0;case"string":return!Nt(t)}return St(t)||"function"==typeof t?.range}function Da(t,e){const n=`${e}-axis `;return t.some((t=>t.ariaLabel?.startsWith(n)))}function qa(t,e){for(const n of e)for(const e in n.channels){const{scale:r}=n.channels[e];if(r===t||"projection"===r)return!0}return!1}function Ya(t){const e=t.domain();let n=t(e[0]),r=t(e[e.length-1]);return r<n&&([n,r]=[r,n]),[n,r+t.bandwidth()]}const _a=new Map([["basis",e.curveBasis],["basis-closed",e.curveBasisClosed],["basis-open",e.curveBasisOpen],["bundle",e.curveBundle],["bump-x",e.curveBumpX],["bump-y",e.curveBumpY],["cardinal",e.curveCardinal],["cardinal-closed",e.curveCardinalClosed],["cardinal-open",e.curveCardinalOpen],["catmull-rom",e.curveCatmullRom],["catmull-rom-closed",e.curveCatmullRomClosed],["catmull-rom-open",e.curveCatmullRomOpen],["linear",e.curveLinear],["linear-closed",e.curveLinearClosed],["monotone-x",e.curveMonotoneX],["monotone-y",e.curveMonotoneY],["natural",e.curveNatural],["step",e.curveStep],["step-after",e.curveStepAfter],["step-before",e.curveStepBefore]]);function Ga(t=e.curveLinear,n){if("function"==typeof t)return t;const r=_a.get(`${t}`.toLowerCase());if(!r)throw new Error(`unknown curve: ${t}`);if(void 0!==n){if("beta"in r)return r.beta(n);if("tension"in r)return r.tension(n);if("alpha"in r)return r.alpha(n)}return r}function Xa(t=Ua,e){return"function"!=typeof t&&"auto"===`${t}`.toLowerCase()?Ua:Ga(t,e)}function Ua(t){return e.curveLinear(t)}function Va(t={y:"count"},e={}){[t,e]=el(t,e);const{x:n,y:r}=e;return tl(nl(n,e,B),null,null,r,t,No(e))}function Ha(t={x:"count"},e={}){[t,e]=el(t,e);const{x:n,y:r}=e;return tl(null,nl(r,e,B),n,null,t,Po(e))}function Za(t={fill:"count"},e={}){[t,e]=el(t,e);const{x:n,y:r}=function(t){let{x:e,y:n}=t;return e=nl(e,t),n=nl(n,t),[e.value,n.value]=ut(e.value,n.value),{x:e,y:n}}(e);return tl(n,r,null,null,t,No(Po(e)))}function Qa(t,e,n={}){return null==n?.interval?n:t({[e]:void 0===n?.reduce?Ce:n.reduce,filter:null},n)}function Ja(t={}){return Qa(Va,"y",mo(t,"x"))}function Ka(t={}){return Qa(Ha,"x",mo(t,"y"))}function tl(t,e,n,r,{data:o=Oe,filter:i=Ne,sort:a,reverse:l,...s}={},c={}){t=rl(t),e=rl(e),s=function(t,e){return be(t,e,il)}(s,c),o=ll(o,B),a=null==a?void 0:il("sort",a,c),i=null==i?void 0:al("filter",i,c),null!=n&&we(s,"x","x1","x2")&&(n=null),null!=r&&we(s,"y","y1","y2")&&(r=null);const[u,f]=xt(t),[h,d]=xt(t),[p,m]=xt(e),[y,g]=xt(e),[v,x]=null!=n?[n,"x"]:null!=r?[r,"y"]:[],[w,b]=xt(v),{x:k,y:$,z:M,fill:L,stroke:A,x1:S,x2:E,y1:R,y2:O,domain:C,cumulative:T,thresholds:N,interval:P,...I}=c,[W,j]=xt(M),[F]=V(L),[D]=V(A),[q,Y]=xt(F),[_,G]=xt(D);return{..."z"in c&&{z:W||M},..."fill"in c&&{fill:q||L},..."stroke"in c&&{stroke:_||A},...oe(I,((n,r,c)=>{const u=kt(z(n,v),c?.[x]),h=z(n,M),p=z(n,F),y=z(n,D),w=Se(s,{z:h,fill:p,stroke:y}),k=[],$=[],L=u&&b([]),A=h&&j([]),S=p&&Y([]),E=y&&G([]),R=t&&f([]),O=t&&d([]),C=e&&m([]),T=e&&g([]),B=(N=t?.(n),P=e?.(n),N&&P?function*(t){const e=N.bin(t);for(const[t,[n,r]]of N.entries()){const o=P.bin(e[t]);for(const[t,[e,i]]of P.entries())yield[o[t],{x1:n,y1:e,x2:r,y2:i}]}}:N?function*(t){const e=N.bin(t);for(const[t,[n,r]]of N.entries())yield[e[t],{x1:n,x2:r}]}:function*(t){const e=P.bin(t);for(const[t,[n,r]]of P.entries())yield[e[t],{y1:n,y2:r}]});var N,P;let I=0;for(const t of s)t.initialize(n);a&&a.initialize(n),i&&i.initialize(n);for(const t of r){const e=[];for(const e of s)e.scope("facet",t);a&&a.scope("facet",t),i&&i.scope("facet",t);for(const[r,l]of Me(t,w))for(const[t,c]of Me(l,u))for(const[l,f]of B(c))if(!i||i.reduce(l,f)){e.push(I++),$.push(o.reduceIndex(l,n,f)),u&&L.push(t),h&&A.push(w===h?r:h[l[0]]),p&&S.push(w===p?r:p[l[0]]),y&&E.push(w===y?r:y[l[0]]),R&&(R.push(f.x1),O.push(f.x2)),C&&(C.push(f.y1),T.push(f.y2));for(const t of s)t.reduce(l,f);a&&a.reduce(l)}k.push(e)}return ze(k,a,l),{data:$,facets:k}})),...!we(s,"x")&&(u?{x1:u,x2:h,x:bt(u,h)}:{x:k,x1:S,x2:E}),...!we(s,"y")&&(p?{y1:p,y2:y,y:bt(p,y)}:{y:$,y1:R,y2:O}),...w&&{[x]:w},...Object.fromEntries(s.map((({name:t,output:e})=>[t,e])))}}function el({cumulative:t,domain:e,thresholds:n,interval:r,...o},i){return[o,{cumulative:t,domain:e,thresholds:n,interval:r,...i}]}function nl(t,{cumulative:e,domain:n,thresholds:r,interval:o},i){return void 0===(t={...At(t)}).domain&&(t.domain=n),void 0===t.cumulative&&(t.cumulative=e),void 0===t.thresholds&&(t.thresholds=r),void 0===t.interval&&(t.interval=o),void 0===t.value&&(t.value=i),t.thresholds=ol(t.thresholds,t.interval),t}function rl(t){if(null==t)return;const{value:n,cumulative:r,domain:o=e.extent,thresholds:i}=t,a=t=>{let a,l=z(t,n);if(Rt(l)||(function(t){return ul(t)&&"function"==typeof t&&t()instanceof Date}(s=i)||St(s)&&Rt(s))){l=K(l,U,Float64Array);let[t,n]="function"==typeof o?o(l):o,r="function"!=typeof i||ul(i)?i:i(l,t,n);"number"==typeof r&&(r=e.utcTickInterval(t,n,r)),ul(r)&&(o===e.extent&&(t=r.floor(t),n=r.offset(r.floor(n))),r=r.range(t,r.offset(n))),a=r}else{l=_(l);let[t,n]="function"==typeof o?o(l):o,r="function"!=typeof i||ul(i)?i:i(l,t,n);if("number"==typeof r)if(o===e.extent){let o=e.tickIncrement(t,n,r);if(isFinite(o))if(o>0){let e=Math.round(t/o),i=Math.round(n/o);e*o<=t||--e,i*o>n||++i;let a=i-e+1;r=new Float64Array(a);for(let t=0;t<a;++t)r[t]=(e+t)*o}else if(o<0){o=-o;let e=Math.round(t*o),i=Math.round(n*o);e/o<=t||--e,i/o>n||++i;let a=i-e+1;r=new Float64Array(a);for(let t=0;t<a;++t)r[t]=(e+t)/o}else r=[t];else r=[t]}else r=e.ticks(t,n,r);else ul(r)&&(o===e.extent&&(t=r.floor(t),n=r.offset(r.floor(n))),r=r.range(t,r.offset(n)));a=r}var s;const c=[];if(1===a.length)c.push([a[0],a[0]]);else for(let t=1;t<a.length;++t)c.push([a[t-1],a[t]]);return c.bin=(r<0?dl:r>0?hl:fl)(c,a,l),c};return a.label=wt(n),a}function ol(t,n,r=cl){if(void 0===t)return void 0===n?r:Lt(n);if("string"==typeof t){switch(t.toLowerCase()){case"freedman-diaconis":return e.thresholdFreedmanDiaconis;case"scott":return e.thresholdScott;case"sturges":return e.thresholdSturges;case"auto":return cl}return $(t)}return t}function il(t,e,n){return ke(t,e,n,al)}function al(t,e,n){return $e(t,e,n,ll)}function ll(t,e){return Le(t,e,sl)}function sl(t){switch(`${t}`.toLowerCase()){case"x":return ml;case"x1":return gl;case"x2":return vl;case"y":return yl;case"y1":return xl;case"y2":return wl}throw new Error(`invalid bin reduce: ${t}`)}function cl(t,n,r){return Math.min(200,e.thresholdScott(t,n,r))}function ul(t){return"function"==typeof t?.range}function fl(t,n,r){return n=_(n),o=>{const i=t.map((()=>[]));for(const t of o)i[e.bisect(n,r[t])-1]?.push(t);return i}}function hl(t,e,n){const r=fl(t,e,n);return t=>{const e=r(t);for(let t=1,n=e.length;t<n;++t){const n=e[t-1],r=e[t];for(const t of n)r.push(t)}return e}}function dl(t,e,n){const r=fl(t,e,n);return t=>{const e=r(t);for(let t=e.length-2;t>=0;--t){const n=e[t+1],r=e[t];for(const t of n)r.push(t)}return e}}function pl(t,e){const n=(+t+ +e)/2;return t instanceof Date?new Date(n):n}const ml={reduceIndex:(t,e,{x1:n,x2:r})=>pl(n,r)},yl={reduceIndex:(t,e,{y1:n,y2:r})=>pl(n,r)},gl={reduceIndex:(t,e,{x1:n})=>n},vl={reduceIndex:(t,e,{x2:n})=>n},xl={reduceIndex:(t,e,{y1:n})=>n},wl={reduceIndex:(t,e,{y2:n})=>n};function bl(t={}){return et(t)?t:{...t,x:B}}function kl(t={}){return nt(t)?t:{...t,y:B}}function $l(t={},e={}){1===arguments.length&&([t,e]=Sl(t));const{y1:n,y:r=n,x:o,...i}=e,[a,l,s,c]=El(r,o,"y","x",t,i);return{...a,y1:n,y:l,x1:s,x2:c,x:bt(s,c)}}function Ml(t={},e={}){1===arguments.length&&([t,e]=Sl(t));const{x1:n,x:r=n,y:o,...i}=e,[a,l,s,c]=El(r,o,"x","y",t,i);return{...a,x1:n,x:l,y1:s,y2:c,y:bt(s,c)}}function Ll({x:t,x1:e,x2:n,...r}={}){return r=mo(r,"y"),void 0===e&&void 0===n?$l({x:t,...r}):([e,n]=ct(t,e,n),{...r,x1:e,x2:n})}function Al({y:t,y1:e,y2:n,...r}={}){return r=mo(r,"x"),void 0===e&&void 0===n?Ml({y:t,...r}):([e,n]=ct(t,e,n),{...r,y1:e,y2:n})}function Sl(t){const{offset:e,order:n,reverse:r,...o}=t;return[{offset:e,order:n,reverse:r},o]}const zl={length:!0};function El(t,n=N,i,a,{offset:l,order:s,reverse:c},u){const f=ft(u),[h,d]=xt(t),[p,m]=vt(n),[y,g]=vt(n);return p.hint=y.hint=zl,l=function(t){if(null==t)return;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return Ol;case"center":case"silhouette":return Cl;case"wiggle":return Tl}throw new Error(`unknown offset: ${t}`)}(l),s=function(t,n,i){if(void 0===t&&n===Tl)return Pl(r);if(null==t)return;if("string"==typeof t){const n=t.startsWith("-"),a=n?o:r;switch((n?t.slice(1):t).toLowerCase()){case"value":case i:return function(t){return(e,n,r)=>(e,n)=>t(r[e],r[n])}(a);case"z":return function(t){return(e,n,r,o)=>(e,n)=>t(o[e],o[n])}(a);case"sum":return function(t){return jl(t,((t,n,r,o)=>e.groupSort(ht(t),(t=>e.sum(t,(t=>r[t]))),(t=>o[t]))))}(a);case"appearance":return function(t){return jl(t,((t,n,r,o)=>e.groupSort(ht(t),(t=>n[e.greatest(t,(t=>r[t]))]),(t=>o[t]))))}(a);case"inside-out":return Pl(a)}return Il(C(t))}if("function"==typeof t)return(1===t.length?Il:Wl)(t);if(Array.isArray(t))return a=t,jl(r,(()=>a));var a;throw new Error(`invalid order: ${t}`)}(s,l,a),[oe(u,((r,o,a)=>{const u=null==t?void 0:d(kt(z(r,t),a?.[i])),h=z(r,n,Float64Array),p=z(r,f),y=s&&s(r,u,h,p),v=r.length,x=m(new Float64Array(v)),w=g(new Float64Array(v)),b=[];for(const t of o){const n=u?Array.from(e.group(t,(t=>u[t])).values()):[t];if(y)for(const t of n)t.sort(y);for(const t of n){let e=0,n=0;c&&t.reverse();for(const r of t){const t=h[r];t<0?e=w[r]=(x[r]=e)+t:t>0?n=w[r]=(x[r]=n)+t:w[r]=x[r]=n}}b.push(n)}return l&&l(b,x,w,p),{data:r,facets:o}})),h,p,y]}function Rl(t,e){let n=0,r=0;for(const o of t){const t=e[o];t<n&&(n=t),t>r&&(r=t)}return[n,r]}function Ol(t,e,n){for(const r of t)for(const t of r){const[r,o]=Rl(t,n);for(const i of t){const t=1/(o-r||1);e[i]=t*(e[i]-r),n[i]=t*(n[i]-r)}}}function Cl(t,e,n){for(const r of t){for(const t of r){const[r,o]=Rl(t,n);for(const i of t){const t=(o+r)/2;e[i]-=t,n[i]-=t}}Bl(r,e,n)}Nl(t,e,n)}function Tl(t,n,r,o){for(const i of t){const t=new e.InternMap;let a=0;for(const l of i){let i=-1;const s=l.map((t=>Math.abs(r[t]-n[t]))),c=l.map((e=>{i=o?o[e]:++i;const a=r[e]-n[e],l=t.has(i)?a-t.get(i):0;return t.set(i,a),l})),u=[0,...e.cumsum(c)];for(const t of l)n[t]+=a,r[t]+=a;const f=e.sum(s);f&&(a-=e.sum(s,((t,e)=>(c[e]/2+u[e])*t))/f)}Bl(i,n,r)}Nl(t,n,r)}function Bl(t,n,r){const o=e.min(t,(t=>e.min(t,(t=>n[t]))));for(const e of t)for(const t of e)n[t]-=o,r[t]-=o}function Nl(t,n,r){const o=t.length;if(1===o)return;const i=t.map((t=>t.flat())),a=i.map((t=>(e.min(t,(t=>n[t]))+e.max(t,(t=>r[t])))/2)),l=e.min(a);for(let t=0;t<o;t++){const e=l-a[t];for(const o of i[t])n[o]+=e,r[o]+=e}}function Pl(t){return jl(t,((t,n,r,o)=>{const i=ht(t),a=e.groupSort(i,(t=>n[e.greatest(t,(t=>r[t]))]),(t=>o[t])),l=e.rollup(i,(t=>e.sum(t,(t=>r[t]))),(t=>o[t])),s=[],c=[];let u=0;for(const t of a)u<0?(u+=l.get(t),s.push(t)):(u-=l.get(t),c.push(t));return c.reverse().concat(s)}))}function Il(t){return e=>{const n=z(e,t);return(t,e)=>r(n[t],n[e])}}function Wl(t){return e=>(n,r)=>t(e[n],e[r])}function jl(t,n){return(r,o,i,a)=>{if(!a)throw new Error("missing channel: z");const l=new e.InternMap(n(r,o,i,a).map(((t,e)=>[t,e])));return(e,n)=>t(l.get(a[e]),l.get(a[n]))}}const Fl={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Dl extends uo{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,z:a,curve:l,tension:s}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0},z:{value:ft(e),optional:!0}},e,Fl),this.z=a,this.curve=Ga(l,s)}filter(t){return t}render(t,n,r,o,i){const{x1:a,y1:l,x2:s=a,y2:c=l}=r;return Je("svg:g",i).call(Wr,this,o,i).call(qr,this,n,0,0).call((n=>n.selectAll().data(Ir(t,[a,l,s,c],this,r)).enter().append("path").call(jr,this).call(Nr,this,r).attr("d",e.area().curve(this.curve).defined((t=>t>=0)).x0((t=>a[t])).y0((t=>l[t])).x1((t=>s[t])).y1((t=>c[t]))))).node()}}function ql(t,e){const{y:n=T,...r}=Ka(e);return new Dl(t,Ll(bl({...r,y1:n,y2:void 0})))}function Yl(t,e){const{x:n=T,...r}=Ja(e);return new Dl(t,Al(kl({...r,x1:n,x2:void 0})))}const _l={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Gl extends uo{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,curve:a,tension:l}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,_l),this.curve=Xa(a,l),Lo(this,e)}project(t,e,n){this.curve!==Ua&&super.project(t,e,n)}render(t,n,r,o,i){const{x1:a,y1:l,x2:s=a,y2:c=l}=r,{curve:u}=this;return Je("svg:g",i).call(Wr,this,o,i).call(qr,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(jr,this).attr("d",u===Ua&&i.projection?function(t,n,r,o,i){const a=e.geoPath(t);return n=_(n),r=_(r),o=_(o),i=_(i),t=>a({type:"LineString",coordinates:[[n[t],r[t]],[o[t],i[t]]]})}(i.projection,a,l,s,c):t=>{const n=e.pathRound(),r=u(n);return r.lineStart(),r.point(a[t],l[t]),r.point(s[t],c[t]),r.lineEnd(),n}).call(Br,this,r).call(Co,this,r,i))).node()}}function Xl(t,{x:e,x1:n,x2:r,y:o,y1:i,y2:a,...l}={}){return[n,r]=Ul(e,n,r),[i,a]=Ul(o,i,a),new Gl(t,{...l,x1:n,x2:r,y1:i,y2:a})}function Ul(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[n]}else if(void 0===n)return[e]}else{if(void 0===e)return void 0===n?[t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const Vl={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class Hl extends uo{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,bend:a=0,headAngle:l=60,headLength:s=8,inset:c=0,insetStart:u=c,insetEnd:f=c}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,Vl),this.bend=!0===a?22.5:Math.max(-90,Math.min(90,a)),this.headAngle=+l,this.headLength=+s,this.insetStart=+u,this.insetEnd=+f}render(t,e,n,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a,SW:c}=n,{strokeWidth:u,bend:f,headAngle:h,headLength:d,insetStart:p,insetEnd:m}=this,y=c?t=>c[t]:q(void 0===u?1:u),g=f*Mo,v=h*Mo/2,x=d/1.5;return Je("svg:g",o).call(Wr,this,r,o).call(qr,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(jr,this).attr("d",(t=>{let e=i[t],n=a[t],r=l[t],o=s[t];const c=Math.hypot(r-e,o-n);if(c<=p+m)return null;let u=Math.atan2(o-n,r-e);const f=Math.min(x*y(t),c/3),h=Math.hypot(c/Math.tan(g),c)/2;if(p||m)if(h<1e5){const t=Math.sign(g),[i,a]=function([t,e],[n,r],o,i){const a=n-t,l=r-e,s=Math.hypot(a,l),c=i*Math.sqrt(o*o-s*s/4)/s;return[(t+n)/2-l*c,(e+r)/2+a*c]}([e,n],[r,o],h,t);if(p&&([e,n]=Zl([i,a,h],[e,n,p],-t*Math.sign(p))),m){const[e,n]=Zl([i,a,h],[r,o,m],t*Math.sign(m));u+=Math.atan2(n-a,e-i)-Math.atan2(o-a,r-i),r=e,o=n}}else{const t=r-e,i=o-n,a=Math.hypot(t,i);p&&(e+=t/a*p,n+=i/a*p),m&&(r-=t/a*m,o-=i/a*m)}const d=u+g,w=d+v,b=d-v,k=r-f*Math.cos(w),$=o-f*Math.sin(w),M=r-f*Math.cos(b),L=o-f*Math.sin(b);return`M${e},${n}${h<1e5?`A${h},${h} 0,0,${g>0?1:0} `:"L"}${r},${o}M${k},${$}L${r},${o}L${M},${L}`})).call(Br,this,n))).node()}}function Zl([t,e,n],[r,o,i],a){const l=r-t,s=o-e,c=Math.hypot(l,s),u=(l*l+s*s-i*i+n*n)/(2*c),f=a*Math.sqrt(n*n-u*u);return[t+(l*u+s*f)/c,e+(s*u-l*f)/c]}class Ql extends uo{constructor(t,e,n={},r){super(t,e,n,r);const{inset:o=0,insetTop:i=o,insetRight:a=o,insetBottom:l=o,insetLeft:s=o,rx:c,ry:u}=n;this.insetTop=W(i),this.insetRight=W(a),this.insetBottom=W(l),this.insetLeft=W(s),this.rx=Yr(c,"auto"),this.ry=Yr(u,"auto")}render(t,e,n,r,o){const{rx:i,ry:a}=this;return Je("svg:g",o).call(Wr,this,r,o).call(this._transform,this,e).call((o=>o.selectAll().data(t).enter().append("rect").call(jr,this).attr("x",this._x(e,n,r)).attr("width",this._width(e,n,r)).attr("y",this._y(e,n,r)).attr("height",this._height(e,n,r)).call(Dr,"rx",i).call(Dr,"ry",a).call(Br,this,n))).node()}_x(t,{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e?t=>e[t]+r:n+r}_y(t,{y:e},{marginTop:n}){const{insetTop:r}=this;return e?t=>e[t]+r:n+r}_width({x:t},{x:e},{marginRight:n,marginLeft:r,width:o}){const{insetLeft:i,insetRight:a}=this,l=e&&t?t.bandwidth():o-n-r;return Math.max(0,l-i-a)}_height({y:t},{y:e},{marginTop:n,marginBottom:r,height:o}){const{insetTop:i,insetBottom:a}=this,l=e&&t?t.bandwidth():o-n-r;return Math.max(0,l-i-a)}}const Jl={ariaLabel:"bar"};class Kl extends Ql{constructor(t,e={}){const{x1:n,x2:r,y:o}=e;super(t,{x1:{value:n,scale:"x"},x2:{value:r,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},e,Jl)}_transform(t,e,{x:n}){t.call(qr,e,{x:n},0,0)}_x({x:t},{x1:e,x2:n},{marginLeft:r}){const{insetLeft:o}=this;return vr(t)?r+o:t=>Math.min(e[t],n[t])+o}_width({x:t},{x1:e,x2:n},{marginRight:r,marginLeft:o,width:i}){const{insetLeft:a,insetRight:l}=this;return vr(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(n[t]-e[t])-a-l)}}class ts extends Ql{constructor(t,e={}){const{x:n,y1:r,y2:o}=e;super(t,{y1:{value:r,scale:"y"},y2:{value:o,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e,Jl)}_transform(t,e,{y:n}){t.call(qr,e,{y:n},0,0)}_y({y:t},{y1:e,y2:n},{marginTop:r}){const{insetTop:o}=this;return vr(t)?r+o:t=>Math.min(e[t],n[t])+o}_height({y:t},{y1:e,y2:n},{marginTop:r,marginBottom:o,height:i}){const{insetTop:a,insetBottom:l}=this;return vr(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(n[t]-e[t])-a-l)}}function es(t,e={}){return rt(e)||(e={...e,y:T,x2:B}),new Kl(t,Ll(Yo(bl(e))))}function ns(t,e={}){return rt(e)||(e={...e,x:T,y2:B}),new ts(t,Al(_o(kl(e))))}const rs={ariaLabel:"cell"};class os extends Ql{constructor(t,{x:e,y:n,...r}={}){super(t,{x:{value:e,scale:"x",type:"band",optional:!0},y:{value:n,scale:"y",type:"band",optional:!0}},r,rs)}_transform(t,e){t.call(qr,e,{},0,0)}}function is(t,{x:e,y:n,...r}={}){return[e,n]=ut(e,n),new os(t,{...r,x:e,y:n})}const as={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function ls(t){return void 0===t.sort&&void 0===t.reverse?fe({channel:"-r"},t):t}class ss extends uo{constructor(t,n={}){const{x:r,y:o,r:i,rotate:a,symbol:s=e.symbolCircle,frameAnchor:c}=n,[u,f]=H(a,0),[h,d]=function(t){if(null==t||ee(t))return[void 0,t];if("string"==typeof t){const e=te.get(`${t}`.toLowerCase());if(e)return[void 0,e]}return[t,void 0]}(s),[p,m]=H(i,null==h?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},r:{value:p,scale:"r",filter:l,optional:!0},rotate:{value:u,optional:!0},symbol:{value:h,scale:"auto",optional:!0}},ls(n),as),this.r=m,this.rotate=f,this.symbol=d,this.frameAnchor=Ft(c);const{channels:y}=this,{symbol:g}=y;if(g){const{fill:t,stroke:e}=y;g.hint={fill:t?t.value===g.value?"color":"currentColor":this.fill,stroke:e?e.value===g.value?"color":"currentColor":this.stroke}}}render(t,n,r,o,i){const{x:a,y:l}=n,{x:c,y:u,r:f,rotate:h,symbol:d}=r,{r:p,rotate:m,symbol:y}=this,[g,v]=Vr(this,o),x=y===e.symbolCircle,w=f?void 0:p*p*Math.PI;return s(p)&&(t=[]),Je("svg:g",i).call(Wr,this,o,i).call(qr,this,{x:c&&a,y:u&&l}).call((n=>n.selectAll().data(t).enter().append(x?"circle":"path").call(jr,this).call(x?t=>{t.attr("cx",c?t=>c[t]:g).attr("cy",u?t=>u[t]:v).attr("r",f?t=>f[t]:p)}:t=>{t.attr("transform",Ko`translate(${c?t=>c[t]:g},${u?t=>u[t]:v})${h?t=>` rotate(${h[t]})`:m?` rotate(${m})`:""}`).attr("d",f&&d?t=>{const n=e.pathRound();return d[t].draw(n,f[t]*f[t]*Math.PI),n}:f?t=>{const n=e.pathRound();return y.draw(n,f[t]*f[t]*Math.PI),n}:d?t=>{const n=e.pathRound();return d[t].draw(n,w),n}:(()=>{const t=e.pathRound();return y.draw(t,w),t})())}).call(Br,this,r))).node()}}function cs(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=ut(e,n)),new ss(t,{...r,x:e,y:n})}const us={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class fs extends uo{constructor(t,e={}){const{x:n,y:r,z:o,curve:i,tension:a}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:ft(e),optional:!0}},e,us),this.z=o,this.curve=Xa(i,a),Lo(this,e)}filter(t){return t}project(t,e,n){this.curve!==Ua&&super.project(t,e,n)}render(t,n,r,o,i){const{x:a,y:l}=r,{curve:s}=this;return Je("svg:g",i).call(Wr,this,o,i).call(qr,this,n).call((n=>n.selectAll().data(Ir(t,[a,l],this,r)).enter().append("path").call(jr,this).call(Nr,this,r).call(To,this,r,i).attr("d",s===Ua&&i.projection?function(t,n,r){const o=e.geoPath(t);return n=_(n),r=_(r),t=>{let e=[];const i=[e];for(const o of t)-1===o?(e=[],i.push(e)):e.push([n[o],r[o]]);return o({type:"MultiLineString",coordinates:i})}}(i.projection,a,l):e.line().curve(s).defined((t=>t>=0)).x((t=>a[t])).y((t=>l[t]))))).node()}}function hs(t,{x:e,y:n,...r}={}){return[e,n]=ut(e,n),new fs(t,{...r,x:e,y:n})}function ds(t,{x:e=B,y:n=T,...r}={}){return new fs(t,Ka({...r,x:e,y:n}))}function ps(t,{x:e=T,y:n=B,...r}={}){return new fs(t,Ja({...r,x:e,y:n}))}const ms={ariaLabel:"rect"};class ys extends uo{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,inset:a=0,insetTop:l=a,insetRight:s=a,insetBottom:c=a,insetLeft:u=a,rx:f,ry:h}=e;super(t,{x1:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,ms),this.insetTop=W(l),this.insetRight=W(s),this.insetBottom=W(c),this.insetLeft=W(u),this.rx=Yr(f,"auto"),this.ry=Yr(h,"auto")}render(t,e,n,r,o){const{x:i,y:a}=e,{x1:l,y1:s,x2:c,y2:u}=n,{marginTop:f,marginRight:h,marginBottom:d,marginLeft:p,width:m,height:y}=r,{projection:g}=o,{insetTop:v,insetRight:x,insetBottom:w,insetLeft:b,rx:k,ry:$}=this;return Je("svg:g",o).call(Wr,this,r,o).call(qr,this,{x:l&&c&&i,y:s&&u&&a},0,0).call((e=>e.selectAll().data(t).enter().append("rect").call(jr,this).attr("x",l&&c&&(g||!vr(i))?t=>Math.min(l[t],c[t])+b:p+b).attr("y",s&&u&&(g||!vr(a))?t=>Math.min(s[t],u[t])+v:f+v).attr("width",l&&c&&(g||!vr(i))?t=>Math.max(0,Math.abs(c[t]-l[t])-b-x):m-h-p-x-b).attr("height",s&&u&&(g||!vr(a))?t=>Math.max(0,Math.abs(s[t]-u[t])-v-w):y-f-d-v-w).call(Dr,"rx",k).call(Dr,"ry",$).call(Br,this,n))).node()}}function gs(t,e){return new ys(t,Do(qo(e)))}function vs(t,e={}){return rt(e)||(e={...e,y:T,x2:B,interval:1}),new ys(t,Ll(qo(bl(e))))}function xs(t,e={}){return rt(e)||(e={...e,x:T,y2:B,interval:1}),new ys(t,Al(Do(kl(e))))}function ws(t,e){e=function({x:t,y:e,color:n,size:r,fx:o,fy:i,mark:a}={}){lt(t)||(t=$s(t));lt(e)||(e=$s(e));lt(n)||(n=Nt(n)?{color:n}:$s(n));lt(r)||(r=$s(r));lt(o)&&({value:o}=$s(o));lt(i)&&({value:i}=$s(i));null!=a&&(a=`${a}`.toLowerCase());return{x:t,y:e,color:n,size:r,fx:o,fy:i,mark:a}}(e);const{x:n,y:r,color:o,size:i}=e,a=ks(t,n),l=ks(t,r),s=ks(t,o),c=ks(t,i);let u,f,h,{fx:d,fy:p,x:{value:m,reduce:y,zero:g,...v},y:{value:x,reduce:w,zero:b,...k},color:{value:$,color:M,reduce:L},size:{value:A,reduce:S},mark:z}=e;if(void 0===y&&(y=null==w&&null==m&&null==A&&null!=x?"count":null),void 0===w&&(w=null==y&&null==x&&null==A&&null!=m?"count":null),void 0!==S||null!=A||null!=L||null!=y||null!=w||null!=m&&!Et(a)||null!=x&&!Et(l)||(S="count"),void 0===g&&(g=!!Ms(y)||void 0),void 0===b&&(b=!!Ms(w)||void 0),null==m&&null==x)throw new Error("must specify x or y");if(null!=y&&null==x)throw new Error("reducing x requires y");if(null!=w&&null==m)throw new Error("reducing y requires x");switch(void 0===z&&(z=null!=A||null!=S?"dot":Ms(y)||Ms(w)||null!=L?"bar":null!=m&&null!=x?Et(a)||Et(l)||null==y&&null==w&&!bs(a)&&!bs(l)?"dot":"line":null!=m||null!=x?"rule":null),z){case"dot":h=cs,f="stroke";break;case"line":h=a&&l||null!=y||null!=w?b||null!=w||a&&bs(a)?ps:g||null!=y||l&&bs(l)?ds:hs:a?ds:ps,f="stroke",As(s)&&(u=null);break;case"area":h=!b&&null==w&&(g||null!=y||l&&bs(l))?ql:Yl,f="fill",As(s)&&(u=null);break;case"rule":h=a?Zo:Qo,f="stroke";break;case"bar":h=b?Ls(y,a)?ns:xs:g?Ls(w,l)?es:vs:Ls(y,a)&&Ls(w,l)?is:Ls(y,a)?ns:Ls(w,l)?es:null!=y?vs:null!=w?xs:null!=L?gs:is,f="fill";break;default:throw new Error(`invalid mark: ${z}`)}let E,R={fx:d,fy:p,x:a??void 0,y:l??void 0,[f]:s??M,z:u,r:c??void 0,tip:!0},O={[f]:L??void 0,r:S??void 0};if(null!=y&&null!=w)throw new Error("cannot reduce both x and y");return null!=w?(O.y=w,E=Et(a)?ye:Va):null!=y?(O.x=y,E=Et(l)?ge:Ha):null==L&&null==S||(a&&l?E=Et(a)&&Et(l)?ve:Et(a)?Ha:Et(l)?Va:Za:a?E=Et(a)?ye:Va:l&&(E=Et(l)?ge:Ha)),E!==Za&&E!==Va||(R.x={value:a,...v}),E!==Za&&E!==Ha||(R.y={value:l,...k}),void 0===g&&(g=a&&!(E===Za||E===Va)&&(h===es||h===ql||h===vs||h===Qo)),void 0===b&&(b=l&&!(E===Za||E===Ha)&&(h===ns||h===Yl||h===xs||h===Zo)),{fx:d??null,fy:p??null,x:{value:m??null,reduce:y??null,zero:!!g,...v},y:{value:x??null,reduce:w??null,zero:!!b,...k},color:{value:$??null,reduce:L??null,...void 0!==M&&{color:M}},size:{value:A??null,reduce:S??null},mark:z,markImpl:zs[h],markOptions:R,transformImpl:zs[E],transformOptions:O,colorMode:f}}function bs(t){let n,r;for(const o of t){if(null==o)continue;if(void 0===n){n=o;continue}const t=Math.sign(e.ascending(n,o));if(t){if(void 0!==r&&t!==r)return!1;n=o,r=t}}return!0}function ks(t,e){const n=z(t,e.value);return n&&(n.label=wt(e.value)),n}function $s(t){return function(t){if(null==t)return!1;if("function"==typeof t.reduceIndex)return!0;if("function"==typeof t.reduce&&ot(t))return!0;if(/^p\d{2}$/i.test(t))return!0;switch(`${t}`.toLowerCase()){case"first":case"last":case"count":case"distinct":case"sum":case"proportion":case"proportion-facet":case"deviation":case"min":case"min-index":case"max":case"max-index":case"mean":case"median":case"variance":case"mode":return!0}return!1}(t)?{reduce:t}:{value:t}}function Ms(t){return/^(?:distinct|count|sum|proportion)$/i.test(t)}function Ls(t,e){return!(null!=t&&!function(t){return/^(?:first|last|mode)$/i.test(t)}(t)||!e)&&Et(e)}function As(t){return!!t&&new e.InternSet(t).size>t.length>>1}const Ss={dot:cs,line:hs,lineX:ds,lineY:ps,areaX:ql,areaY:Yl,ruleX:Zo,ruleY:Qo,barX:es,barY:ns,rect:gs,rectX:vs,rectY:xs,cell:is,bin:Za,binX:Va,binY:Ha,group:ve,groupX:ye,groupY:ge},zs=Object.fromEntries(Object.entries(Ss).map((([t,e])=>[e,t])));function Es(t,e={}){let{x:n,x1:r,x2:o}=e;void 0===n&&void 0===r&&void 0===o&&(e={...e,x:n=B});const i={};return null!=n&&(i.x=t),null!=r&&(i.x1=t),null!=o&&(i.x2=t),Os(i,e)}function Rs(t,e={}){let{y:n,y1:r,y2:o}=e;void 0===n&&void 0===r&&void 0===o&&(e={...e,y:n=B});const i={};return null!=n&&(i.y=t),null!=r&&(i.y1=t),null!=o&&(i.y2=t),Os(i,e)}function Os(t={},n={}){const r=ft(n),o=Object.entries(t).map((([t,e])=>{const r=gt(t,n);if(null==r)throw new Error(`missing channel: ${t}`);const[o,i]=vt(r);return{key:t,input:r,output:o,setOutput:i,map:Cs(e)}}));return{...oe(n,((t,n)=>{const i=z(t,r),a=o.map((({input:e})=>z(t,e))),l=o.map((({setOutput:e})=>e(new Array(t.length))));for(const t of n)for(const n of i?e.group(t,(t=>i[t])).values():[t])o.forEach((({map:t},e)=>t.mapIndex(n,a[e],l[e])));return{data:t,facets:n}})),...Object.fromEntries(o.map((({key:t,output:e})=>[t,e])))}}function Cs(t){if(null==t)throw new Error("missing map");if("function"==typeof t.mapIndex)return t;if("function"==typeof t.map&&ot(t))return function(t){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:t.map.bind(t)}}(t);if("function"==typeof t)return Ts(pt(t));switch(`${t}`.toLowerCase()){case"cumsum":return Bs;case"rank":return Ts(((t,n)=>e.rank(t,(t=>n[t]))));case"quantile":return Ts(((t,n)=>function(t,n){const r=e.count(t,n)-1;return e.rank(t,n).map((t=>t/r))}(t,(t=>n[t]))))}throw new Error(`invalid map: ${t}`)}function Ts(t){return{mapIndex(e,n,r){const o=t(e,n);if(o.length!==e.length)throw new Error("map function returned a mismatched length");for(let t=0,n=e.length;t<n;++t)r[e[t]]=o[t]}}}const Bs={mapIndex(t,e,n){let r=0;for(const o of t)n[o]=r+=e[o]}},Ns={ariaLabel:"tick",fill:null,stroke:"currentColor"};class Ps extends uo{constructor(t,e,n){super(t,e,n,Ns),Lo(this,n)}render(t,e,n,r,o){return Je("svg:g",o).call(Wr,this,r,o).call(this._transform,this,e).call((i=>i.selectAll().data(t).enter().append("line").call(jr,this).attr("x1",this._x1(e,n,r)).attr("x2",this._x2(e,n,r)).attr("y1",this._y1(e,n,r)).attr("y2",this._y2(e,n,r)).call(Br,this,n).call(Co,this,n,o))).node()}}class Is extends Ps{constructor(t,e={}){const{x:n,y:r,inset:o=0,insetTop:i=o,insetBottom:a=o}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y",type:"band",optional:!0}},e),this.insetTop=W(i),this.insetBottom=W(a)}_transform(t,e,{x:n}){t.call(qr,e,{x:n},zr,0)}_x1(t,{x:e}){return t=>e[t]}_x2(t,{x:e}){return t=>e[t]}_y1({y:t},{y:e},{marginTop:n}){const{insetTop:r}=this;return e&&t?t=>e[t]+r:n+r}_y2({y:t},{y:e},{height:n,marginBottom:r}){const{insetBottom:o}=this;return e&&t?n=>e[n]+t.bandwidth()-o:n-r-o}}class Ws extends Ps{constructor(t,e={}){const{x:n,y:r,inset:o=0,insetRight:i=o,insetLeft:a=o}=e;super(t,{y:{value:r,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e),this.insetRight=W(i),this.insetLeft=W(a)}_transform(t,e,{y:n}){t.call(qr,e,{y:n},0,zr)}_x1({x:t},{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e&&t?t=>e[t]+r:n+r}_x2({x:t},{x:e},{width:n,marginRight:r}){const{insetRight:o}=this;return e&&t?n=>e[n]+t.bandwidth()-o:n-r-o}_y1(t,{y:e}){return t=>e[t]}_y2(t,{y:e}){return t=>e[t]}}function js(t,{x:e=B,...n}={}){return new Is(t,{...n,x:e})}function Fs(t,{y:e=B,...n}={}){return new Ws(t,{...n,y:e})}function Ds(t){const e=qs(t),n=Ys(t);return t.map((t=>t<e||t>n?t:NaN))}function qs(t){const n=2.5*_s(t)-1.5*Gs(t);return e.min(t,(t=>t>=n?t:NaN))}function Ys(t){const n=2.5*Gs(t)-1.5*_s(t);return e.max(t,(t=>t<=n?t:NaN))}function _s(t){return e.quantile(t,.25)}function Gs(t){return e.quantile(t,.75)}const Xs={ariaLabel:"raster",stroke:null,pixelSize:1};function Us(t,e){const n=+t;if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}function Vs(t,e){const n=Math.floor(t);if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}class Hs extends uo{constructor(t,e,n={},r){let{width:o,height:i,x:a,y:l,x1:s=(null==a?0:void 0),y1:c=(null==l?0:void 0),x2:u=(null==a?o:void 0),y2:f=(null==l?i:void 0),pixelSize:h=r.pixelSize,blur:d=0,interpolate:p}=n;if(null!=o&&(o=Vs(o,"width")),null!=i&&(i=Vs(i,"height")),null!=s&&(s=Us(s,"x1")),null!=c&&(c=Us(c,"y1")),null!=u&&(u=Us(u,"x2")),null!=f&&(f=Us(f,"y2")),null==a&&(null==s||null==u))throw new Error("missing x");if(null==l&&(null==c||null==f))throw new Error("missing y");null!=t&&null!=o&&null!=i&&(void 0===a&&null!=s&&null!=u&&(a=function(t,e,n){return{transform(r){const o=r.length,i=new Float64Array(o),a=(e-t)/n,l=t+a/2;for(let t=0;t<o;++t)i[t]=t%n*a+l;return i}}}(s,u,o)),void 0===l&&null!=c&&null!=f&&(l=function(t,e,n,r){return{transform(o){const i=o.length,a=new Float64Array(i),l=(e-t)/r,s=t+l/2;for(let t=0;t<i;++t)a[t]=Math.floor(t/n)%r*l+s;return a}}}(c,f,o,i))),super(t,{x:{value:a,scale:"x",optional:!0},y:{value:l,scale:"y",optional:!0},x1:{value:null==s?null:[s],scale:"x",optional:!0,filter:null},y1:{value:null==c?null:[c],scale:"y",optional:!0,filter:null},x2:{value:null==u?null:[u],scale:"x",optional:!0,filter:null},y2:{value:null==f?null:[f],scale:"y",optional:!0,filter:null},...e},n,r),this.width=o,this.height=i,this.pixelSize=Us(h,"pixelSize"),this.blur=Us(d,"blur"),this.interpolate=null==a||null==l?null:function(t){if("function"==typeof t)return t;if(null==t)return ec;switch(`${t}`.toLowerCase()){case"none":return ec;case"nearest":return ic;case"barycentric":return nc();case"random-walk":return ac()}throw new Error(`invalid interpolate: ${t}`)}(p)}}class Zs extends Hs{constructor(t,e={}){const{imageRendering:n}=e;if(null==t){const{fill:t,fillOpacity:n}=e;void 0!==H(n)[0]&&(e=tc("fillOpacity",e)),void 0!==V(t)[0]&&(e=tc("fill",e))}super(t,void 0,e,Xs),this.imageRendering=Yr(n,"auto")}scale(t,{color:e,...n},r){return super.scale(t,n,r)}render(t,n,r,o,i){const a=n[r.channels.fill?.scale]??(t=>t),{x:l,y:s}=r,{document:c}=i,[u,f,h,d]=Js(r,o,i),p=h-u,m=d-f,{pixelSize:y,width:g=Math.round(Math.abs(p)/y),height:v=Math.round(Math.abs(m)/y)}=this,x=g*v;let{fill:w,fillOpacity:b}=r,k=0;if(this.interpolate){const e=g/p,n=v/m,r=K(l,(t=>(t-u)*e),Float64Array),o=K(s,(t=>(t-f)*n),Float64Array);w&&(w=this.interpolate(t,g,v,r,o,w)),b&&(b=this.interpolate(t,g,v,r,o,b))}else null==this.data&&t&&(k=t.fi*x);const $=c.createElement("canvas");$.width=g,$.height=v;const M=$.getContext("2d"),L=M.createImageData(g,v),A=L.data;let{r:S,g:z,b:E}=e.rgb(this.fill)??{r:0,g:0,b:0},R=255*(this.fillOpacity??1);for(let t=0;t<x;++t){const n=t<<2;if(w){const r=a(w[t+k]);if(null==r){A[n+3]=0;continue}({r:S,g:z,b:E}=e.rgb(r))}b&&(R=255*b[t+k]),A[n+0]=S,A[n+1]=z,A[n+2]=E,A[n+3]=R}return this.blur>0&&e.blurImage(L,this.blur),M.putImageData(L,0,0),Je("svg:g",i).call(Wr,this,o,i).call(qr,this,n).call((t=>t.append("image").attr("transform",`translate(${u},${f}) scale(${Math.sign(h-u)},${Math.sign(d-f)})`).attr("width",Math.abs(p)).attr("height",Math.abs(m)).attr("preserveAspectRatio","none").call(Dr,"image-rendering",this.imageRendering).call(jr,this).attr("xlink:href",$.toDataURL()))).node()}}function Qs(t,e,n){arguments.length<3&&(n=e,e=null);let{x:r,y:o,[t]:i,...a}=n;return void 0===r&&void 0===o&&function(t){if(!St(t))return!1;for(const e of t)if(null!=e)return"object"==typeof e&&"0"in e&&"1"in e}(e)&&(r=j,o=F,void 0===i&&(i=D)),[e,{...a,x:r,y:o,[t]:i}]}function Js({x1:t,y1:e,x2:n,y2:r},o,{projection:i}){const{width:a,height:l,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}=o;return[t&&null==i?t[0]:f,e&&null==i?e[0]:s,n&&null==i?n[0]:a-c,r&&null==i?r[0]:l-u]}function Ks({x1:t,y1:e,x2:n,y2:r},o,i,a){const l={};return t&&(l.x1=t),e&&(l.y1=e),n&&(l.x2=n),r&&(l.y2=r),Js(De(l,o),i,a)}function tc(t,e={}){const{[t]:n}=e;if("function"!=typeof n)throw new Error(`invalid ${t}: not a function`);return ie({...e,[t]:void 0},(function(r,o,i,a,l,s){const{x:c,y:u}=a;if(!c)throw new Error("missing scale: x");if(!u)throw new Error("missing scale: y");const[f,h,d,p]=Ks(i,a,l,s),m=d-f,y=p-h,{pixelSize:g}=this,{width:v=Math.round(Math.abs(m)/g),height:x=Math.round(Math.abs(y)/g)}=e,w=new Array(v*x*(o?o.length:1)),b=m/v,k=y/x;let $=0;for(const t of o??[void 0])for(let e=.5;e<x;++e)for(let r=.5;r<v;++r,++$)w[$]=n(c.invert(f+r*b),u.invert(h+e*k),t);return{data:w,facets:o,channels:{[t]:{value:w,scale:"auto"}}}}))}function ec(t,e,n,r,o,i){const a=new Array(e*n);for(const l of t)r[l]<0||r[l]>=e||o[l]<0||o[l]>=n||(a[Math.floor(o[l])*e+Math.floor(r[l])]=i[l]);return a}function nc({random:t=e.randomLcg(42)}={}){return(n,r,o,i,a,l)=>{const{points:s,triangles:c,hull:u}=e.Delaunay.from(n,(t=>i[t]),(t=>a[t])),f=new l.constructor(r*o).fill(NaN),h=new Uint8Array(r*o),d=function(t,e){return Tt(t)||Rt(t)?lc:function(t){return(e,n,r,o,i,a,l,s)=>{const c=t(l,s);return c<n?e:c<n+o?r:i}}(e)}(l,t);for(let t=0;t<c.length;t+=3){const e=c[t],i=c[t+1],a=c[t+2],u=s[2*e],p=s[2*i],m=s[2*a],y=s[2*e+1],g=s[2*i+1],v=s[2*a+1],x=Math.min(u,p,m),w=Math.max(u,p,m),b=Math.min(y,g,v),k=Math.max(y,g,v),$=(g-v)*(u-m)+(y-v)*(m-p);if(!$)continue;const M=l[n[e]],L=l[n[i]],A=l[n[a]];for(let t=Math.floor(x);t<w;++t)for(let e=Math.floor(b);e<k;++e){if(t<0||t>=r||e<0||e>=o)continue;const n=t+.5,i=e+.5,a=((g-v)*(n-m)+(i-v)*(m-p))/$;if(a<0)continue;const l=((v-y)*(n-m)+(i-v)*(u-m))/$;if(l<0)continue;const s=1-a-l;if(s<0)continue;const c=t+r*e;f[c]=d(M,a,L,l,A,s,t,e),h[c]=1}}return function(t,e,n,r,o,i,a,l,s,c){n=Float64Array.from(l,(t=>n[s[t]])),r=Float64Array.from(l,(t=>r[s[t]])),o=Array.from(l,(t=>o[s[t]]));const u=n.length,f=Array.from({length:u},((t,e)=>function(t,e,n){const r=e.length,o=e.at(t-2),i=n.at(t-2),a=e.at(t-1),l=n.at(t-1),s=e[t],c=n[t],u=e.at(t+1-r),f=n.at(t+1-r),h=a-s,d=l-c,p=o-a,m=i-l,y=s-u,g=c-f,v=Math.hypot(h,d),x=Math.hypot(p,m),w=Math.hypot(y,g);return(t,e)=>{const n=t-a,r=e-l,o=t-s,i=e-c;return oc(n,r,o,i)>-1e-6&&oc(n,r,h,d)*x-oc(n,r,p,m)*v>-1e-6&&oc(o,i,y,g)*v-oc(o,i,h,d)*w<=0}}(e,n,r)));let h=0;for(let l=0;l<a;++l){const a=l+.5;for(let s=0;s<i;++s){const d=s+i*l;if(!e[d]){const e=s+.5;for(let i=0;i<u;++i){const p=(u+h+(i%2?(i+1)/2:-i/2))%u;if(f[p](e,a)){const i=rc(n.at(p-1),r.at(p-1),n[p],r[p],e,a);t[d]=c(o.at(p-1),i,o[p],1-i,o[p],0,s,l),h=p;break}}}}}}(f,h,i,a,l,r,o,u,n,d),f}}function rc(t,e,n,r,o,i){const a=n-t,l=r-e,s=a*(n-o)+l*(r-i),c=a*(o-t)+l*(i-e);return s>0&&c>0?s/(s+c):+(s>c)}function oc(t,e,n,r){return t*r-n*e}function ic(t,n,r,o,i,a){const l=new a.constructor(n*r),s=e.Delaunay.from(t,(t=>o[t]),(t=>i[t]));let c,u;for(let e=.5,o=0;e<r;++e){u=c;for(let r=.5;r<n;++r,++o)u=s.find(r,e,u),.5===r&&(c=u),l[o]=a[t[u]]}return l}function ac({random:t=e.randomLcg(42),minDistance:n=.5,maxSteps:r=2}={}){return(o,i,a,l,s,c)=>{const u=new c.constructor(i*a),f=e.Delaunay.from(o,(t=>l[t]),(t=>s[t]));let h,d,p;for(let e=.5,m=0;e<a;++e){d=h;for(let a=.5;a<i;++a,++m){let i,y=a,g=e;p=d=f.find(y,g,d),.5===a&&(h=d);let v=0;for(;(i=Math.hypot(l[o[p]]-y,s[o[p]]-g))>n&&v<r;){const n=2*t(a,e,v)*Math.PI;y+=Math.cos(n)*i,g+=Math.sin(n)*i,p=f.find(y,g,p),++v}u[m]=c[o[p]]}}return u}}function lc(t,e,n,r,o,i){return e*t+r*n+i*o}const sc={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2};class cc extends Hs{constructor(t,{smooth:n=!0,value:r,...o}={}){const i=Or({},o,sc);if(void 0===r)for(const t in i)if(null!=i[t].value){if(void 0!==r)throw new Error("ambiguous contour value");r=o[t],o[t]="value"}if(null!=r){const t={transform:t=>t.map((t=>t.value)),label:wt(r)};for(const e in i)"value"===o[e]&&(o[e]=t)}if(null==t){if(null==r)throw new Error("missing contour value");o=tc("value",{value:r,...o}),r=null}else{let{interpolate:t}=o;void 0===r&&(r=B),void 0===t&&(o.interpolate="nearest")}super(t,{value:{value:r,optional:!0}},function({thresholds:t,interval:n,...r}){return t=ol(t,n,e.thresholdSturges),ie(r,(function(n,r,o,i,a,l){const[s,c,u,f]=Ks(o,i,a,l),h=u-s,d=f-c,{pixelSize:p,width:m=Math.round(Math.abs(h)/p),height:y=Math.round(Math.abs(d)/p)}=this,g=m/h,v=y/d,x=o.value.value,w=[];if(this.interpolate){const{x:t,y:e}=dn(o,i,l),n=K(t,(t=>(t-s)*g),Float64Array),a=K(e,(t=>(t-c)*v),Float64Array),u=[o.x,o.y,o.value],f=[n,a,x];for(const t of r){const e=this.filter(t,u,f);w.push(this.interpolate(e,m,y,n,a,x))}}else if(r){const t=m*y,e=r.length;for(let n=0;n<e;++n)w.push(x.slice(n*t,n*t+t))}else w.push(x);if(this.blur>0)for(const t of w)e.blur2({data:t,width:m,height:y},this.blur);const b=function(t,n,r,o){if("function"==typeof t?.range)return t.range(t.floor(r),o);"function"==typeof t&&(t=t(n,r,o));if("number"!=typeof t)return J(t);const i=e.ticks(...e.nice(r,o,t),t);for(;i[i.length-1]>=o;)i.pop();for(;i[1]<r;)i.shift();return i}(t,x,...function(t){return[e.min(t,(t=>e.min(t,uc))),e.max(t,(t=>e.max(t,uc)))]}(w));if(null===b)throw new Error(`unsupported thresholds: ${t}`);const{contour:k}=e.contours().size([m,y]).smooth(this.smooth),$=[],M=[];for(const t of w)M.push(e.range($.length,$.push(...K(b,(e=>k(t,e))))));for(const{coordinates:t}of $)for(const e of t)for(const t of e)for(const e of t)e[0]=e[0]/g+s,e[1]=e[1]/v+c;return{data:$,facets:M,channels:Fe(this.contourChannels,$)}}))}(o),sc);const a={geometry:{value:B}};for(const t in this.channels){const e=this.channels[t],{scale:n}=e;"x"!==n&&"y"!==n&&"value"!==t&&(a[t]=e,delete this.channels[t])}this.contourChannels=a,this.smooth=!!n}filter(t,{x:e,y:n,value:r,...o},i){return super.filter(t,o,i)}render(t,n,r,o,i){const{geometry:a}=r,l=e.geoPath();return Je("svg:g",i).call(Wr,this,o,i).call(qr,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(jr,this).attr("d",(t=>l(a[t]))).call(Br,this,r)})).node()}}function uc(t){return isFinite(t)?t:NaN}function fc(t,e,n={}){const{x:r,y:o,maxRadius:i}=n,a=t({px:r,py:o,maxRadius:i}),l=[];null!=r&&l.push(Zo(e,pc("x",{...a,inset:-6},n))),null!=o&&l.push(Qo(e,pc("y",{...a,inset:-6},n))),null!=r&&l.push(ii(e,mc("x",{...a,dy:9,frameAnchor:"bottom",lineAnchor:"top"},n))),null!=o&&l.push(ii(e,mc("y",{...a,dx:-9,frameAnchor:"left",textAnchor:"end"},n)));for(const t of l)t.ariaLabel=`crosshair ${t.ariaLabel}`;return fo(...l)}function hc(t,{channels:e,...n},{facet:r,facetAnchor:o,fx:i,fy:a,[t]:l,channels:s,transform:c,initializer:u}){return{...n,facet:r,facetAnchor:o,fx:i,fy:a,[t]:l,channels:{...e,...s},transform:c,initializer:dc(t,u)}}function dc(t,e){return null==e?e:function(n,r,{x:o,y:i,px:a,py:l,...s},...c){const{channels:{x:u,y:f,...h}={},...d}=e.call(this,n,r,{...s,x:a,y:l},...c);return{channels:{...h,...u&&{px:u,..."x"===t&&{x:u}},...f&&{py:f,..."y"===t&&{y:f}}},...d}}}function pc(t,e,n){const{color:r="currentColor",opacity:o=.2,ruleStroke:i=r,ruleStrokeOpacity:a=o,ruleStrokeWidth:l}=n;return{...hc(t,e,n),stroke:i,strokeOpacity:a,strokeWidth:l}}function mc(t,e,n){const{color:r="currentColor",textFill:o=r,textFillOpacity:i,textStroke:a="white",textStrokeOpacity:l,textStrokeWidth:s=5}=n;return{...hc(t,e,yc(t,n)),fill:o,fillOpacity:i,stroke:a,strokeOpacity:l,strokeWidth:s}}function yc(t,e){return ie(e,((e,n,r)=>({channels:{text:{value:Ze(r,t)?.value}}})))}const gc={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},vc={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},xc={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},wc={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},bc={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class kc extends uo{constructor(t,e={}){const{x:n,y:r,z:o,curve:i,tension:a}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},e,gc),this.curve=Ga(i,a),Lo(this,e)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,{curve:f}=this,[h,d]=Vr(this,o),p=s?t=>s[t]:q(h),m=c?t=>c[t]:q(d),y=this;function g(t){let n=-1;const o=[],a={};for(const t in r)a[t]=[];const l=[],s=[],c=[],u=[];function h(e,i){e=t[e],i=t[i],o.push(++n),l[n]=p(e),c[n]=m(e),s[n]=p(i),u[n]=m(i);for(const t in r)a[t].push(r[t][i])}const{halfedges:d,hull:g,triangles:v}=e.Delaunay.from(t,p,m);for(let t=0;t<d.length;++t){const e=d[t];e>t&&h(v[t],v[e])}for(let t=0;t<g.length;++t)h(g[t],g[(t+1)%g.length]);e.select(this).selectAll().data(o).enter().append("path").call(jr,y).attr("d",(t=>{const n=e.pathRound(),r=f(n);return r.lineStart(),r.point(l[t],c[t]),r.point(s[t],u[t]),r.lineEnd(),n})).call(Br,y,a).call(Co,y,a,i)}return Je("svg:g",i).call(Wr,this,o,i).call(qr,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(g):e=>e.datum(t).each(g)).node()}}class $c extends uo{constructor(t,e={},n,r=(({z:t})=>t)){const{x:o,y:i}=e;super(t,{x:{value:o,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:r(e),optional:!0}},e,n)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,[f,h]=Vr(this,o),d=s?t=>s[t]:q(f),p=c?t=>c[t]:q(h),m=this;function y(t){const n=e.Delaunay.from(t,d,p);e.select(this).append("path").datum(t[0]).call(jr,m).attr("d",m._render(n,o)).call(Br,m,r)}return Je("svg:g",i).call(Wr,this,o,i).call(qr,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(y):e=>e.datum(t).each(y)).node()}}class Mc extends $c{constructor(t,e={}){super(t,e,vc),this.fill="none"}_render(t){return t.render()}}class Lc extends $c{constructor(t,e={}){super(t,e,xc,ft)}_render(t){return t.renderHull()}}class Ac extends uo{constructor(t,e={}){const{x:n,y:r,z:o}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},e,wc)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,[f,h]=Vr(this,o),d=s?t=>s[t]:q(f),p=c?t=>c[t]:q(h),m=this;function y(t){const n=zc(e.Delaunay.from(t,d,p),o);e.select(this).selectAll().data(t).enter().append("path").call(jr,m).attr("d",((t,e)=>n.renderCell(e))).call(Br,m,r)}return Je("svg:g",i).call(Wr,this,o,i).call(qr,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(y):e=>e.datum(t).each(y)).node()}}class Sc extends $c{constructor(t,e){super(t,e,bc),this.fill="none"}_render(t,e){return zc(t,e).render()}}function zc(t,e){const{width:n,height:r,marginTop:o,marginRight:i,marginBottom:a,marginLeft:l}=e;return t.voronoi([l,o,n-i,r-a])}function Ec(t,e,{x:n,y:r,...o}={}){return[n,r]=ut(n,r),new t(e,{...o,x:n,y:r})}const Rc={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Oc extends uo{constructor(t,{x:n,y:r,z:o,weight:i,fill:a,stroke:l,...s}={}){const c=Tc(a)&&(a="currentColor",!0),u=Tc(l)&&(l="currentColor",!0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:ft({z:o,fill:a,stroke:l}),optional:!0},weight:{value:i,optional:!0}},function(t,n,r){const o=100;let{bandwidth:i,thresholds:a}=t;return i=void 0===i?20:+i,a=void 0===a?20:"function"==typeof a?.[Symbol.iterator]?_(a):+a,ie(t,(function(t,l,s,c,u,f){const h=s.weight?_(s.weight.value):null,d=s.z?.value,{z:p}=this,[m,y]=Vr(this,u),{width:g,height:v}=u,{x:x,y:w}=dn(s,c,f),b=Object.fromEntries(Object.entries(s).filter((([t])=>!Cc.has(t))).map((([t,e])=>[t,{...e,value:[]}]))),k=n&&[],$=r&&[],M=e.contourDensity().x(x?t=>x[t]:m).y(w?t=>w[t]:y).weight(h?t=>h[t]:1).size([g,v]).bandwidth(i),L=[];for(const t of l){const e=[];L.push(e);for(const n of d?Pr(t,d,p):[t]){const t=M.contours(n);e.push([n,t])}}let S=a;if(!(S instanceof A)){let t=0;for(const e of L)for(const[,n]of e){const e=n.max;e>t&&(t=e)}S=Float64Array.from({length:a-1},((e,n)=>t*o*(n+1)/a))}const z=[],E=[];for(const t of L){const e=[];z.push(e);for(const[n,r]of t)for(const t of S){e.push(E.length),E.push(r(t/o)),k&&k.push(t),$&&$.push(t);for(const t in b)b[t].value.push(s[t].value[n[0]])}}return k&&k.push(0),$&&$.push(0),{data:t,facets:z,channels:{...b,...k&&{fill:{value:k,scale:"color"}},...$&&{stroke:{value:$,scale:"color"}},contours:{value:E}}}}))}({...s,fill:a,stroke:l},c,u),Rc),c&&(this.fill=void 0),u&&(this.stroke=void 0),this.z=o}filter(t){return t}render(t,n,r,o,i){const{contours:a}=r,l=e.geoPath();return Je("svg:g",i).call(Wr,this,o,i).call(qr,this,{}).call((e=>e.selectAll().data(t).enter().append("path").call(jr,this).call(Br,this,r).attr("d",(t=>l(a[t]))))).node()}}const Cc=new Set(["x","y","z","weight"]);function Tc(t){return/^density$/i.test(t)}const Bc={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Nc extends uo{constructor(t,e={}){const[n,r]=H(e.r,3);super(t,{geometry:{value:e.geometry,scale:"projection"},r:{value:n,scale:"r",filter:l,optional:!0}},ls(e),Bc),this.r=r}render(t,n,r,o,i){const{geometry:a,r:l}=r,c=e.geoPath(i.projection??function({x:t,y:n}){if(t||n)return t??=t=>t,n??=t=>t,e.geoTransform({point(e,r){this.stream.point(t(e),n(r))}})}(n)),{r:u}=this;return s(u)?t=[]:void 0!==u&&c.pointRadius(u),Je("svg:g",i).call(Wr,this,o,i).call(qr,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(jr,this).attr("d",l?t=>c.pointRadius(l[t])(a[t]):t=>c(a[t])).call(Br,this,r)})).node()}}function Pc(t,{geometry:e=B,...n}={}){switch(t?.type){case"FeatureCollection":t=t.features;break;case"GeometryCollection":t=t.geometries;break;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":t=[t]}return new Nc(t,{geometry:e,...n})}const Ic=.5,Wc=0;function jc(t,e,n,r){const o=r*(1.5/Qt),i=new Map;for(const a of t){let t=e[a],l=n[a];if(isNaN(t)||isNaN(l))continue;let s=Math.round(l=(l-Wc)/o),c=Math.round(t=(t-Ic)/r-(1&s)/2),u=l-s;if(3*Math.abs(u)>1){let e=t-c,n=c+(t<c?-1:1)/2,r=s+(l<s?-1:1),o=t-n,i=l-r;e*e+u*u>o*o+i*i&&(c=n+(1&s?1:-1)/2,s=r)}const f=`${c},${s}`;let h=i.get(f);void 0===h&&(i.set(f,h=[]),h.x=(c+(1&s)/2)*r+Ic,h.y=s*o+Wc),h.push(a)}return i.values()}const Fc={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};class Dc extends uo{constructor({binWidth:t=20,clip:e=!0,...n}={}){super(O,void 0,{clip:e,...n},Fc),this.binWidth=W(t)}render(t,e,n,r,o){const{binWidth:i}=this,{marginTop:a,marginRight:l,marginBottom:s,marginLeft:c,width:u,height:f}=r,h=c-Ic,d=u-l-Ic,p=a-Wc,m=f-s-Wc,y=i/2,g=y*Jt,v=g/2,x=2*y,w=1.5*g,b=Math.floor(h/x),k=Math.ceil(d/x),$=Math.floor((p+v)/w),M=Math.ceil((m-v)/w)+1,L=`m0,${qc(-g)}l${qc(y)},${qc(v)}v${qc(g)}l${qc(-y)},${qc(v)}`;let A=L;for(let t=$;t<M;++t)for(let e=b;e<k;++e)A+=`M${qc(e*x+(1&t)*y)},${qc(t*w)}${L}`;return Je("svg:g",o).datum(0).call(Wr,this,r,o).call(qr,this,{},zr+Ic,zr+Wc).call((t=>t.append("path").call(jr,this).call(Br,this,n).attr("d",A))).node()}}function qc(t){return Math.round(1e3*t)/1e3}const Yc={ariaLabel:"image",fill:null,stroke:null};class _c extends uo{constructor(t,e={}){let{x:n,y:r,r:o,width:i,height:a,rotate:s,src:c,preserveAspectRatio:u,crossOrigin:f,frameAnchor:h,imageRendering:d}=e;null==o&&(o=void 0),void 0===o&&void 0===i&&void 0===a?i=a=16:void 0===i&&void 0!==a?i=a:void 0===a&&void 0!==i&&(a=i);const[p,m]="string"==typeof(y=c)&&(function(t){return/^\.*\//.test(t)}(y)||function(t){return/^(blob|data|file|http|https):/i.test(t)}(y))?[void 0,y]:[y,void 0];var y;const[g,v]=H(o),[x,w]=H(i,void 0!==v?2*v:void 0),[b,k]=H(a,void 0!==v?2*v:void 0),[$,M]=H(s,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},r:{value:g,scale:"r",filter:l,optional:!0},width:{value:x,filter:l,optional:!0},height:{value:b,filter:l,optional:!0},rotate:{value:$,optional:!0},src:{value:p,optional:!0}},ls(e),Yc),this.src=m,this.width=w,this.rotate=M,this.height=k,this.r=v,this.preserveAspectRatio=Yr(u,"xMidYMid"),this.crossOrigin=I(f),this.frameAnchor=Ft(h),this.imageRendering=Yr(d,"auto")}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y:s,width:c,height:u,r:f,rotate:h,src:d}=n,{r:p,width:m,height:y,rotate:g}=this,[v,x]=Vr(this,r);return Je("svg:g",o).call(Wr,this,r,o).call(qr,this,{x:l&&i,y:s&&a}).call((e=>e.selectAll().data(t).enter().append("image").call(jr,this).attr("x",Gc(l,c,f,v,m,p)).attr("y",Gc(s,u,f,x,y,p)).attr("width",c?t=>c[t]:void 0!==m?m:f?t=>2*f[t]:2*p).attr("height",u?t=>u[t]:void 0!==y?y:f?t=>2*f[t]:2*p).attr("transform",h?t=>`rotate(${h[t]})`:g?`rotate(${g})`:null).attr("transform-origin",h||g?Ko`${l?t=>l[t]:v}px ${s?t=>s[t]:x}px`:null).call(Dr,"href",d?t=>d[t]:this.src).call(Dr,"preserveAspectRatio",this.preserveAspectRatio).call(Dr,"crossorigin",this.crossOrigin).call(Dr,"image-rendering",this.imageRendering).call(Dr,"clip-path",f?t=>`circle(${f[t]}px)`:void 0!==p?`circle(${p}px)`:null).call(Br,this,n))).node()}}function Gc(t,e,n,r,o,i){return e&&t?n=>t[n]-e[n]/2:e?t=>r-e[t]/2:t&&void 0!==o?e=>t[e]-o/2:void 0!==o?r-o/2:n&&t?e=>t[e]-n[e]:n?t=>r-n[t]:t?e=>t[e]-i:r-i}function Xc(t,e,n){var r=0===t||1===t?0:Math.exp(Vc(e+n)-Vc(e)-Vc(n)+e*Math.log(t)+n*Math.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+n+2)?r*Uc(t,e,n)/e:1-r*Uc(1-t,n,e)/n)}function Uc(t,e,n){var r,o,i,a,l=1e-30,s=1,c=e+n,u=e+1,f=e-1,h=1,d=1-c*t/u;for(Math.abs(d)<l&&(d=l),a=d=1/d;s<=100&&(d=1+(o=s*(n-s)*t/((f+(r=2*s))*(e+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=(d=1/d)*h,d=1+(o=-(e+s)*(c+s)*t/((e+r)*(u+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=i=(d=1/d)*h,!(Math.abs(i-1)<3e-7));s++);return a}function Vc(t){var e,n,r,o=0,i=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(n=e=t)+5.5,r-=(e+.5)*Math.log(r);o<6;o++)a+=i[o]/++n;return Math.log(2.506628274631*a/e)-r}function Hc(t,e){var n=function(t,e,n){var r,o,i,a,l,s,c,u,f,h,d=e-1,p=n-1,m=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&n>=1?(i=t<.5?t:1-t,s=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(i))))/(1+a*(.99229+.04481*a))-a,t<.5&&(s=-s),c=(s*s-3)/6,u=2/(1/(2*e-1)+1/(2*n-1)),f=s*Math.sqrt(c+u)/u-(1/(2*n-1)-1/(2*e-1))*(c+5/6-2/(3*u)),s=e/(e+n*Math.exp(2*f))):(r=Math.log(e/(e+n)),o=Math.log(n/(e+n)),s=t<(a=Math.exp(e*r)/e)/(f=a+(l=Math.exp(n*o)/n))?Math.pow(e*f*t,1/e):1-Math.pow(n*f*(1-t),1/n)),h=-Vc(e)-Vc(n)+Vc(e+n);m<10;m++){if(0===s||1===s)return s;if((s-=a=(l=(Xc(s,e,n)-t)/(a=Math.exp(d*Math.log(s)+p*Math.log(1-s)+h)))/(1-.5*Math.min(1,l*(d/s-p/(1-s)))))<=0&&(s=.5*(s+a)),s>=1&&(s=.5*(s+a+1)),Math.abs(a)<1e-8*s&&m>0)break}return s}(2*Math.min(t,1-t),.5*e,.5);return n=Math.sqrt(e*(1-n)/n),t>.5?n:-n}const Zc={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Qc extends uo{constructor(t,e={}){const{x:n,y:r,z:o,ci:i=.95,precision:a=4}=e;if(super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:ft(e),optional:!0}},e,Zc),this.z=o,this.ci=+i,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${i}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,e,n,r,o){const{x:i,y:a,z:l}=n,{ci:s}=this;return Je("svg:g",o).call(Wr,this,r,o).call(qr,this,e).call((e=>e.selectAll().data(l?Pr(t,l,this.z):[t]).enter().call((t=>t.append("path").attr("fill","none").call(jr,this).call(Nr,this,{...n,fill:null,fillOpacity:null}).attr("d",(t=>this._renderLine(t,i,a))).call(s&&!Wt(this.fill)?t=>t.select(Jc).attr("stroke","none").call(jr,this).call(Nr,this,{...n,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",(t=>this._renderBand(t,i,a))):()=>{}))))).node()}}function Jc(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(e.namespaces.svg,"path"),this)}class Kc extends Qc{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:o,precision:i}=this,[a,l]=e.extent(t,(t=>r[t])),s=eu(t,r,n),c=nu(t,r,n,(1-o)/2,s);return e.area().y((t=>t)).x0((t=>c(t,-1))).x1((t=>c(t,1)))(e.range(a,l-i/2,i).concat(l))}_renderLine(t,n,r){const[o,i]=e.extent(t,(t=>r[t])),a=eu(t,r,n);return`M${a(o)},${o}L${a(i)},${i}`}}class tu extends Qc{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:o,precision:i}=this,[a,l]=e.extent(t,(t=>n[t])),s=eu(t,n,r),c=nu(t,n,r,(1-o)/2,s);return e.area().x((t=>t)).y0((t=>c(t,-1))).y1((t=>c(t,1)))(e.range(a,l-i/2,i).concat(l))}_renderLine(t,n,r){const[o,i]=e.extent(t,(t=>n[t])),a=eu(t,n,r);return`M${o},${a(o)}L${i},${a(i)}`}}function eu(t,e,n){let r=0,o=0,i=0,a=0;for(const l of t){const t=e[l],s=n[l];r+=t,o+=s,i+=t*s,a+=t*t}const l=t.length,s=(l*i-r*o)/(l*a-r*r),c=(o-s*r)/l;return t=>s*t+c}function nu(t,n,r,o,i){const a=e.sum(t,(t=>n[t]))/t.length;let l=0,s=0;for(const e of t)l+=(n[e]-a)**2,s+=(r[e]-i(n[e]))**2;const c=Math.sqrt(s/(t.length-2)),u=Hc(o,t.length-2);return(e,n)=>{const r=i(e),o=c*Math.sqrt(1/t.length+(e-a)**2/l);return r+n*u*o}}function ru({path:t=B,delimiter:n,frameAnchor:r,treeLayout:o=e.tree,treeSort:i,treeSeparation:a,treeAnchor:l,treeFilter:s,...c}={}){l=iu(l),i=su(i),null!=s&&(s=hu(s)),void 0===r&&(r=l.frameAnchor);const u=uu(n),f=Lu(c,hu),[h,d]=vt(),[p,m]=vt();return{x:h,y:p,frameAnchor:r,...oe(c,((n,r)=>{const c=u(z(n,t)),h=d([]),p=m([]);let y=-1;const g=[],v=[],x=e.stratify().path((t=>c[t])),w=o();w.nodeSize&&w.nodeSize([1,1]),w.separation&&void 0!==a&&w.separation(a??N);for(const t of f)t[Mu]=t[ku]([]);for(const t of r){const e=[],r=x(t.filter((t=>null!=c[t]))).each((t=>t.data=n[t.data]));null!=i&&r.sort(i),w(r);for(const t of r.descendants())if(null==s||s(t)){e.push(++y),g[y]=t.data,l.position(t,y,h,p);for(const e of f)e[Mu][y]=e[$u](t)}v.push(e)}return{data:g,facets:v}})),...Object.fromEntries(f)}}function ou({path:t=B,delimiter:n,curve:r="bump-x",stroke:o="#555",strokeWidth:i=1.5,strokeOpacity:a=.5,treeLayout:l=e.tree,treeSort:s,treeSeparation:c,treeAnchor:u,treeFilter:f,...h}={}){u=iu(u),s=su(s),null!=f&&(f=du(f)),h={curve:r,stroke:o,strokeWidth:i,strokeOpacity:a,...h};const d=uu(n),p=Lu(h,du),[m,y]=vt(),[g,v]=vt(),[x,w]=vt(),[b,k]=vt();return{x1:m,x2:g,y1:x,y2:b,...oe(h,((n,r)=>{const o=d(z(n,t)),i=y([]),a=v([]),h=w([]),m=k([]);let g=-1;const x=[],b=[],$=e.stratify().path((t=>o[t])),M=l();M.nodeSize&&M.nodeSize([1,1]),M.separation&&void 0!==c&&M.separation(c??N);for(const t of p)t[Mu]=t[ku]([]);for(const t of r){const e=[],r=$(t.filter((t=>null!=o[t]))).each((t=>t.data=n[t.data]));null!=s&&r.sort(s),M(r);for(const{source:t,target:n}of r.links())if(null==f||f(n,t)){e.push(++g),x[g]=n.data,u.position(t,g,i,h),u.position(n,g,a,m);for(const e of p)e[Mu][g]=e[$u](n,t)}b.push(e)}return{data:x,facets:b}})),...Object.fromEntries(p)}}function iu(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return au;case"right":return lu}throw new Error(`invalid tree anchor: ${t}`)}const au={frameAnchor:"left",dx:6,position({x:t,y:e},n,r,o){r[n]=e,o[n]=-t}},lu={frameAnchor:"right",dx:-6,position({x:t,y:e},n,r,o){r[n]=-e,o[n]=-t}};function su(t){return null==t||"function"==typeof t?t:`${t}`.trim().toLowerCase().startsWith("node:")?cu(hu(t)):cu(function(t){return e=>e.data?.[t]}(t))}function cu(t){return(e,n)=>r(t(e),t(n))}function uu(t="/"){return"/"==`${t}`?t=>t:e=>{return e.map((n=t,r="/",n=new RegExp(function(t){return`${t}`.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}(n),"g"),t=>null==t?null:`${t}`.replace(n,r)));var n,r}}function fu(t){return ot(t)&&"function"==typeof t.node}function hu(t){if(fu(t))return t.node;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")){switch(t){case"node:name":return mu;case"node:path":return pu;case"node:internal":return vu;case"node:external":return xu;case"node:depth":return yu;case"node:height":return gu}throw new Error(`invalid node value: ${t}`)}}function du(t){if(fu(t))return t.node;if(ot(e=t)&&"function"==typeof e.link)return t.link;var e;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")||t.startsWith("parent:")){switch(t){case"parent:name":return wu(mu);case"parent:path":return wu(pu);case"parent:depth":return wu(yu);case"parent:height":return wu(gu);case"node:name":return mu;case"node:path":return pu;case"node:internal":return vu;case"node:external":return xu;case"node:depth":return yu;case"node:height":return gu}throw new Error(`invalid link value: ${t}`)}}function pu(t){return t.id}function mu(t){return function(t){let e=t.length;for(;--e>0&&!bu(t,e););return t.slice(e+1)}(t.id)}function yu(t){return t.depth}function gu(t){return t.height}function vu(t){return!!t.children}function xu(t){return!t.children}function wu(t){return(e,n)=>null==n?void 0:t(n)}function bu(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}const ku=2,$u=3,Mu=4;function Lu(t,e){const n=[];for(const r in t){const o=t[r],i=e(o);void 0!==i&&n.push([r,...vt(o),i])}return n}function Au(t,{fill:n,stroke:r,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:l,strokeMiterlimit:s,strokeDasharray:c,strokeDashoffset:u,marker:f,markerStart:h=f,markerEnd:d=f,dot:p=It(h)&&It(d),text:m="node:name",textStroke:y="white",title:g="node:path",dx:v,dy:x,textAnchor:w,treeLayout:b=e.tree,textLayout:k=(b===e.tree||b===e.cluster?"mirrored":"normal"),tip:$,...M}={}){if(void 0===v&&(v=iu(M.treeAnchor).dx),void 0!==w)throw new Error("textAnchor is not a configurable tree option");function L(e){return ii(t,ru({treeLayout:b,text:m,fill:void 0===n?"currentColor":n,stroke:y,dx:v,dy:x,title:g,...e,...M}))}return k=Q(k,"textLayout",["mirrored","normal"]),fo(Xl(t,ou({treeLayout:b,markerStart:h,markerEnd:d,stroke:void 0!==r?r:void 0===n?"node:internal":n,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:l,strokeMiterlimit:s,strokeDasharray:c,strokeDashoffset:u,...M})),p?cs(t,ru({treeLayout:b,fill:void 0===n?"node:internal":n,title:g,tip:$,...M})):null,null!=m?"mirrored"===k?[L({textAnchor:"start",treeFilter:"node:external"}),L({textAnchor:"end",treeFilter:"node:internal",dx:-v})]:L():null)}function Su(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function zu(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)>=0?(i=a,o=a-1):r=a+1}return i}function Eu(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)>0?(i=a,o=a-1):r=a+1}return i}function Ru(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)<0?(i=a,r=a+1):o=a-1}return i}function Ou(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)<=0?(i=a,r=a+1):o=a-1}return i}function Cu(t,e,n,r,o){for(;r<=o;){var i=r+o>>>1,a=t[i],l=void 0!==n?n(a,e):a-e;if(0===l)return i;l<=0?r=i+1:o=i-1}return-1}function Tu(t,e,n,r,o,i){return"function"==typeof n?i(t,e,n,void 0===r?0:0|r,void 0===o?t.length-1:0|o):i(t,e,void 0,void 0===n?0:0|n,void 0===r?t.length-1:0|r)}var Bu={ge:function(t,e,n,r,o){return Tu(t,e,n,r,o,zu)},gt:function(t,e,n,r,o){return Tu(t,e,n,r,o,Eu)},lt:function(t,e,n,r,o){return Tu(t,e,n,r,o,Ru)},le:function(t,e,n,r,o){return Tu(t,e,n,r,o,Ou)},eq:function(t,e,n,r,o){return Tu(t,e,n,r,o,Cu)}},Nu=function(t){if(!t||0===t.length)return new Hu(null);return new Hu(Vu(t))};function Pu(t,e,n,r,o){this.mid=t,this.left=e,this.right=n,this.leftPoints=r,this.rightPoints=o,this.count=(e?e.count:0)+(n?n.count:0)+r.length}var Iu=Pu.prototype;function Wu(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function ju(t,e){var n=Vu(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function Fu(t,e){var n=t.intervals([]);n.push(e),ju(t,n)}function Du(t,e){var n=t.intervals([]),r=n.indexOf(e);return r<0?0:(n.splice(r,1),ju(t,n),1)}function qu(t,e,n){for(var r=0;r<t.length&&t[r][0]<=e;++r){var o=n(t[r]);if(o)return o}}function Yu(t,e,n){for(var r=t.length-1;r>=0&&t[r][1]>=e;--r){var o=n(t[r]);if(o)return o}}function _u(t,e){for(var n=0;n<t.length;++n){var r=e(t[n]);if(r)return r}}function Gu(t,e){return t-e}function Xu(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function Uu(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function Vu(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(Gu);var r=e[e.length>>1],o=[],i=[],a=[];for(n=0;n<t.length;++n){var l=t[n];l[1]<r?o.push(l):r<l[0]?i.push(l):a.push(l)}var s=a,c=a.slice();return s.sort(Xu),c.sort(Uu),new Pu(r,Vu(o),Vu(i),s,c)}function Hu(t){this.root=t}Iu.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},Iu.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?Fu(this,t):this.left.insert(t):this.left=Vu([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?Fu(this,t):this.right.insert(t):this.right=Vu([t]);else{var n=Bu.ge(this.leftPoints,t,Xu),r=Bu.ge(this.rightPoints,t,Uu);this.leftPoints.splice(n,0,t),this.rightPoints.splice(r,0,t)}},Iu.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?Du(this,t):2===(i=this.left.remove(t))?(this.left=null,this.count-=1,1):(1===i&&(this.count-=1),i):0;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?Du(this,t):2===(i=this.right.remove(t))?(this.right=null,this.count-=1,1):(1===i&&(this.count-=1),i):0;if(1===this.count)return this.leftPoints[0]===t?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,r=this.left;r.right;)n=r,r=r.right;if(n===this)r.right=this.right;else{var o=this.left,i=this.right;n.count-=r.count,n.right=r.left,r.left=o,r.right=i}Wu(this,r),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?Wu(this,this.left):Wu(this,this.right);return 1}for(o=Bu.ge(this.leftPoints,t,Xu);o<this.leftPoints.length&&this.leftPoints[o][0]===t[0];++o)if(this.leftPoints[o]===t){this.count-=1,this.leftPoints.splice(o,1);for(i=Bu.ge(this.rightPoints,t,Uu);i<this.rightPoints.length&&this.rightPoints[i][1]===t[1];++i)if(this.rightPoints[i]===t)return this.rightPoints.splice(i,1),1}return 0},Iu.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(n=this.left.queryPoint(t,e))return n;return qu(this.leftPoints,t,e)}if(t>this.mid){var n;if(this.right)if(n=this.right.queryPoint(t,e))return n;return Yu(this.rightPoints,t,e)}return _u(this.leftPoints,e)},Iu.queryInterval=function(t,e,n){var r;if(t<this.mid&&this.left&&(r=this.left.queryInterval(t,e,n)))return r;if(e>this.mid&&this.right&&(r=this.right.queryInterval(t,e,n)))return r;return e<this.mid?qu(this.leftPoints,e,n):t>this.mid?Yu(this.rightPoints,t,n):_u(this.leftPoints,n)};var Zu=Hu.prototype;Zu.insert=function(t){this.root?this.root.insert(t):this.root=new Pu(t[0],null,null,[t],[t])},Zu.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),0!==e}return!1},Zu.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},Zu.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(Zu,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(Zu,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});var Qu=Su(Nu);const Ju=({marginLeft:t})=>[1,t],Ku=({width:t,marginRight:e})=>[-1,t-e],tf=({width:t,marginLeft:e,marginRight:n})=>[0,(e+t-n)/2],ef=({marginTop:t})=>[1,t],nf=({height:t,marginBottom:e})=>[-1,t-e],rf=({height:t,marginTop:e,marginBottom:n})=>[0,(e+t-n)/2];function of(t){return"string"==typeof t?{anchor:t}:t}function af(t){const{anchor:e,padding:n,...r}=t,{r:o}=r;return[{anchor:e,padding:n,r:o},r]}function lf(t,e,n,r,o,i){if(null!=o&&"number"!=typeof o){let{channels:t,sort:e,reverse:n}=i;t=qt(t),void 0===t?.r&&(i={...i,channels:{...t,r:{value:o,scale:"r"}}}),void 0===e&&void 0===n&&(i.sort={channel:"-r"})}return ie(i,(function(i,s,c,u,f,h){let{[e]:d,r:p}=c;if(!c[e])throw new Error(`missing channel: ${e}`);({[e]:d}=dn(c,u,h));const m=p?void 0:void 0!==o?W(o):void 0!==this.r?this.r:3;p&&(p=z(p.value,u[p.scale]||B,Float64Array));let[y,g]=n(f);const v=y?cf:sf,x=new Float64Array(d.length),w=p?t=>p[t]:()=>m;for(let t of s){const e=Qu();t=t.filter(p?t=>a(d[t])&&l(p[t]):t=>a(d[t]));const n=new Float64Array(2*t.length+2);for(const o of t){const t=w(o),i=y?t+r:0,a=d[o]-t,l=d[o]+t;let s=2;e.queryInterval(a-r,l+r,(([,,t])=>{const e=x[t]-i,a=d[o]-d[t],l=r+(p?p[o]+p[t]:2*m),c=Math.sqrt(l*l-a*a);n[s++]=e-c,n[s++]=e+c}));let c=n.slice(0,s);y&&(c=c.filter((t=>t>=0)));t:for(const t of c.sort(v)){for(let e=0;e<s;e+=2)if(n[e]+1e-6<t&&t<n[e+1]-1e-6)continue t;x[o]=t+i;break}e.insert([a,l,o])}}y||(y=1);for(const t of s)for(const e of t)x[e]=x[e]*y+g;return{data:i,facets:s,channels:{[t]:{value:x,source:null},[e]:{value:d,source:c[e]},...p&&{r:{value:p,source:c.r}}}}}))}function sf(t,e){return Math.abs(t)-Math.abs(e)}function cf(t,e){return t-e}function uf(t){if(void 0===t)return pf;if("function"==typeof t)return ff(pt(t));if(/^p\d{2}$/i.test(t))return hf(Y(t));switch(`${t}`.toLowerCase()){case"deviation":return yf;case"first":return pf;case"last":return mf;case"max":return gf;case"mean":return vf;case"median":return xf;case"min":return wf;case"sum":return bf;case"extent":return df}throw new Error(`invalid basis: ${t}`)}function ff(t){return{mapIndex(e,n,r){const o=+t(e,n);for(const t of e)r[t]=null===n[t]?NaN:n[t]/o}}}function hf(t){return ff(((e,n)=>t(e,(t=>n[t]))))}const df={mapIndex(t,n,r){const[o,i]=e.extent(t,(t=>n[t])),a=i-o;for(const e of t)r[e]=null===n[e]?NaN:(n[e]-o)/a}},pf=ff(((t,e)=>{for(let r=0;r<t.length;++r){const o=e[t[r]];if(n(o))return o}})),mf=ff(((t,e)=>{for(let r=t.length-1;r>=0;--r){const o=e[t[r]];if(n(o))return o}})),yf={mapIndex(t,n,r){const o=e.mean(t,(t=>n[t])),i=e.deviation(t,(t=>n[t]));for(const e of t)r[e]=null===n[e]?NaN:i?(n[e]-o)/i:0}},gf=hf(e.max),vf=hf(e.mean),xf=hf(e.median),wf=hf(e.min),bf=hf(e.sum);function kf(t={}){"number"==typeof t&&(t={k:t});let{k:n,reduce:r,shift:o,anchor:i,strict:a}=t;if(void 0===i&&void 0!==o&&(i=function(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}(o),tn(`Warning: the shift option is deprecated; please use anchor "${i}" instead.`)),!((n=Math.floor(n))>0))throw new Error(`invalid k: ${n}`);return function(t="mean"){if("string"==typeof t){if(/^p\d{2}$/i.test(t))return $f(Y(t));switch(t.toLowerCase()){case"deviation":return $f(e.deviation);case"max":return Mf(((t,n)=>e.max(t,(t=>n[t]))));case"mean":return Af;case"median":return $f(e.median);case"min":return Mf(((t,n)=>e.min(t,(t=>n[t]))));case"mode":return Mf(((t,n)=>e.mode(t,(t=>n[t]))));case"sum":return Lf;case"variance":return $f(e.variance);case"difference":return Of;case"ratio":return Cf;case"first":return Tf;case"last":return Bf}}if("function"!=typeof t)throw new Error(`invalid reduce: ${t}`);return Mf(pt(t))}(r)(n,function(t="middle",e){switch(`${t}`.toLowerCase()){case"middle":return e-1>>1;case"start":return 0;case"end":return e-1}throw new Error(`invalid anchor: ${t}`)}(i,n),a)}function $f(t){return(e,n,r)=>r?{mapIndex(r,o,i){const a=t=>null==o[t]?NaN:+o[t];let l=0;for(let t=0;t<e-1;++t)isNaN(a(t))&&++l;for(let o=0,s=r.length-e+1;o<s;++o)isNaN(a(o+e-1))&&++l,i[r[o+n]]=0===l?t(mt(r,o,o+e),a):NaN,isNaN(a(o))&&--l}}:{mapIndex(r,o,i){const a=t=>null==o[t]?NaN:+o[t];for(let o=-n;o<0;++o)i[r[o+n]]=t(mt(r,0,o+e),a);for(let o=0,l=r.length-n;o<l;++o)i[r[o+n]]=t(mt(r,o,o+e),a)}}}function Mf(t){return(e,r,o)=>o?{mapIndex(o,i,a){let l=0;for(let t=0;t<e-1;++t)l+=n(i[o[t]]);for(let s=0,c=o.length-e+1;s<c;++s)l+=n(i[o[s+e-1]]),l===e&&(a[o[s+r]]=t(mt(o,s,s+e),i)),l-=n(i[o[s]])}}:{mapIndex(n,o,i){for(let a=-r;a<0;++a)i[n[a+r]]=t(mt(n,0,a+e),o);for(let a=0,l=n.length-r;a<l;++a)i[n[a+r]]=t(mt(n,a,a+e),o)}}}function Lf(t,e,n){return n?{mapIndex(n,r,o){let i=0,a=0;for(let e=0;e<t-1;++e){const t=r[n[e]];null===t||isNaN(t)?++i:a+=+t}for(let l=0,s=n.length-t+1;l<s;++l){const s=r[n[l]],c=r[n[l+t-1]];null===c||isNaN(c)?++i:a+=+c,o[n[l+e]]=0===i?a:NaN,null===s||isNaN(s)?--i:a-=+s}}}:{mapIndex(n,r,o){let i=0;const a=n.length;for(let o=0,l=Math.min(a,t-e-1);o<l;++o)i+=+r[n[o]]||0;for(let l=-e,s=a-e;l<s;++l)i+=+r[n[l+t-1]]||0,o[n[l+e]]=i,i-=+r[n[l]]||0}}}function Af(t,e,n){if(n){const r=Lf(t,e,n);return{mapIndex(n,o,i){r.mapIndex(n,o,i);for(let r=0,o=n.length-t+1;r<o;++r)i[n[r+e]]/=t}}}return{mapIndex(n,r,o){let i=0,a=0;const l=n.length;for(let o=0,s=Math.min(l,t-e-1);o<s;++o){let t=r[n[o]];null===t||isNaN(t=+t)||(i+=t,++a)}for(let s=-e,c=l-e;s<c;++s){let l=r[n[s+t-1]],c=r[n[s]];null===l||isNaN(l=+l)||(i+=l,++a),o[n[s+e]]=i/a,null===c||isNaN(c=+c)||(i-=c,--a)}}}}function Sf(t,e,r,o){for(let i=r+o;r<i;++r){const o=t[e[r]];if(n(o))return o}}function zf(t,e,r,o){for(let i=r+o-1;i>=r;--i){const r=t[e[i]];if(n(r))return r}}function Ef(t,e,n,r){for(let o=n+r;n<o;++n){let r=t[e[n]];if(null!==r&&!isNaN(r=+r))return r}}function Rf(t,e,n,r){for(let o=n+r-1;o>=n;--o){let n=t[e[o]];if(null!==n&&!isNaN(n=+n))return n}}function Of(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i){const a=r[n[i]],l=r[n[i+t-1]];o[n[i+e]]=null===a||null===l?NaN:l-a}}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=Rf(r,n,i,t)-Ef(r,n,i,t)}}}function Cf(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i){const a=r[n[i]],l=r[n[i+t-1]];o[n[i+e]]=null===a||null===l?NaN:l/a}}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=Rf(r,n,i,t)/Ef(r,n,i,t)}}}function Tf(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i)o[n[i+e]]=r[n[i]]}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=Sf(r,n,i,t)}}}function Bf(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i)o[n[i+e]]=r[n[i+t-1]]}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=zf(r,n,i,t)}}}function Nf(t){if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"min":return Ff;case"max":return Df}throw new Error(`unknown selector: ${t}`)}function Pf(t){return qf(null,Wf,t)}function If(t){return qf(null,jf,t)}function*Wf(t){yield t[0]}function*jf(t){yield t[t.length-1]}function*Ff(t,n){yield e.least(t,(t=>n[t]))}function*Df(t,n){yield e.greatest(t,(t=>n[t]))}function qf(t,n,r){if(null!=t){if(null==r[t])throw new Error(`missing channel: ${t}`);t=r[t]}const o=ft(r);return oe(r,((r,i)=>{const a=z(r,o),l=z(r,t),s=[];for(const t of i){const r=[];for(const o of a?e.group(t,(t=>a[t])).values():[t])for(const t of n(o,l))r.push(t);s.push(r)}return{data:r,facets:s}}))}t.Area=Dl,t.Arrow=Hl,t.BarX=Kl,t.BarY=ts,t.Cell=os,t.Contour=cc,t.Density=Oc,t.Dot=ss,t.Frame=xa,t.Geo=Nc,t.Hexgrid=Dc,t.Image=_c,t.Line=fs,t.Link=Gl,t.Mark=uo,t.Raster=Zs,t.Rect=ys,t.RuleX=Vo,t.RuleY=Ho,t.Text=ni,t.TickX=Is,t.TickY=Ws,t.Tip=$a,t.Vector=Oi,t.area=function(t,e){return void 0===e?Yl(t,{x:j,y:F}):new Dl(t,e)},t.areaX=ql,t.areaY=Yl,t.arrow=function(t,{x:e,x1:n,x2:r,y:o,y1:i,y2:a,...l}={}){return[n,r]=Ul(e,n,r),[i,a]=Ul(o,i,a),new Hl(t,{...l,x1:n,x2:r,y1:i,y2:a})},t.auto=function(t,e){const n=ws(t,e),{fx:r,fy:o,x:{zero:i},y:{zero:a},markOptions:l,transformOptions:s,colorMode:c}=n,u=Ss[n.markImpl],f=Ss[n.transformImpl],h=null!=r||null!=o?wa({strokeOpacity:.1}):null,d=[i?Zo([0]):null,a?Qo([0]):null],p=u(t,f?f(s,l):l);return"stroke"===c?fo(h,d,p):fo(h,p,d)},t.autoSpec=ws,t.axisFx=_i,t.axisFy=qi,t.axisX=Yi,t.axisY=Di,t.barX=es,t.barY=ns,t.bin=Za,t.binX=Va,t.binY=Ha,t.boxX=function(t,{x:e=B,y:n=null,fill:r="#ccc",fillOpacity:o,stroke:i="currentColor",strokeOpacity:a,strokeWidth:l=2,sort:s,...c}={}){const u=null!=n?ge:me;return fo(Qo(t,u({x1:qs,x2:Ys},{x:e,y:n,stroke:i,strokeOpacity:a,...c})),es(t,u({x1:"p25",x2:"p75"},{x:e,y:n,fill:r,fillOpacity:o,...c})),js(t,u({x:"p50"},{x:e,y:n,stroke:i,strokeOpacity:a,strokeWidth:l,sort:s,...c})),cs(t,Os({x:Ds},{x:e,y:n,z:n,stroke:i,strokeOpacity:a,...c})))},t.boxY=function(t,{y:e=B,x:n=null,fill:r="#ccc",fillOpacity:o,stroke:i="currentColor",strokeOpacity:a,strokeWidth:l=2,sort:s,...c}={}){const u=null!=n?ye:me;return fo(Zo(t,u({y1:qs,y2:Ys},{x:n,y:e,stroke:i,strokeOpacity:a,...c})),ns(t,u({y1:"p25",y2:"p75"},{x:n,y:e,fill:r,fillOpacity:o,...c})),Fs(t,u({y:"p50"},{x:n,y:e,stroke:i,strokeOpacity:a,strokeWidth:l,sort:s,...c})),cs(t,Os({y:Ds},{x:n,y:e,z:n,stroke:i,strokeOpacity:a,...c})))},t.cell=is,t.cellX=function(t,{x:e=T,fill:n,stroke:r,...o}={}){return void 0===n&&void 0===V(r)[0]&&(n=B),new os(t,{...o,x:e,fill:n,stroke:r})},t.cellY=function(t,{y:e=T,fill:n,stroke:r,...o}={}){return void 0===n&&void 0===V(r)[0]&&(n=B),new os(t,{...o,y:e,fill:n,stroke:r})},t.centroid=function({geometry:t=B,...n}={}){return ie({...n,x:null,y:null},((n,r,o,i,a,{projection:l})=>{const s=z(n,t),c=s.length,u=new Float64Array(c),f=new Float64Array(c),h=e.geoPath(l);for(let t=0;t<c;++t)[u[t],f[t]]=h.centroid(s[t]);return{data:n,facets:r,channels:{x:{value:u,source:null},y:{value:f,source:null}}}}))},t.circle=function(t,e){return cs(t,{...e,symbol:"circle"})},t.cluster=function(t,n){return Au(t,{...n,treeLayout:e.cluster})},t.column=vt,t.contour=function(){return new cc(...Qs("value",...arguments))},t.crosshair=function(t,e){return fc(vo,t,e)},t.crosshairX=function(t,e={}){return fc(xo,t,e)},t.crosshairY=function(t,e={}){return fc(wo,t,e)},t.delaunayLink=function(t,e){return Ec(kc,t,e)},t.delaunayMesh=function(t,e){return Ec(Mc,t,e)},t.density=function(t,{x:e,y:n,...r}={}){return[e,n]=ut(e,n),new Oc(t,{...r,x:e,y:n})},t.dodgeX=function(t={},e={}){1===arguments.length&&([t,e]=af(t));let{anchor:n="left",padding:r=1,r:o=e.r}=of(t);switch(`${n}`.toLowerCase()){case"left":n=Ju;break;case"right":n=Ku;break;case"middle":n=tf;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return lf("x","y",n,W(r),o,e)},t.dodgeY=function(t={},e={}){1===arguments.length&&([t,e]=af(t));let{anchor:n="bottom",padding:r=1,r:o=e.r}=of(t);switch(`${n}`.toLowerCase()){case"top":n=ef;break;case"bottom":n=nf;break;case"middle":n=rf;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return lf("y","x",n,W(r),o,e)},t.dot=cs,t.dotX=function(t,{x:e=B,...n}={}){return new ss(t,Xo({...n,x:e}))},t.dotY=function(t,{y:e=B,...n}={}){return new ss(t,Go({...n,y:e}))},t.filter=function(t,e){return se(e,ce(t))},t.formatIsoDate=Ar,t.formatMonth=function(t="en-US",e="short"){const n=Mr(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2e3,+t)))?void 0:n.format(t)},t.formatWeekday=function(t="en-US",e="short"){const n=Lr(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2001,0,+t)))?void 0:n.format(t)},t.frame=wa,t.geo=Pc,t.geoCentroid=function({geometry:t=B,...n}={}){let r;return{...n,x:{transform:n=>Float64Array.from(r=z(z(n,t),e.geoCentroid),(([t])=>t))},y:{transform:()=>Float64Array.from(r,(([,t])=>t))}}},t.graticule=function({strokeOpacity:t=.1,...n}={}){return Pc(e.geoGraticule10(),{strokeOpacity:t,...n})},t.gridFx=Zi,t.gridFy=Vi,t.gridX=Hi,t.gridY=Ui,t.group=ve,t.groupX=ye,t.groupY=ge,t.groupZ=me,t.hexagon=function(t,e){return cs(t,{...e,symbol:"hexagon"})},t.hexbin=function(t={fill:"count"},{binWidth:e,...n}={}){const{z:r}=n;return e=void 0===e?20:W(e),we(t=be(t,n),"fill")&&(n.channels={...n.channels,fill:{value:[]}}),void 0===n.symbol&&(n.symbol="hexagon"),void 0!==n.r||we(t,"r")||(n.r=e/2),ie(n,((n,o,i,a,l,s)=>{let{x:c,y:u,z:f,fill:h,stroke:d,symbol:p}=i;if(void 0===c)throw new Error("missing channel: x");if(void 0===u)throw new Error("missing channel: y");({x:c,y:u}=dn(i,a,s)),f=f?f.value:z(n,r),h=h?.value,d=d?.value,p=p?.value;const m=Se(t,{z:f,fill:h,stroke:d,symbol:p}),y=f&&[],g=h&&[],v=d&&[],x=p&&[],w=[],b=[],k=[];let $=-1;for(const e of t)e.initialize(n);for(const n of o){const r=[];for(const e of t)e.scope("facet",n);for(const[o,i]of Me(n,m))for(const n of jc(i,c,u,e)){r.push(++$),b.push(n.x),k.push(n.y),f&&y.push(m===f?o:f[n[0]]),h&&g.push(m===h?o:h[n[0]]),d&&v.push(m===d?o:d[n[0]]),p&&x.push(m===p?o:p[n[0]]);for(const e of t)e.reduce(n)}w.push(r)}const M=i.x.scale,L=i.y.scale;return{data:n,facets:w,channels:{x:{value:b,source:a[M]?{value:K(b,a[M].invert),scale:M}:null},y:{value:k,source:a[L]?{value:K(k,a[L].invert),scale:L}:null},...f&&{z:{value:y}},...h&&{fill:{value:g,scale:"auto"}},...d&&{stroke:{value:v,scale:"auto"}},...p&&{symbol:{value:x,scale:"auto"}},...Object.fromEntries(t.map((({name:t,output:n})=>[t,{scale:"auto",label:n.label,radius:"r"===t?e/2:void 0,value:n.transform()}])))}}}))},t.hexgrid=function(t){return new Dc(t)},t.hull=function(t,e){return Ec(Lc,t,e)},t.identity=B,t.image=function(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=ut(e,n)),new _c(t,{...r,x:e,y:n})},t.indexOf=T,t.initializer=ie,t.interpolateNearest=ic,t.interpolateNone=ec,t.interpolatorBarycentric=nc,t.interpolatorRandomWalk=ac,t.legend=function(t={}){for(const[e,n]of da){const r=t[e];if(at(r)){const o=Qe(t);let i;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&at(t.color)?"color":void 0)}=t;i={fill:e,stroke:n}}return n(ur(e,r,i),pa(o,r,t),(e=>at(t[e])?ur(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")},t.line=hs,t.lineX=ds,t.lineY=ps,t.linearRegressionX=function(t,{y:e=T,x:n=B,stroke:r,fill:o=(It(r)?"currentColor":r),...i}={}){return new Kc(t,Ka({...i,x:n,y:e,fill:o,stroke:r}))},t.linearRegressionY=function(t,{x:e=T,y:n=B,stroke:r,fill:o=(It(r)?"currentColor":r),...i}={}){return new tu(t,Ja({...i,x:e,y:n,fill:o,stroke:r}))},t.link=Xl,t.map=Os,t.mapX=Es,t.mapY=Rs,t.marks=fo,t.normalize=uf,t.normalizeX=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),Es(uf(t),e)},t.normalizeY=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),Rs(uf(t),e)},t.plot=Sa,t.pointer=vo,t.pointerX=xo,t.pointerY=wo,t.raster=function(){const[t,e]=Qs("fill",...arguments);return new Zs(t,null==t||void 0!==e.fill||void 0!==e.fillOpacity?e:{...e,fill:B})},t.rect=gs,t.rectX=vs,t.rectY=xs,t.reverse=function({sort:t,...e}={}){return{...se(e,ue),sort:st(t)?t:null}},t.ruleX=Zo,t.ruleY=Qo,t.scale=function(t={}){let e;for(const n in t)if(Zt.has(n)&&at(t[n])){if(void 0!==e)throw new Error("ambiguous scale definition; multiple scales found");e=br(ur(n,t[n]))}if(void 0===e)throw new Error("invalid scale definition; no scale found");return e},t.select=function(t,e={}){if("string"==typeof t)switch(t.toLowerCase()){case"first":return Pf(e);case"last":return If(e)}if("function"==typeof t)return qf(null,t,e);let n,r;for(n in t){if(void 0!==r)throw new Error("ambiguous selector; multiple inputs");r=Nf(t[n])}if(void 0===r)throw new Error(`invalid selector: ${t}`);return qf(n,r,e)},t.selectFirst=Pf,t.selectLast=If,t.selectMaxX=function(t){return qf("x",Df,t)},t.selectMaxY=function(t){return qf("y",Df,t)},t.selectMinX=function(t){return qf("x",Ff,t)},t.selectMinY=function(t){return qf("y",Ff,t)},t.shuffle=function({seed:t,sort:n,...r}={}){return{...se(r,pe(null==t?Math.random:e.randomLcg(t))),sort:st(n)?n:null}},t.sort=fe,t.sphere=function({strokeWidth:t=1.5,...e}={}){return Pc({type:"Sphere"},{strokeWidth:t,...e})},t.spike=function(t,e={}){const{shape:n=Ei,stroke:r=Li.stroke,strokeWidth:o=1,fill:i=r,fillOpacity:a=.3,anchor:l="start",...s}=e;return Ci(t,{...s,shape:n,stroke:r,strokeWidth:o,fill:i,fillOpacity:a,anchor:l})},t.stackX=$l,t.stackX1=function(t={},e={}){1===arguments.length&&([t,e]=Sl(t));const{y1:n,y:r=n,x:o}=e,[i,a,l]=El(r,o,"y","x",t,e);return{...i,y1:n,y:a,x:l}},t.stackX2=function(t={},e={}){1===arguments.length&&([t,e]=Sl(t));const{y1:n,y:r=n,x:o}=e,[i,a,,l]=El(r,o,"y","x",t,e);return{...i,y1:n,y:a,x:l}},t.stackY=Ml,t.stackY1=function(t={},e={}){1===arguments.length&&([t,e]=Sl(t));const{x1:n,x:r=n,y:o}=e,[i,a,l]=El(r,o,"x","y",t,e);return{...i,x1:n,x:a,y:l}},t.stackY2=function(t={},e={}){1===arguments.length&&([t,e]=Sl(t));const{x1:n,x:r=n,y:o}=e,[i,a,,l]=El(r,o,"x","y",t,e);return{...i,x1:n,x:a,y:l}},t.text=ii,t.textX=ai,t.textY=li,t.tickX=js,t.tickY=Fs,t.tip=Ma,t.transform=oe,t.tree=Au,t.treeLink=ou,t.treeNode=ru,t.valueof=z,t.vector=Ci,t.vectorX=Ti,t.vectorY=Bi,t.version="0.6.9",t.voronoi=function(t,e){return Ec(Ac,t,e)},t.voronoiMesh=function(t,e){return Ec(Sc,t,e)},t.window=kf,t.windowX=function(t={},e){return 1===arguments.length&&(e=t),Es(kf(t),e)},t.windowY=function(t={},e){return 1===arguments.length&&(e=t),Rs(kf(t),e)}}));
